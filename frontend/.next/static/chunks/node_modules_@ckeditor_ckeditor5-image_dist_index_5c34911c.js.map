{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"file":"index.js.map","sources":["file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/dist/index.js","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/utils.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageutils.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/autoimage.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagetextalternative/imagetextalternativecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagetextalternative/imagetextalternativeediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagetextalternative/ui/textalternativeformview.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/ui/utils.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagetextalternative/imagetextalternativeui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagetextalternative.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/converters.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/imageloadobserver.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/insertimagecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/replaceimagesourcecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/imageediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagesizeattributes.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/imagetypecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/imageplaceholder.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/imageblockediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinsert/ui/imageinsertformview.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinsert/imageinsertui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageblock.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image/imageinlineediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinline.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/image.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagecaption/imagecaptionutils.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagecaption/toggleimagecaptioncommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagecaption/imagecaptionediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagecaption/imagecaptionui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagecaption.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageupload/utils.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageupload/imageuploadui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageupload/imageuploadprogress.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageupload/uploadimagecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageupload/imageuploadediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageupload.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinsert/ui/imageinserturlview.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinsert/imageinsertviaurlui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinsertviaurl.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageinsert.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/resizeimagecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/imageresizeediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/imageresizebuttons.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/imageresizehandles.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/utils/tryparsedimensionwithunit.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/utils/getselectedimageeditornodes.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/utils/getselectedimagewidthinunits.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/ui/imagecustomresizeformview.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/utils/getselectedimagepossibleresizerange.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize/imagecustomresizeui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imageresize.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagestyle/imagestylecommand.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagestyle/utils.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagestyle/converters.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagestyle/imagestyleediting.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagestyle/imagestyleui.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagestyle.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/imagetoolbar.ts","file:///home/matei/NovelPedia/App/frontend/node_modules/%40ckeditor/ckeditor5-image/src/pictureediting.ts"],"sourcesContent":["import { Plugin, Command } from '@ckeditor/ckeditor5-core/dist/index.js';\nimport { Clipboard, ClipboardPipeline } from '@ckeditor/ckeditor5-clipboard/dist/index.js';\nimport { ModelLivePosition, ModelLiveRange, Observer, ViewUpcastWriter, enableViewPlaceholder, ModelElement } from '@ckeditor/ckeditor5-engine/dist/index.js';\nimport { Undo } from '@ckeditor/ckeditor5-undo/dist/index.js';\nimport { Delete } from '@ckeditor/ckeditor5-typing/dist/index.js';\nimport { first, DomEmitterMixin, global, FocusTracker, KeystrokeHandler, logWarning, toArray, env, CKEditorError, Collection, Rect } from '@ckeditor/ckeditor5-utils/dist/index.js';\nimport { toWidget, isWidget, findOptimalInsertionRange, Widget, toWidgetEditable, WidgetResize, calculateResizeHostAncestorWidth, WidgetToolbarRepository } from '@ckeditor/ckeditor5-widget/dist/index.js';\nimport { View, FormRowView, ViewCollection, FocusCycler, submitHandler, ButtonView, FormHeaderView, LabeledFieldView, createLabeledInputText, BalloonPanelView, ContextualBalloon, CssTransitionDisablerMixin, clickOutsideHandler, CollapsibleView, SplitButtonView, createDropdown, MenuBarMenuView, MenuBarMenuListView, MenuBarMenuListItemView, FileDialogButtonView, MenuBarMenuListItemFileDialogButtonView, Notification, Dialog, MenuBarMenuListItemButtonView, UIModel, DropdownButtonView, addListToDropdown, createLabeledInputNumber, addToolbarToDropdown } from '@ckeditor/ckeditor5-ui/dist/index.js';\nimport { IconPreviousArrow, IconTextAlternative, IconImage, IconCaption, IconImageUpload, IconImageUrl, IconObjectSizeFull, IconObjectSizeCustom, IconObjectSizeLarge, IconObjectSizeMedium, IconObjectSizeSmall, IconObjectInline, IconObjectInlineRight, IconObjectInlineLeft, IconObjectCenter, IconObjectRight, IconObjectLeft, IconObjectFullWidth } from '@ckeditor/ckeditor5-icons/dist/index.js';\nimport { FileRepository } from '@ckeditor/ckeditor5-upload/dist/index.js';\nimport { isObject, identity } from 'es-toolkit/compat';\n\n/**\n * Creates a view element representing the inline image.\n *\n * ```html\n * <span class=\"image-inline\"><img></img></span>\n * ```\n *\n * Note that `alt` and `src` attributes are converted separately, so they are not included.\n *\n * @internal\n */ function createInlineImageViewElement(writer) {\n    return writer.createContainerElement('span', {\n        class: 'image-inline'\n    }, writer.createEmptyElement('img'));\n}\n/**\n * Creates a view element representing the block image.\n *\n * ```html\n * <figure class=\"image\"><img></img></figure>\n * ```\n *\n * Note that `alt` and `src` attributes are converted separately, so they are not included.\n *\n * @internal\n */ function createBlockImageViewElement(writer) {\n    return writer.createContainerElement('figure', {\n        class: 'image'\n    }, [\n        writer.createEmptyElement('img'),\n        writer.createSlot('children')\n    ]);\n}\n/**\n * A function returning a `MatcherPattern` for a particular type of View images.\n *\n * @internal\n * @param matchImageType The type of created image.\n */ function getImgViewElementMatcher(editor, matchImageType) {\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const areBothImagePluginsLoaded = editor.plugins.has('ImageInlineEditing') && editor.plugins.has('ImageBlockEditing');\n    return (element)=>{\n        // Check if the matched view element is an <img>.\n        if (!imageUtils.isInlineImageView(element)) {\n            return null;\n        }\n        // If just one of the plugins is loaded (block or inline), it will match all kinds of images.\n        if (!areBothImagePluginsLoaded) {\n            return getPositiveMatchPattern(element);\n        }\n        // The <img> can be standalone, wrapped in <figure>...</figure> (ImageBlock plugin) or\n        // wrapped in <figure><a>...</a></figure> (LinkImage plugin).\n        const imageType = element.getStyle('display') == 'block' || element.findAncestor(imageUtils.isBlockImageView) ? 'imageBlock' : 'imageInline';\n        if (imageType !== matchImageType) {\n            return null;\n        }\n        return getPositiveMatchPattern(element);\n    };\n    function getPositiveMatchPattern(element) {\n        const pattern = {\n            name: true\n        };\n        // This will trigger src consumption (See https://github.com/ckeditor/ckeditor5/issues/11530).\n        if (element.hasAttribute('src')) {\n            pattern.attributes = [\n                'src'\n            ];\n        }\n        return pattern;\n    }\n}\n/**\n * Considering the current model selection, it returns the name of the model image element\n * (`'imageBlock'` or `'imageInline'`) that will make most sense from the UX perspective if a new\n * image was inserted (also: uploaded, dropped, pasted) at that selection.\n *\n * The assumption is that inserting images into empty blocks or on other block widgets should\n * produce block images. Inline images should be inserted in other cases, e.g. in paragraphs\n * that already contain some text.\n *\n * @internal\n */ function determineImageTypeForInsertionAtSelection(schema, selection) {\n    const firstBlock = first(selection.getSelectedBlocks());\n    // Insert a block image if the selection is not in/on block elements or it's on a block widget.\n    if (!firstBlock || schema.isObject(firstBlock)) {\n        return 'imageBlock';\n    }\n    // A block image should also be inserted into an empty block element\n    // (that is not an empty list item so the list won't get split).\n    if (firstBlock.isEmpty && firstBlock.name != 'listItem') {\n        return 'imageBlock';\n    }\n    // Otherwise insert an inline image.\n    return 'imageInline';\n}\n/**\n * Returns parsed value of the size, but only if it contains unit: px.\n *\n * @internal\n */ function getSizeValueIfInPx(size) {\n    if (size && size.endsWith('px')) {\n        return parseInt(size);\n    }\n    return null;\n}\n/**\n * Returns true if both styles (width and height) are set.\n *\n * If both image styles: width & height are set, they will override the image width & height attributes in the\n * browser. In this case, the image looks the same as if these styles were applied to attributes instead of styles.\n * That's why we can upcast these styles to width & height attributes instead of resizedWidth and resizedHeight.\n *\n * @internal\n */ function widthAndHeightStylesAreBothSet(viewElement) {\n    const widthStyle = getSizeValueIfInPx(viewElement.getStyle('width'));\n    const heightStyle = getSizeValueIfInPx(viewElement.getStyle('height'));\n    return !!(widthStyle && heightStyle);\n}\n\nconst IMAGE_WIDGETS_CLASSES_MATCH_REGEXP = /^(image|image-inline)$/;\n/**\n * A set of helpers related to images.\n */ class ImageUtils extends Plugin {\n    /**\n\t * DOM Emitter.\n\t */ _domEmitter = new (DomEmitterMixin())();\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageUtils';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * Checks if the provided model element is an `image` or `imageInline`.\n\t */ isImage(modelElement) {\n        return this.isInlineImage(modelElement) || this.isBlockImage(modelElement);\n    }\n    /**\n\t * Checks if the provided view element represents an inline image.\n\t *\n\t * Also, see {@link module:image/imageutils~ImageUtils#isImageWidget}.\n\t */ isInlineImageView(element) {\n        return !!element && element.is('element', 'img');\n    }\n    /**\n\t * Checks if the provided view element represents a block image.\n\t *\n\t * Also, see {@link module:image/imageutils~ImageUtils#isImageWidget}.\n\t */ isBlockImageView(element) {\n        return !!element && element.is('element', 'figure') && element.hasClass('image');\n    }\n    /**\n\t * Handles inserting single file. This method unifies image insertion using {@link module:widget/utils~findOptimalInsertionRange}\n\t * method.\n\t *\n\t * ```ts\n\t * const imageUtils = editor.plugins.get( 'ImageUtils' );\n\t *\n\t * imageUtils.insertImage( { src: 'path/to/image.jpg' } );\n\t * ```\n\t *\n\t * @param attributes Attributes of the inserted image.\n\t * This method filters out the attributes which are disallowed by the {@link module:engine/model/schema~ModelSchema}.\n\t * @param selectable Place to insert the image. If not specified,\n\t * the {@link module:widget/utils~findOptimalInsertionRange} logic will be applied for the block images\n\t * and `model.document.selection` for the inline images.\n\t *\n\t * **Note**: If `selectable` is passed, this helper will not be able to set selection attributes (such as `linkHref`)\n\t * and apply them to the new image. In this case, make sure all selection attributes are passed in `attributes`.\n\t *\n\t * @param imageType Image type of inserted image. If not specified,\n\t * it will be determined automatically depending of editor config or place of the insertion.\n\t * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n\t * The default is `true`.\n\t * @return The inserted model image element.\n\t */ insertImage(attributes = {}, selectable = null, imageType = null, options = {}) {\n        const editor = this.editor;\n        const model = editor.model;\n        const selection = model.document.selection;\n        const determinedImageType = determineImageTypeForInsertion(editor, selectable || selection, imageType);\n        // Mix declarative attributes with selection attributes because the new image should \"inherit\"\n        // the latter for best UX. For instance, inline images inserted into existing links\n        // should not split them. To do that, they need to have \"linkHref\" inherited from the selection.\n        attributes = {\n            ...Object.fromEntries(selection.getAttributes()),\n            ...attributes\n        };\n        for(const attributeName in attributes){\n            if (!model.schema.checkAttribute(determinedImageType, attributeName)) {\n                delete attributes[attributeName];\n            }\n        }\n        return model.change((writer)=>{\n            const { setImageSizes = true } = options;\n            const imageElement = writer.createElement(determinedImageType, attributes);\n            model.insertObject(imageElement, selectable, null, {\n                setSelection: 'on',\n                // If we want to insert a block image (for whatever reason) then we don't want to split text blocks.\n                // This applies only when we don't have the selectable specified (i.e., we insert multiple block images at once).\n                findOptimalPosition: !selectable && determinedImageType != 'imageInline' ? 'auto' : undefined\n            });\n            // Inserting an image might've failed due to schema regulations.\n            if (imageElement.parent) {\n                if (setImageSizes) {\n                    this.setImageNaturalSizeAttributes(imageElement);\n                }\n                return imageElement;\n            }\n            return null;\n        });\n    }\n    /**\n\t * Reads original image sizes and sets them as `width` and `height`.\n\t *\n\t * The `src` attribute may not be available if the user is using an upload adapter. In such a case,\n\t * this method is called again after the upload process is complete and the `src` attribute is available.\n\t */ setImageNaturalSizeAttributes(imageElement) {\n        const src = imageElement.getAttribute('src');\n        if (!src) {\n            return;\n        }\n        if (imageElement.getAttribute('width') || imageElement.getAttribute('height')) {\n            return;\n        }\n        this.editor.model.change((writer)=>{\n            const img = new global.window.Image();\n            this._domEmitter.listenTo(img, 'load', ()=>{\n                if (!imageElement.getAttribute('width') && !imageElement.getAttribute('height')) {\n                    // We use writer.batch to be able to undo (in a single step) width and height setting\n                    // along with any change that triggered this action (e.g. image resize or image style change).\n                    this.editor.model.enqueueChange(writer.batch, (writer)=>{\n                        writer.setAttribute('width', img.naturalWidth, imageElement);\n                        writer.setAttribute('height', img.naturalHeight, imageElement);\n                    });\n                }\n                this._domEmitter.stopListening(img, 'load');\n            });\n            img.src = src;\n        });\n    }\n    /**\n\t * Returns an image widget editing view element if one is selected or is among the selection's ancestors.\n\t */ getClosestSelectedImageWidget(selection) {\n        const selectionPosition = selection.getFirstPosition();\n        if (!selectionPosition) {\n            return null;\n        }\n        const viewElement = selection.getSelectedElement();\n        if (viewElement && this.isImageWidget(viewElement)) {\n            return viewElement;\n        }\n        let parent = selectionPosition.parent;\n        while(parent){\n            if (parent.is('element') && this.isImageWidget(parent)) {\n                return parent;\n            }\n            parent = parent.parent;\n        }\n        return null;\n    }\n    /**\n\t * Returns a image model element if one is selected or is among the selection's ancestors.\n\t */ getClosestSelectedImageElement(selection) {\n        const selectedElement = selection.getSelectedElement();\n        return this.isImage(selectedElement) ? selectedElement : selection.getFirstPosition().findAncestor('imageBlock');\n    }\n    /**\n\t * Returns an image widget editing view based on the passed image view.\n\t */ getImageWidgetFromImageView(imageView) {\n        return imageView.findAncestor({\n            classes: IMAGE_WIDGETS_CLASSES_MATCH_REGEXP\n        });\n    }\n    /**\n\t * Checks if image can be inserted at current model selection.\n\t *\n\t * @internal\n\t */ isImageAllowed() {\n        const model = this.editor.model;\n        const selection = model.document.selection;\n        return isImageAllowedInParent(this.editor, selection) && isNotInsideImage(selection);\n    }\n    /**\n\t * Converts a given {@link module:engine/view/element~ViewElement} to an image widget:\n\t * * Adds a {@link module:engine/view/element~ViewElement#_setCustomProperty custom property} allowing to recognize the image widget\n\t * element.\n\t * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n\t *\n\t * @param writer An instance of the view writer.\n\t * @param label The element's label. It will be concatenated with the image `alt` attribute if one is present.\n\t */ toImageWidget(viewElement, writer, label) {\n        writer.setCustomProperty('image', true, viewElement);\n        const labelCreator = ()=>{\n            const imgElement = this.findViewImgElement(viewElement);\n            const altText = imgElement.getAttribute('alt');\n            return altText ? `${altText} ${label}` : label;\n        };\n        return toWidget(viewElement, writer, {\n            label: labelCreator\n        });\n    }\n    /**\n\t * Checks if a given view element is an image widget.\n\t */ isImageWidget(viewElement) {\n        return !!viewElement.getCustomProperty('image') && isWidget(viewElement);\n    }\n    /**\n\t * Checks if the provided model element is an `image`.\n\t */ isBlockImage(modelElement) {\n        return !!modelElement && modelElement.is('element', 'imageBlock');\n    }\n    /**\n\t * Checks if the provided model element is an `imageInline`.\n\t */ isInlineImage(modelElement) {\n        return !!modelElement && modelElement.is('element', 'imageInline');\n    }\n    /**\n\t * Get the view `<img>` from another view element, e.g. a widget (`<figure class=\"image\">`), a link (`<a>`).\n\t *\n\t * The `<img>` can be located deep in other elements, so this helper performs a deep tree search.\n\t */ findViewImgElement(figureView) {\n        if (this.isInlineImageView(figureView)) {\n            return figureView;\n        }\n        const editingView = this.editor.editing.view;\n        for (const { item } of editingView.createRangeIn(figureView)){\n            if (this.isInlineImageView(item)) {\n                return item;\n            }\n        }\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        this._domEmitter.stopListening();\n        return super.destroy();\n    }\n}\n/**\n * Checks if image is allowed by schema in optimal insertion parent.\n */ function isImageAllowedInParent(editor, selection) {\n    const imageType = determineImageTypeForInsertion(editor, selection, null);\n    if (imageType == 'imageBlock') {\n        const parent = getInsertImageParent(selection, editor.model);\n        if (editor.model.schema.checkChild(parent, 'imageBlock')) {\n            return true;\n        }\n    } else if (editor.model.schema.checkChild(selection.focus, 'imageInline')) {\n        return true;\n    }\n    return false;\n}\n/**\n * Checks if selection is not placed inside an image (e.g. its caption).\n */ function isNotInsideImage(selection) {\n    return [\n        ...selection.focus.getAncestors()\n    ].every((ancestor)=>!ancestor.is('element', 'imageBlock'));\n}\n/**\n * Returns a node that will be used to insert image with `model.insertContent`.\n */ function getInsertImageParent(selection, model) {\n    const insertionRange = findOptimalInsertionRange(selection, model);\n    const parent = insertionRange.start.parent;\n    if (parent.isEmpty && !parent.is('element', '$root')) {\n        return parent.parent;\n    }\n    return parent;\n}\n/**\n * Determine image element type name depending on editor config or place of insertion.\n *\n * @param imageType Image element type name. Used to force return of provided element name,\n * but only if there is proper plugin enabled.\n */ function determineImageTypeForInsertion(editor, selectable, imageType) {\n    const schema = editor.model.schema;\n    const configImageInsertType = editor.config.get('image.insert.type');\n    if (!editor.plugins.has('ImageBlockEditing')) {\n        return 'imageInline';\n    }\n    if (!editor.plugins.has('ImageInlineEditing')) {\n        return 'imageBlock';\n    }\n    if (imageType) {\n        return imageType;\n    }\n    if (configImageInsertType === 'inline') {\n        return 'imageInline';\n    }\n    if (configImageInsertType !== 'auto') {\n        return 'imageBlock';\n    }\n    // Try to replace the selected widget (e.g. another image).\n    if (selectable.is('selection')) {\n        return determineImageTypeForInsertionAtSelection(schema, selectable);\n    }\n    return schema.checkChild(selectable, 'imageInline') ? 'imageInline' : 'imageBlock';\n}\n\n// Implements the pattern: http(s)://(www.)example.com/path/to/resource.ext?query=params&maybe=too.\nconst IMAGE_URL_REGEXP = new RegExp(String(/^(http(s)?:\\/\\/)?[\\w-]+\\.[\\w.~:/[\\]@!$&'()*+,;=%-]+/.source + /\\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source + /(\\?[\\w.~:/[\\]@!$&'()*+,;=%-]*)?/.source + /(#[\\w.~:/[\\]@!$&'()*+,;=%-]*)?$/.source));\n/**\n * The auto-image plugin. It recognizes image links in the pasted content and embeds\n * them shortly after they are injected into the document.\n */ class AutoImage extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            Clipboard,\n            ImageUtils,\n            Undo,\n            Delete\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'AutoImage';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * The paste–to–embed `setTimeout` ID. Stored as a property to allow\n\t * cleaning of the timeout.\n\t */ _timeoutId;\n    /**\n\t * The position where the `<imageBlock>` element will be inserted after the timeout,\n\t * determined each time a new content is pasted into the document.\n\t */ _positionToInsert;\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        this._timeoutId = null;\n        this._positionToInsert = null;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const modelDocument = editor.model.document;\n        const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n        // We need to listen on `Clipboard#inputTransformation` because we need to save positions of selection.\n        // After pasting, the content between those positions will be checked for a URL that could be transformed\n        // into an image.\n        this.listenTo(clipboardPipeline, 'inputTransformation', ()=>{\n            const firstRange = modelDocument.selection.getFirstRange();\n            const leftLivePosition = ModelLivePosition.fromPosition(firstRange.start);\n            leftLivePosition.stickiness = 'toPrevious';\n            const rightLivePosition = ModelLivePosition.fromPosition(firstRange.end);\n            rightLivePosition.stickiness = 'toNext';\n            modelDocument.once('change:data', ()=>{\n                this._embedImageBetweenPositions(leftLivePosition, rightLivePosition);\n                leftLivePosition.detach();\n                rightLivePosition.detach();\n            }, {\n                priority: 'high'\n            });\n        });\n        editor.commands.get('undo').on('execute', ()=>{\n            if (this._timeoutId) {\n                global.window.clearTimeout(this._timeoutId);\n                this._positionToInsert.detach();\n                this._timeoutId = null;\n                this._positionToInsert = null;\n            }\n        }, {\n            priority: 'high'\n        });\n    }\n    /**\n\t * Analyzes the part of the document between provided positions in search for a URL representing an image.\n\t * When the URL is found, it is automatically converted into an image.\n\t *\n\t * @param leftPosition Left position of the selection.\n\t * @param rightPosition Right position of the selection.\n\t */ _embedImageBetweenPositions(leftPosition, rightPosition) {\n        const editor = this.editor;\n        // TODO: Use a marker instead of ModelLiveRange & LivePositions.\n        const urlRange = new ModelLiveRange(leftPosition, rightPosition);\n        const walker = urlRange.getWalker({\n            ignoreElementEnd: true\n        });\n        const selectionAttributes = Object.fromEntries(editor.model.document.selection.getAttributes());\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        let src = '';\n        for (const node of walker){\n            if (node.item.is('$textProxy')) {\n                src += node.item.data;\n            }\n        }\n        src = src.trim();\n        // If the URL does not match the image URL regexp, let's skip that.\n        if (!src.match(IMAGE_URL_REGEXP)) {\n            urlRange.detach();\n            return;\n        }\n        // Position will not be available in the `setTimeout` function so let's clone it.\n        this._positionToInsert = ModelLivePosition.fromPosition(leftPosition);\n        // This action mustn't be executed if undo was called between pasting and auto-embedding.\n        this._timeoutId = setTimeout(()=>{\n            // Do nothing if image element cannot be inserted at the current position.\n            // See https://github.com/ckeditor/ckeditor5/issues/2763.\n            // Condition must be checked after timeout - pasting may take place on an element, replacing it. The final position matters.\n            const imageCommand = editor.commands.get('insertImage');\n            if (!imageCommand.isEnabled) {\n                urlRange.detach();\n                return;\n            }\n            editor.model.change((writer)=>{\n                this._timeoutId = null;\n                writer.remove(urlRange);\n                urlRange.detach();\n                let insertionPosition;\n                // Check if the position where the element should be inserted is still valid.\n                // Otherwise leave it as undefined to use the logic of insertImage().\n                if (this._positionToInsert.root.rootName !== '$graveyard') {\n                    insertionPosition = this._positionToInsert.toPosition();\n                }\n                imageUtils.insertImage({\n                    ...selectionAttributes,\n                    src\n                }, insertionPosition);\n                this._positionToInsert.detach();\n                this._positionToInsert = null;\n            });\n            const deletePlugin = editor.plugins.get('Delete');\n            deletePlugin.requestUndoOnBackspace();\n        }, 100);\n    }\n}\n\n/**\n * The image text alternative command. It is used to change the `alt` attribute of `<imageBlock>` and `<imageInline>` model elements.\n */ class ImageTextAlternativeCommand extends Command {\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const element = imageUtils.getClosestSelectedImageElement(this.editor.model.document.selection);\n        this.isEnabled = !!element;\n        if (this.isEnabled && element.hasAttribute('alt')) {\n            this.value = element.getAttribute('alt');\n        } else {\n            this.value = false;\n        }\n    }\n    /**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options\n\t * @param options.newValue The new value of the `alt` attribute to set.\n\t */ execute(options) {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const model = editor.model;\n        const imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n        model.change((writer)=>{\n            writer.setAttribute('alt', options.newValue, imageElement);\n        });\n    }\n}\n\n/**\n * The image text alternative editing plugin.\n *\n * Registers the `'imageTextAlternative'` command.\n */ class ImageTextAlternativeEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageTextAlternativeEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        this.editor.commands.add('imageTextAlternative', new ImageTextAlternativeCommand(this.editor));\n    }\n}\n\n/**\n * The TextAlternativeFormView class.\n *\n * @internal\n */ class TextAlternativeFormView extends View {\n    /**\n\t * Tracks information about the DOM focus in the form.\n\t */ focusTracker;\n    /**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */ keystrokes;\n    /**\n\t * An input with a label.\n\t */ labeledInput;\n    /**\n\t * The Back button view displayed in the header.\n\t */ backButtonView;\n    /**\n\t * A button used to submit the form.\n\t */ saveButtonView;\n    /**\n\t * A collection of child views.\n\t */ children;\n    /**\n\t * A collection of views which can be focused in the form.\n\t */ _focusables;\n    /**\n\t * Helps cycling over {@link #_focusables} in the form.\n\t */ _focusCycler;\n    /**\n\t * @inheritDoc\n\t */ constructor(locale){\n        super(locale);\n        this.focusTracker = new FocusTracker();\n        this.keystrokes = new KeystrokeHandler();\n        // Create buttons.\n        this.backButtonView = this._createBackButton();\n        this.saveButtonView = this._createSaveButton();\n        // Create input fields.\n        this.labeledInput = this._createLabeledInputView();\n        this.children = this.createCollection([\n            this._createHeaderView()\n        ]);\n        this.children.add(new FormRowView(locale, {\n            children: [\n                this.labeledInput,\n                this.saveButtonView\n            ],\n            class: [\n                'ck-form__row_with-submit',\n                'ck-form__row_large-top-padding'\n            ]\n        }));\n        this._focusables = new ViewCollection();\n        // Close the panel on esc key press when the **form has focus**.\n        this.keystrokes.set('Esc', (data, cancel)=>{\n            this.fire('cancel');\n            cancel();\n        });\n        this._focusCycler = new FocusCycler({\n            focusables: this._focusables,\n            focusTracker: this.focusTracker,\n            keystrokeHandler: this.keystrokes,\n            actions: {\n                // Navigate form fields backwards using the Shift + Tab keystroke.\n                focusPrevious: 'shift + tab',\n                // Navigate form fields forwards using the Tab key.\n                focusNext: 'tab'\n            }\n        });\n        this.setTemplate({\n            tag: 'form',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-form',\n                    'ck-text-alternative-form',\n                    'ck-responsive-form'\n                ],\n                // https://github.com/ckeditor/ckeditor5-image/issues/40\n                tabindex: '-1'\n            },\n            children: this.children\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ render() {\n        super.render();\n        submitHandler({\n            view: this\n        });\n        const childViews = [\n            this.backButtonView,\n            this.labeledInput,\n            this.saveButtonView\n        ];\n        childViews.forEach((v)=>{\n            // Register the view as focusable.\n            this._focusables.add(v);\n            // Register the view in the focus tracker.\n            this.focusTracker.add(v.element);\n        });\n        this.keystrokes.listenTo(this.element);\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        super.destroy();\n        this.focusTracker.destroy();\n        this.keystrokes.destroy();\n    }\n    /**\n\t * Creates a back button view that cancels the form.\n\t */ _createBackButton() {\n        const t = this.locale.t;\n        const backButton = new ButtonView(this.locale);\n        backButton.set({\n            class: 'ck-button-back',\n            label: t('Back'),\n            icon: IconPreviousArrow,\n            tooltip: true\n        });\n        backButton.delegate('execute').to(this, 'cancel');\n        return backButton;\n    }\n    /**\n\t * Creates a save button view that text alternative the image.\n\t */ _createSaveButton() {\n        const t = this.locale.t;\n        const saveButton = new ButtonView(this.locale);\n        saveButton.set({\n            label: t('Save'),\n            withText: true,\n            type: 'submit',\n            class: 'ck-button-action ck-button-bold'\n        });\n        return saveButton;\n    }\n    /**\n\t * Creates a header view for the form.\n\t */ _createHeaderView() {\n        const t = this.locale.t;\n        const header = new FormHeaderView(this.locale, {\n            label: t('Text Alternative')\n        });\n        header.children.add(this.backButtonView, 0);\n        return header;\n    }\n    /**\n\t * Creates an input with a label.\n\t *\n\t * @returns Labeled field view instance.\n\t */ _createLabeledInputView() {\n        const t = this.locale.t;\n        const labeledInput = new LabeledFieldView(this.locale, createLabeledInputText);\n        labeledInput.label = t('Text alternative');\n        labeledInput.class = 'ck-labeled-field-view_full-width';\n        return labeledInput;\n    }\n}\n\n/**\n * A helper utility that positions the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} instance\n * with respect to the image in the editor content, if one is selected.\n *\n * @param editor The editor instance.\n * @internal\n */ function repositionContextualBalloon(editor) {\n    const balloon = editor.plugins.get('ContextualBalloon');\n    const imageUtils = editor.plugins.get('ImageUtils');\n    if (imageUtils.getClosestSelectedImageWidget(editor.editing.view.document.selection)) {\n        const position = getBalloonPositionData(editor);\n        balloon.updatePosition(position);\n    }\n}\n/**\n * Returns the positioning options that control the geometry of the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} with respect\n * to the selected element in the editor content.\n *\n * @param editor The editor instance.\n * @internal\n */ function getBalloonPositionData(editor) {\n    const editingView = editor.editing.view;\n    const defaultPositions = BalloonPanelView.defaultPositions;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    return {\n        target: editingView.domConverter.mapViewToDom(imageUtils.getClosestSelectedImageWidget(editingView.document.selection)),\n        positions: [\n            defaultPositions.northArrowSouth,\n            defaultPositions.northArrowSouthWest,\n            defaultPositions.northArrowSouthEast,\n            defaultPositions.southArrowNorth,\n            defaultPositions.southArrowNorthWest,\n            defaultPositions.southArrowNorthEast,\n            defaultPositions.viewportStickyNorth\n        ]\n    };\n}\n\n/**\n * The image text alternative UI plugin.\n *\n * The plugin uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */ class ImageTextAlternativeUI extends Plugin {\n    /**\n\t * The contextual balloon plugin instance.\n\t */ _balloon;\n    /**\n\t * A form containing a textarea and buttons, used to change the `alt` text value.\n\t */ _form;\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ContextualBalloon\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageTextAlternativeUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        this._createButton();\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        super.destroy();\n        // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n        if (this._form) {\n            this._form.destroy();\n        }\n    }\n    /**\n\t * Creates a button showing the balloon panel for changing the image text alternative and\n\t * registers it in the editor {@link module:ui/componentfactory~ComponentFactory ComponentFactory}.\n\t */ _createButton() {\n        const editor = this.editor;\n        const t = editor.t;\n        editor.ui.componentFactory.add('imageTextAlternative', (locale)=>{\n            const command = editor.commands.get('imageTextAlternative');\n            const view = new ButtonView(locale);\n            view.set({\n                label: t('Change image text alternative'),\n                icon: IconTextAlternative,\n                tooltip: true\n            });\n            view.bind('isEnabled').to(command, 'isEnabled');\n            view.bind('isOn').to(command, 'value', (value)=>!!value);\n            this.listenTo(view, 'execute', ()=>{\n                this._showForm();\n            });\n            return view;\n        });\n    }\n    /**\n\t * Creates the {@link module:image/imagetextalternative/ui/textalternativeformview~TextAlternativeFormView}\n\t * form.\n\t */ _createForm() {\n        const editor = this.editor;\n        const view = editor.editing.view;\n        const viewDocument = view.document;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        this._balloon = this.editor.plugins.get('ContextualBalloon');\n        this._form = new (CssTransitionDisablerMixin(TextAlternativeFormView))(editor.locale);\n        // Render the form so its #element is available for clickOutsideHandler.\n        this._form.render();\n        this.listenTo(this._form, 'submit', ()=>{\n            editor.execute('imageTextAlternative', {\n                newValue: this._form.labeledInput.fieldView.element.value\n            });\n            this._hideForm(true);\n        });\n        this.listenTo(this._form, 'cancel', ()=>{\n            this._hideForm(true);\n        });\n        // Reposition the balloon or hide the form if an image widget is no longer selected.\n        this.listenTo(editor.ui, 'update', ()=>{\n            if (!imageUtils.getClosestSelectedImageWidget(viewDocument.selection)) {\n                this._hideForm(true);\n            } else if (this._isVisible) {\n                repositionContextualBalloon(editor);\n            }\n        });\n        // Close on click outside of balloon panel element.\n        clickOutsideHandler({\n            emitter: this._form,\n            activator: ()=>this._isVisible,\n            contextElements: ()=>[\n                    this._balloon.view.element\n                ],\n            callback: ()=>this._hideForm()\n        });\n    }\n    /**\n\t * Shows the {@link #_form} in the {@link #_balloon}.\n\t */ _showForm() {\n        if (this._isVisible) {\n            return;\n        }\n        if (!this._form) {\n            this._createForm();\n        }\n        const editor = this.editor;\n        const command = editor.commands.get('imageTextAlternative');\n        const labeledInput = this._form.labeledInput;\n        this._form.disableCssTransitions();\n        if (!this._isInBalloon) {\n            this._balloon.add({\n                view: this._form,\n                position: getBalloonPositionData(editor)\n            });\n        }\n        // Make sure that each time the panel shows up, the field remains in sync with the value of\n        // the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n        // stays unaltered) and re-opened it without changing the value of the command, they would see the\n        // old value instead of the actual value of the command.\n        // https://github.com/ckeditor/ckeditor5-image/issues/114\n        labeledInput.fieldView.value = labeledInput.fieldView.element.value = command.value || '';\n        this._form.labeledInput.fieldView.select();\n        this._form.enableCssTransitions();\n    }\n    /**\n\t * Removes the {@link #_form} from the {@link #_balloon}.\n\t *\n\t * @param focusEditable Controls whether the editing view is focused afterwards.\n\t */ _hideForm(focusEditable = false) {\n        if (!this._isInBalloon) {\n            return;\n        }\n        // Blur the input element before removing it from DOM to prevent issues in some browsers.\n        // See https://github.com/ckeditor/ckeditor5/issues/1501.\n        if (this._form.focusTracker.isFocused) {\n            this._form.saveButtonView.focus();\n        }\n        this._balloon.remove(this._form);\n        if (focusEditable) {\n            this.editor.editing.view.focus();\n        }\n    }\n    /**\n\t * Returns `true` when the {@link #_form} is the visible view in the {@link #_balloon}.\n\t */ get _isVisible() {\n        return !!this._balloon && this._balloon.visibleView === this._form;\n    }\n    /**\n\t * Returns `true` when the {@link #_form} is in the {@link #_balloon}.\n\t */ get _isInBalloon() {\n        return !!this._balloon && this._balloon.hasView(this._form);\n    }\n}\n\n/**\n * The image text alternative plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-styles image styles} documentation.\n *\n * This is a \"glue\" plugin which loads the\n *  {@link module:image/imagetextalternative/imagetextalternativeediting~ImageTextAlternativeEditing}\n * and {@link module:image/imagetextalternative/imagetextalternativeui~ImageTextAlternativeUI} plugins.\n */ class ImageTextAlternative extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageTextAlternativeEditing,\n            ImageTextAlternativeUI\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageTextAlternative';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * Returns a function that converts the image view representation:\n *\n * ```html\n * <figure class=\"image\"><img src=\"...\" alt=\"...\"></img></figure>\n * ```\n *\n * to the model representation:\n *\n * ```html\n * <imageBlock src=\"...\" alt=\"...\"></imageBlock>\n * ```\n *\n * The entire content of the `<figure>` element except the first `<img>` is being converted as children\n * of the `<imageBlock>` model element.\n *\n * @internal\n */ function upcastImageFigure(imageUtils) {\n    const converter = (evt, data, conversionApi)=>{\n        // Do not convert if this is not an \"image figure\".\n        if (!conversionApi.consumable.test(data.viewItem, {\n            name: true,\n            classes: 'image'\n        })) {\n            return;\n        }\n        // Find an image element inside the figure element.\n        const viewImage = imageUtils.findViewImgElement(data.viewItem);\n        // Do not convert if image element is absent or was already converted.\n        if (!viewImage || !conversionApi.consumable.test(viewImage, {\n            name: true\n        })) {\n            return;\n        }\n        // Consume the figure to prevent other converters from processing it again.\n        conversionApi.consumable.consume(data.viewItem, {\n            name: true,\n            classes: 'image'\n        });\n        // Convert view image to model image.\n        const conversionResult = conversionApi.convertItem(viewImage, data.modelCursor);\n        // Get image element from conversion result.\n        const modelImage = first(conversionResult.modelRange.getItems());\n        // When image wasn't successfully converted then finish conversion.\n        if (!modelImage) {\n            // Revert consumed figure so other features can convert it.\n            conversionApi.consumable.revert(data.viewItem, {\n                name: true,\n                classes: 'image'\n            });\n            return;\n        }\n        // Convert rest of the figure element's children as an image children.\n        conversionApi.convertChildren(data.viewItem, modelImage);\n        conversionApi.updateConversionResult(modelImage, data);\n    };\n    return (dispatcher)=>{\n        dispatcher.on('element:figure', converter);\n    };\n}\n/**\n * Returns a function that converts the image view representation:\n *\n * ```html\n * <picture><source ... /><source ... />...<img ... /></picture>\n * ```\n *\n * to the model representation as the `sources` attribute:\n *\n * ```html\n * <image[Block|Inline] ... sources=\"...\"></image[Block|Inline]>\n * ```\n *\n * @internal\n */ function upcastPicture(imageUtils) {\n    const sourceAttributeNames = [\n        'srcset',\n        'media',\n        'type',\n        'sizes'\n    ];\n    const converter = (evt, data, conversionApi)=>{\n        const pictureViewElement = data.viewItem;\n        // Do not convert <picture> if already consumed.\n        if (!conversionApi.consumable.test(pictureViewElement, {\n            name: true\n        })) {\n            return;\n        }\n        const sources = new Map();\n        // Collect all <source /> elements attribute values.\n        for (const childSourceElement of pictureViewElement.getChildren()){\n            if (childSourceElement.is('element', 'source')) {\n                const attributes = {};\n                for (const name of sourceAttributeNames){\n                    if (childSourceElement.hasAttribute(name)) {\n                        // Don't collect <source /> attribute if already consumed somewhere else.\n                        if (conversionApi.consumable.test(childSourceElement, {\n                            attributes: name\n                        })) {\n                            attributes[name] = childSourceElement.getAttribute(name);\n                        }\n                    }\n                }\n                if (Object.keys(attributes).length) {\n                    sources.set(childSourceElement, attributes);\n                }\n            }\n        }\n        const imgViewElement = imageUtils.findViewImgElement(pictureViewElement);\n        // Don't convert when a picture has no <img/> inside (it is broken).\n        if (!imgViewElement) {\n            return;\n        }\n        let modelImage = data.modelCursor.parent;\n        // - In case of an inline image (cursor parent in a <paragraph>), the <img/> must be converted right away\n        // because no converter handled it yet and otherwise there would be no model element to set the sources attribute on.\n        // - In case of a block image, the <figure class=\"image\"> converter (in ImageBlockEditing) converts the\n        // <img/> right away on its own and the modelCursor is already inside an imageBlock and there's nothing special\n        // to do here.\n        if (!modelImage.is('element', 'imageBlock')) {\n            const conversionResult = conversionApi.convertItem(imgViewElement, data.modelCursor);\n            // Set image range as conversion result.\n            data.modelRange = conversionResult.modelRange;\n            // Continue conversion where image conversion ends.\n            data.modelCursor = conversionResult.modelCursor;\n            modelImage = first(conversionResult.modelRange.getItems());\n        }\n        conversionApi.consumable.consume(pictureViewElement, {\n            name: true\n        });\n        // Consume only these <source/> attributes that were actually collected and will be passed on\n        // to the image model element.\n        for (const [sourceElement, attributes] of sources){\n            conversionApi.consumable.consume(sourceElement, {\n                attributes: Object.keys(attributes)\n            });\n        }\n        if (sources.size) {\n            conversionApi.writer.setAttribute('sources', Array.from(sources.values()), modelImage);\n        }\n        // Convert rest of the <picture> children as an image children. Other converters may want to consume them.\n        conversionApi.convertChildren(pictureViewElement, modelImage);\n    };\n    return (dispatcher)=>{\n        dispatcher.on('element:picture', converter);\n    };\n}\n/**\n * Converter used to convert the `srcset` model image attribute to the `srcset` and `sizes` attributes in the view.\n *\n * @internal\n * @param imageType The type of the image.\n */ function downcastSrcsetAttribute(imageUtils, imageType) {\n    const converter = (evt, data, conversionApi)=>{\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n            return;\n        }\n        const writer = conversionApi.writer;\n        const element = conversionApi.mapper.toViewElement(data.item);\n        const img = imageUtils.findViewImgElement(element);\n        if (data.attributeNewValue === null) {\n            writer.removeAttribute('srcset', img);\n            writer.removeAttribute('sizes', img);\n        } else {\n            if (data.attributeNewValue) {\n                writer.setAttribute('srcset', data.attributeNewValue, img);\n                // Always outputting `100vw`. See https://github.com/ckeditor/ckeditor5-image/issues/2.\n                writer.setAttribute('sizes', '100vw', img);\n            }\n        }\n    };\n    return (dispatcher)=>{\n        dispatcher.on(`attribute:srcset:${imageType}`, converter);\n    };\n}\n/**\n * Converts the `source` model attribute to the `<picture><source /><source />...<img /></picture>`\n * view structure.\n *\n * @internal\n */ function downcastSourcesAttribute(imageUtils) {\n    const converter = (evt, data, conversionApi)=>{\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n            return;\n        }\n        const viewWriter = conversionApi.writer;\n        const element = conversionApi.mapper.toViewElement(data.item);\n        const imgElement = imageUtils.findViewImgElement(element);\n        const attributeNewValue = data.attributeNewValue;\n        if (attributeNewValue && attributeNewValue.length) {\n            // Collect all wrapping attribute elements.\n            const attributeElements = [];\n            let viewElement = imgElement.parent;\n            while(viewElement && viewElement.is('attributeElement')){\n                const parentElement = viewElement.parent;\n                viewWriter.unwrap(viewWriter.createRangeOn(imgElement), viewElement);\n                attributeElements.unshift(viewElement);\n                viewElement = parentElement;\n            }\n            const hasPictureElement = imgElement.parent.is('element', 'picture');\n            // Reuse existing <picture> element (ckeditor5#17192) or create a new one.\n            const pictureElement = hasPictureElement ? imgElement.parent : viewWriter.createContainerElement('picture', null);\n            if (!hasPictureElement) {\n                viewWriter.insert(viewWriter.createPositionBefore(imgElement), pictureElement);\n            }\n            viewWriter.remove(viewWriter.createRangeIn(pictureElement));\n            viewWriter.insert(viewWriter.createPositionAt(pictureElement, 'end'), attributeNewValue.map((sourceAttributes)=>{\n                return viewWriter.createEmptyElement('source', sourceAttributes);\n            }));\n            viewWriter.move(viewWriter.createRangeOn(imgElement), viewWriter.createPositionAt(pictureElement, 'end'));\n            // Apply collected attribute elements over the new picture element.\n            for (const attributeElement of attributeElements){\n                viewWriter.wrap(viewWriter.createRangeOn(pictureElement), attributeElement);\n            }\n        } else if (imgElement.parent.is('element', 'picture')) {\n            const pictureElement = imgElement.parent;\n            viewWriter.move(viewWriter.createRangeOn(imgElement), viewWriter.createPositionBefore(pictureElement));\n            viewWriter.remove(pictureElement);\n        }\n    };\n    return (dispatcher)=>{\n        dispatcher.on('attribute:sources:imageBlock', converter);\n        dispatcher.on('attribute:sources:imageInline', converter);\n    };\n}\n/**\n * Converter used to convert a given image attribute from the model to the view.\n *\n * @internal\n * @param imageType The type of the image.\n * @param attributeKey The name of the attribute to convert.\n */ function downcastImageAttribute(imageUtils, imageType, attributeKey) {\n    const converter = (evt, data, conversionApi)=>{\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n            return;\n        }\n        const viewWriter = conversionApi.writer;\n        const element = conversionApi.mapper.toViewElement(data.item);\n        const img = imageUtils.findViewImgElement(element);\n        viewWriter.setAttribute(data.attributeKey, data.attributeNewValue || '', img);\n    };\n    return (dispatcher)=>{\n        dispatcher.on(`attribute:${attributeKey}:${imageType}`, converter);\n    };\n}\n\n/**\n * Observes all new images added to the {@link module:engine/view/document~ViewDocument},\n * fires {@link module:engine/view/document~ViewDocument#event:imageLoaded} and\n * {@link module:engine/view/document~ViewDocument#event:layoutChanged} event every time when the new image\n * has been loaded.\n *\n * **Note:** This event is not fired for images that has been added to the document and rendered as `complete` (already loaded).\n */ class ImageLoadObserver extends Observer {\n    /**\n\t * @inheritDoc\n\t */ observe(domRoot) {\n        this.listenTo(domRoot, 'load', (event, domEvent)=>{\n            const domElement = domEvent.target;\n            if (this.checkShouldIgnoreEventFromTarget(domElement)) {\n                return;\n            }\n            if (domElement.tagName == 'IMG') {\n                this._fireEvents(domEvent);\n            }\n        // Use capture phase for better performance (#4504).\n        }, {\n            useCapture: true\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ stopObserving(domRoot) {\n        this.stopListening(domRoot);\n    }\n    /**\n\t * Fires {@link module:engine/view/document~ViewDocument#event:layoutChanged} and\n\t * {@link module:engine/view/document~ViewDocument#event:imageLoaded}\n\t * if observer {@link #isEnabled is enabled}.\n\t *\n\t * @param domEvent The DOM event.\n\t */ _fireEvents(domEvent) {\n        if (this.isEnabled) {\n            this.document.fire('layoutChanged');\n            this.document.fire('imageLoaded', domEvent);\n        }\n    }\n}\n\n/**\n * Insert image command.\n *\n * The command is registered by the {@link module:image/image/imageediting~ImageEditing} plugin as `insertImage`\n * and it is also available via aliased `imageInsert` name.\n *\n * In order to insert an image at the current selection position\n * (according to the {@link module:widget/utils~findOptimalInsertionRange} algorithm),\n * execute the command and specify the image source:\n *\n * ```ts\n * editor.execute( 'insertImage', { source: 'http://url.to.the/image' } );\n * ```\n *\n * It is also possible to insert multiple images at once:\n *\n * ```ts\n * editor.execute( 'insertImage', {\n * \tsource:  [\n * \t\t'path/to/image.jpg',\n * \t\t'path/to/other-image.jpg'\n * \t]\n * } );\n * ```\n *\n * If you want to take the full control over the process, you can specify individual model attributes:\n *\n * ```ts\n * editor.execute( 'insertImage', {\n * \tsource:  [\n * \t\t{ src: 'path/to/image.jpg', alt: 'First alt text' },\n * \t\t{ src: 'path/to/other-image.jpg', alt: 'Second alt text', customAttribute: 'My attribute value' }\n * \t]\n * } );\n * ```\n */ class InsertImageCommand extends Command {\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        const configImageInsertType = editor.config.get('image.insert.type');\n        if (!editor.plugins.has('ImageBlockEditing')) {\n            if (configImageInsertType === 'block') {\n                /**\n\t\t\t\t * The {@link module:image/imageblock~ImageBlock} plugin must be enabled to allow inserting block images. See\n\t\t\t\t * {@link module:image/imageconfig~ImageInsertConfig#type} to learn more.\n\t\t\t\t *\n\t\t\t\t * @error image-block-plugin-required\n\t\t\t\t */ logWarning('image-block-plugin-required');\n            }\n        }\n        if (!editor.plugins.has('ImageInlineEditing')) {\n            if (configImageInsertType === 'inline') {\n                /**\n\t\t\t\t * The {@link module:image/imageinline~ImageInline} plugin must be enabled to allow inserting inline images. See\n\t\t\t\t * {@link module:image/imageconfig~ImageInsertConfig#type} to learn more.\n\t\t\t\t *\n\t\t\t\t * @error image-inline-plugin-required\n\t\t\t\t */ logWarning('image-inline-plugin-required');\n            }\n        }\n    }\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        this.isEnabled = imageUtils.isImageAllowed();\n    }\n    /**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options Options for the executed command.\n\t * @param options.imageType The type of the image to insert. If not specified, the type will be determined automatically.\n\t * @param options.source The image source or an array of image sources to insert.\n\t * @param options.breakBlock If set to `true`, the block at the selection start will be broken before inserting the image.\n\t * See the documentation of the command to learn more about accepted formats.\n\t */ execute(options) {\n        const sourceDefinitions = toArray(options.source);\n        const selection = this.editor.model.document.selection;\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        // In case of multiple images, each image (starting from the 2nd) will be inserted at a position that\n        // follows the previous one. That will move the selection and, to stay on the safe side and make sure\n        // all images inherit the same selection attributes, they are collected beforehand.\n        //\n        // Applying these attributes ensures, for instance, that inserting an (inline) image into a link does\n        // not split that link but preserves its continuity.\n        //\n        // Note: Selection attributes that do not make sense for images will be filtered out by insertImage() anyway.\n        const selectionAttributes = Object.fromEntries(selection.getAttributes());\n        sourceDefinitions.forEach((sourceDefinition, index)=>{\n            const selectedElement = selection.getSelectedElement();\n            if (typeof sourceDefinition === 'string') {\n                sourceDefinition = {\n                    src: sourceDefinition\n                };\n            }\n            // Inserting of an inline image replace the selected element and make a selection on the inserted image.\n            // Therefore inserting multiple inline images requires creating position after each element.\n            if (index && selectedElement && imageUtils.isImage(selectedElement)) {\n                const position = this.editor.model.createPositionAfter(selectedElement);\n                imageUtils.insertImage({\n                    ...sourceDefinition,\n                    ...selectionAttributes\n                }, position, options.imageType);\n            } else if (options.breakBlock) {\n                imageUtils.insertImage({\n                    ...sourceDefinition,\n                    ...selectionAttributes\n                }, selection.getFirstPosition(), options.imageType);\n            } else {\n                imageUtils.insertImage({\n                    ...sourceDefinition,\n                    ...selectionAttributes\n                }, null, options.imageType);\n            }\n        });\n    }\n}\n\n/**\n * @module image/image/replaceimagesourcecommand\n */ /**\n * Replace image source command.\n *\n * Changes image source to the one provided. Can be executed as follows:\n *\n * ```ts\n * editor.execute( 'replaceImageSource', { source: 'http://url.to.the/image' } );\n * ```\n */ class ReplaceImageSourceCommand extends Command {\n    constructor(editor){\n        super(editor);\n        this.decorate('cleanupImage');\n    }\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const element = this.editor.model.document.selection.getSelectedElement();\n        this.isEnabled = imageUtils.isImage(element);\n        this.value = this.isEnabled ? element.getAttribute('src') : null;\n    }\n    /**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options Options for the executed command.\n\t * @param options.source The image source to replace.\n\t */ execute(options) {\n        const image = this.editor.model.document.selection.getSelectedElement();\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        this.editor.model.change((writer)=>{\n            writer.setAttribute('src', options.source, image);\n            this.cleanupImage(writer, image);\n            imageUtils.setImageNaturalSizeAttributes(image);\n        });\n    }\n    /**\n\t * Cleanup image attributes that are not relevant to the new source.\n\t *\n\t * Removed attributes are: 'srcset', 'sizes', 'sources', 'width', 'height', 'alt'.\n\t *\n\t * This method is decorated, to allow custom cleanup logic.\n\t * For example, to remove 'myImageId' attribute after 'src' has changed:\n\t *\n\t * ```ts\n\t * replaceImageSourceCommand.on( 'cleanupImage', ( eventInfo, [ writer, image ] ) => {\n\t * \twriter.removeAttribute( 'myImageId', image );\n\t * } );\n\t * ```\n\t */ cleanupImage(writer, image) {\n        writer.removeAttribute('srcset', image);\n        writer.removeAttribute('sizes', image);\n        /**\n\t\t * In case responsive images some attributes should be cleaned up.\n\t\t * Check: https://github.com/ckeditor/ckeditor5/issues/15093\n\t\t */ writer.removeAttribute('sources', image);\n        writer.removeAttribute('width', image);\n        writer.removeAttribute('height', image);\n        writer.removeAttribute('alt', image);\n    }\n}\n\n/**\n * The image engine plugin. This module loads common code shared between\n * {@link module:image/image/imageinlineediting~ImageInlineEditing} and\n * {@link module:image/image/imageblockediting~ImageBlockEditing} plugins.\n *\n * This plugin registers the {@link module:image/image/insertimagecommand~InsertImageCommand 'insertImage'} command.\n */ class ImageEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const conversion = editor.conversion;\n        // See https://github.com/ckeditor/ckeditor5-image/issues/142.\n        editor.editing.view.addObserver(ImageLoadObserver);\n        conversion.for('upcast').attributeToAttribute({\n            view: {\n                name: 'img',\n                key: 'alt'\n            },\n            model: 'alt'\n        }).attributeToAttribute({\n            view: {\n                name: 'img',\n                key: 'srcset'\n            },\n            model: 'srcset'\n        });\n        const insertImageCommand = new InsertImageCommand(editor);\n        const replaceImageSourceCommand = new ReplaceImageSourceCommand(editor);\n        editor.commands.add('insertImage', insertImageCommand);\n        editor.commands.add('replaceImageSource', replaceImageSourceCommand);\n        // `imageInsert` is an alias for backward compatibility.\n        editor.commands.add('imageInsert', insertImageCommand);\n    }\n}\n\n/**\n * This plugin enables `width` and `height` attributes in inline and block image elements.\n */ class ImageSizeAttributes extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageSizeAttributes';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        this._registerSchema();\n        this._registerConverters('imageBlock');\n        this._registerConverters('imageInline');\n    }\n    /**\n\t * Registers the `width` and `height` attributes for inline and block images.\n\t */ _registerSchema() {\n        const schema = this.editor.model.schema;\n        if (this.editor.plugins.has('ImageBlockEditing')) {\n            schema.extend('imageBlock', {\n                allowAttributes: [\n                    'width',\n                    'height'\n                ]\n            });\n        }\n        if (this.editor.plugins.has('ImageInlineEditing')) {\n            schema.extend('imageInline', {\n                allowAttributes: [\n                    'width',\n                    'height'\n                ]\n            });\n        }\n    }\n    /**\n\t * Registers converters for `width` and `height` attributes.\n\t */ _registerConverters(imageType) {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const viewElementName = imageType === 'imageBlock' ? 'figure' : 'img';\n        editor.conversion.for('upcast').attributeToAttribute({\n            view: {\n                name: viewElementName,\n                styles: {\n                    width: /.+/\n                }\n            },\n            model: {\n                key: 'width',\n                value: (viewElement)=>{\n                    if (widthAndHeightStylesAreBothSet(viewElement)) {\n                        return getSizeValueIfInPx(viewElement.getStyle('width'));\n                    }\n                    return null;\n                }\n            }\n        }).attributeToAttribute({\n            view: {\n                name: viewElementName,\n                key: 'width'\n            },\n            model: 'width'\n        }).attributeToAttribute({\n            view: {\n                name: viewElementName,\n                styles: {\n                    height: /.+/\n                }\n            },\n            model: {\n                key: 'height',\n                value: (viewElement)=>{\n                    if (widthAndHeightStylesAreBothSet(viewElement)) {\n                        return getSizeValueIfInPx(viewElement.getStyle('height'));\n                    }\n                    return null;\n                }\n            }\n        }).attributeToAttribute({\n            view: {\n                name: viewElementName,\n                key: 'height'\n            },\n            model: 'height'\n        });\n        // Dedicated converters to propagate attributes to the <img> element.\n        editor.conversion.for('editingDowncast').add((dispatcher)=>{\n            attachDowncastConverter(dispatcher, 'width', 'width', true, true);\n            attachDowncastConverter(dispatcher, 'height', 'height', true, true);\n        });\n        editor.conversion.for('dataDowncast').add((dispatcher)=>{\n            attachDowncastConverter(dispatcher, 'width', 'width', false);\n            attachDowncastConverter(dispatcher, 'height', 'height', false);\n        });\n        // Consume `aspect-ratio` style if `width` and `height` attributes are set on the image.\n        editor.conversion.for('upcast').add((dispatcher)=>{\n            dispatcher.on('element:img', (evt, data, conversionApi)=>{\n                const width = data.viewItem.getAttribute('width');\n                const height = data.viewItem.getAttribute('height');\n                if (width && height) {\n                    conversionApi.consumable.consume(data.viewItem, {\n                        styles: [\n                            'aspect-ratio'\n                        ]\n                    });\n                }\n            });\n        });\n        function attachDowncastConverter(dispatcher, modelAttributeName, viewAttributeName, setRatioForInlineImage, isEditingDowncast = false) {\n            dispatcher.on(`attribute:${modelAttributeName}:${imageType}`, (evt, data, conversionApi)=>{\n                if (!conversionApi.consumable.consume(data.item, evt.name)) {\n                    return;\n                }\n                const viewWriter = conversionApi.writer;\n                const viewElement = conversionApi.mapper.toViewElement(data.item);\n                const img = imageUtils.findViewImgElement(viewElement);\n                if (data.attributeNewValue !== null) {\n                    viewWriter.setAttribute(viewAttributeName, data.attributeNewValue, img);\n                } else {\n                    viewWriter.removeAttribute(viewAttributeName, img);\n                }\n                const width = data.item.getAttribute('width');\n                const height = data.item.getAttribute('height');\n                const hasSizes = width && height;\n                if (hasSizes && isEditingDowncast) {\n                    viewWriter.setAttribute('loading', 'lazy', img);\n                }\n                // Do not set aspect-ratio for pictures. See https://github.com/ckeditor/ckeditor5/issues/14579.\n                if (data.item.hasAttribute('sources')) {\n                    return;\n                }\n                const isResized = data.item.hasAttribute('resizedWidth');\n                // Do not set aspect ratio for inline images which are not resized (data pipeline).\n                if (imageType === 'imageInline' && !isResized && !setRatioForInlineImage) {\n                    return;\n                }\n                if (hasSizes) {\n                    viewWriter.setStyle('aspect-ratio', `${width}/${height}`, img);\n                }\n            });\n        }\n    }\n}\n\n/**\n * The image type command. It changes the type of a selected image, depending on the configuration.\n */ class ImageTypeCommand extends Command {\n    /**\n\t * Model element name the command converts to.\n\t */ _modelElementName;\n    /**\n\t * @inheritDoc\n\t *\n\t * @param modelElementName Model element name the command converts to.\n\t */ constructor(editor, modelElementName){\n        super(editor);\n        this._modelElementName = modelElementName;\n    }\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const element = imageUtils.getClosestSelectedImageElement(this.editor.model.document.selection);\n        if (this._modelElementName === 'imageBlock') {\n            this.isEnabled = imageUtils.isInlineImage(element);\n        } else {\n            this.isEnabled = imageUtils.isBlockImage(element);\n        }\n    }\n    /**\n\t * Executes the command and changes the type of a selected image.\n\t *\n\t * @fires execute\n\t * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n\t * The default is `true`.\n\t * @returns An object containing references to old and new model image elements\n\t * (for before and after the change) so external integrations can hook into the decorated\n\t * `execute` event and handle this change. `null` if the type change failed.\n\t */ execute(options = {}) {\n        const editor = this.editor;\n        const model = this.editor.model;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const oldElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n        const attributes = Object.fromEntries(oldElement.getAttributes());\n        // Don't change image type if \"src\" is missing (a broken image), unless there's \"uploadId\" set.\n        // This state may happen during image upload (before it finishes) and it should be possible to change type\n        // of the image in the meantime.\n        if (!attributes.src && !attributes.uploadId) {\n            return null;\n        }\n        return model.change((writer)=>{\n            const { setImageSizes = true } = options;\n            // Get all markers that contain the old image element.\n            const markers = Array.from(model.markers).filter((marker)=>marker.getRange().containsItem(oldElement));\n            const newElement = imageUtils.insertImage(attributes, model.createSelection(oldElement, 'on'), this._modelElementName, {\n                setImageSizes\n            });\n            if (!newElement) {\n                return null;\n            }\n            const newElementRange = writer.createRangeOn(newElement);\n            // Expand the previously intersecting markers' ranges to include the new image element.\n            for (const marker of markers){\n                const markerRange = marker.getRange();\n                // Join the survived part of the old marker range with the new element range\n                // (loosely because there could be some new paragraph or the existing one might got split).\n                const range = markerRange.root.rootName != '$graveyard' ? markerRange.getJoined(newElementRange, true) : newElementRange;\n                writer.updateMarker(marker, {\n                    range\n                });\n            }\n            return {\n                oldElement,\n                newElement\n            };\n        });\n    }\n}\n\n/**\n * Adds support for image placeholder that is automatically removed when the image is loaded.\n */ class ImagePlaceholder extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImagePlaceholder';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        this._setupSchema();\n        this._setupConversion();\n        this._setupLoadListener();\n    }\n    /**\n\t * Extends model schema.\n\t */ _setupSchema() {\n        const schema = this.editor.model.schema;\n        // Wait for ImageBlockEditing or ImageInlineEditing to register their elements first,\n        // that's why doing this in afterInit() instead of init().\n        if (schema.isRegistered('imageBlock')) {\n            schema.extend('imageBlock', {\n                allowAttributes: [\n                    'placeholder'\n                ]\n            });\n        }\n        if (schema.isRegistered('imageInline')) {\n            schema.extend('imageInline', {\n                allowAttributes: [\n                    'placeholder'\n                ]\n            });\n        }\n    }\n    /**\n\t * Registers converters.\n\t */ _setupConversion() {\n        const editor = this.editor;\n        const conversion = editor.conversion;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        conversion.for('editingDowncast').add((dispatcher)=>{\n            dispatcher.on('attribute:placeholder', (evt, data, conversionApi)=>{\n                if (!conversionApi.consumable.test(data.item, evt.name)) {\n                    return;\n                }\n                if (!data.item.is('element', 'imageBlock') && !data.item.is('element', 'imageInline')) {\n                    return;\n                }\n                conversionApi.consumable.consume(data.item, evt.name);\n                const viewWriter = conversionApi.writer;\n                const element = conversionApi.mapper.toViewElement(data.item);\n                const img = imageUtils.findViewImgElement(element);\n                if (data.attributeNewValue) {\n                    viewWriter.addClass('image_placeholder', img);\n                    viewWriter.setStyle('background-image', `url(${data.attributeNewValue})`, img);\n                    viewWriter.setCustomProperty('editingPipeline:doNotReuseOnce', true, img);\n                } else {\n                    viewWriter.removeClass('image_placeholder', img);\n                    viewWriter.removeStyle('background-image', img);\n                }\n            });\n        });\n    }\n    /**\n\t * Prepares listener for image load.\n\t */ _setupLoadListener() {\n        const editor = this.editor;\n        const model = editor.model;\n        const editing = editor.editing;\n        const editingView = editing.view;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        editingView.addObserver(ImageLoadObserver);\n        this.listenTo(editingView.document, 'imageLoaded', (evt, domEvent)=>{\n            const imgViewElement = editingView.domConverter.mapDomToView(domEvent.target);\n            if (!imgViewElement) {\n                return;\n            }\n            const viewElement = imageUtils.getImageWidgetFromImageView(imgViewElement);\n            if (!viewElement) {\n                return;\n            }\n            const modelElement = editing.mapper.toModelElement(viewElement);\n            if (!modelElement || !modelElement.hasAttribute('placeholder')) {\n                return;\n            }\n            model.enqueueChange({\n                isUndoable: false\n            }, (writer)=>{\n                writer.removeAttribute('placeholder', modelElement);\n            });\n        });\n    }\n}\n\n/**\n * The image block plugin.\n *\n * It registers:\n *\n * * `<imageBlock>` as a block element in the document schema, and allows `alt`, `src` and `srcset` attributes.\n * * converters for editing and data pipelines.,\n * * {@link module:image/image/imagetypecommand~ImageTypeCommand `'imageTypeBlock'`} command that converts inline images into\n * block images.\n */ class ImageBlockEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageEditing,\n            ImageSizeAttributes,\n            ImageUtils,\n            ImagePlaceholder,\n            ClipboardPipeline\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageBlockEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const schema = editor.model.schema;\n        // Converters 'alt' and 'srcset' are added in 'ImageEditing' plugin.\n        schema.register('imageBlock', {\n            inheritAllFrom: '$blockObject',\n            allowAttributes: [\n                'alt',\n                'src',\n                'srcset'\n            ]\n        });\n        this._setupConversion();\n        if (editor.plugins.has('ImageInlineEditing')) {\n            editor.commands.add('imageTypeBlock', new ImageTypeCommand(this.editor, 'imageBlock'));\n            this._setupClipboardIntegration();\n        }\n    }\n    /**\n\t * Configures conversion pipelines to support upcasting and downcasting\n\t * block images (block image widgets) and their attributes.\n\t */ _setupConversion() {\n        const editor = this.editor;\n        const t = editor.t;\n        const conversion = editor.conversion;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        conversion.for('dataDowncast').elementToStructure({\n            model: 'imageBlock',\n            view: (modelElement, { writer })=>createBlockImageViewElement(writer)\n        });\n        conversion.for('editingDowncast').elementToStructure({\n            model: 'imageBlock',\n            view: (modelElement, { writer })=>imageUtils.toImageWidget(createBlockImageViewElement(writer), writer, t('image widget'))\n        });\n        conversion.for('downcast').add(downcastImageAttribute(imageUtils, 'imageBlock', 'src')).add(downcastImageAttribute(imageUtils, 'imageBlock', 'alt')).add(downcastSrcsetAttribute(imageUtils, 'imageBlock'));\n        // More image related upcasts are in 'ImageEditing' plugin.\n        conversion.for('upcast').elementToElement({\n            view: getImgViewElementMatcher(editor, 'imageBlock'),\n            model: (viewImage, { writer })=>writer.createElement('imageBlock', viewImage.hasAttribute('src') ? {\n                    src: viewImage.getAttribute('src')\n                } : undefined)\n        }).add(upcastImageFigure(imageUtils));\n    }\n    /**\n\t * Integrates the plugin with the clipboard pipeline.\n\t *\n\t * Idea is that the feature should recognize the user's intent when an **inline** image is\n\t * pasted or dropped. If such an image is pasted/dropped:\n\t *\n\t * * into an empty block (e.g. an empty paragraph),\n\t * * on another object (e.g. some block widget).\n\t *\n\t * it gets converted into a block image on the fly. We assume this is the user's intent\n\t * if they decided to put their image there.\n\t *\n\t * See the `ImageInlineEditing` for the similar integration that works in the opposite direction.\n\t *\n\t * The feature also sets image `width` and `height` attributes on paste.\n\t */ _setupClipboardIntegration() {\n        const editor = this.editor;\n        const model = editor.model;\n        const editingView = editor.editing.view;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n        this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data)=>{\n            const docFragmentChildren = Array.from(data.content.getChildren());\n            let modelRange;\n            // Make sure only <img> elements are dropped or pasted. Otherwise, if there some other HTML\n            // mixed up, this should be handled as a regular paste.\n            if (!docFragmentChildren.every(imageUtils.isInlineImageView)) {\n                return;\n            }\n            // When drag and dropping, data.targetRanges specifies where to drop because\n            // this is usually a different place than the current model selection (the user\n            // uses a drop marker to specify the drop location).\n            if (data.targetRanges) {\n                modelRange = editor.editing.mapper.toModelRange(data.targetRanges[0]);\n            } else {\n                modelRange = model.document.selection.getFirstRange();\n            }\n            const selection = model.createSelection(modelRange);\n            // Convert inline images into block images only when the currently selected block is empty\n            // (e.g. an empty paragraph) or some object is selected (to replace it).\n            if (determineImageTypeForInsertionAtSelection(model.schema, selection) === 'imageBlock') {\n                const writer = new ViewUpcastWriter(editingView.document);\n                // Wrap <img ... /> -> <figure class=\"image\"><img .../></figure>\n                const blockViewImages = docFragmentChildren.map((inlineViewImage)=>writer.createElement('figure', {\n                        class: 'image'\n                    }, inlineViewImage));\n                data.content = writer.createDocumentFragment(blockViewImages);\n            }\n        });\n        this.listenTo(clipboardPipeline, 'contentInsertion', (evt, data)=>{\n            if (data.method !== 'paste') {\n                return;\n            }\n            model.change((writer)=>{\n                const range = writer.createRangeIn(data.content);\n                for (const item of range.getItems()){\n                    if (item.is('element', 'imageBlock')) {\n                        imageUtils.setImageNaturalSizeAttributes(item);\n                    }\n                }\n            });\n        });\n    }\n}\n\n/**\n * The view displayed in the insert image dropdown.\n *\n * See {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n *\n * @internal\n */ class ImageInsertFormView extends View {\n    /**\n\t * Tracks information about DOM focus in the form.\n\t */ focusTracker;\n    /**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */ keystrokes;\n    /**\n\t * A collection of views that can be focused in the form.\n\t */ _focusables;\n    /**\n\t * Helps cycling over {@link #_focusables} in the form.\n\t */ _focusCycler;\n    /**\n\t * A collection of the defined integrations for inserting the images.\n\t */ children;\n    /**\n\t * Creates a view for the dropdown panel of {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n\t *\n\t * @param locale The localization services instance.\n\t * @param integrations An integrations object that contains components (or tokens for components) to be shown in the panel view.\n\t */ constructor(locale, integrations = []){\n        super(locale);\n        this.focusTracker = new FocusTracker();\n        this.keystrokes = new KeystrokeHandler();\n        this._focusables = new ViewCollection();\n        this.children = this.createCollection();\n        this._focusCycler = new FocusCycler({\n            focusables: this._focusables,\n            focusTracker: this.focusTracker,\n            keystrokeHandler: this.keystrokes,\n            actions: {\n                // Navigate form fields backwards using the Shift + Tab keystroke.\n                focusPrevious: 'shift + tab',\n                // Navigate form fields forwards using the Tab key.\n                focusNext: 'tab'\n            }\n        });\n        for (const view of integrations){\n            this.children.add(view);\n            this._focusables.add(view);\n            if (view instanceof CollapsibleView) {\n                this._focusables.addMany(view.children);\n            }\n        }\n        this.setTemplate({\n            tag: 'form',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-image-insert-form'\n                ],\n                tabindex: -1\n            },\n            children: this.children\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ render() {\n        super.render();\n        submitHandler({\n            view: this\n        });\n        for (const view of this._focusables){\n            this.focusTracker.add(view.element);\n        }\n        // Start listening for the keystrokes coming from #element.\n        this.keystrokes.listenTo(this.element);\n        const stopPropagation = (data)=>data.stopPropagation();\n        // Since the form is in the dropdown panel which is a child of the toolbar, the toolbar's\n        // keystroke handler would take over the key management in the URL input. We need to prevent\n        // this ASAP. Otherwise, the basic caret movement using the arrow keys will be impossible.\n        this.keystrokes.set('arrowright', stopPropagation);\n        this.keystrokes.set('arrowleft', stopPropagation);\n        this.keystrokes.set('arrowup', stopPropagation);\n        this.keystrokes.set('arrowdown', stopPropagation);\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        super.destroy();\n        this.focusTracker.destroy();\n        this.keystrokes.destroy();\n    }\n    /**\n\t * Focuses the first {@link #_focusables focusable} in the form.\n\t */ focus() {\n        this._focusCycler.focusFirst();\n    }\n}\n\n/**\n * The image insert dropdown plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature}\n * and {@glink features/images/images-inserting Insert images via source URL} documentation.\n *\n * Adds the `'insertImage'` dropdown to the {@link module:ui/componentfactory~ComponentFactory UI component factory}\n * and also the `imageInsert` dropdown as an alias for backward compatibility.\n *\n * Adds the `'menuBar:insertImage'` sub-menu to the {@link module:ui/componentfactory~ComponentFactory UI component factory}, which is\n * by default added to the `'Insert'` menu.\n */ class ImageInsertUI extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageInsertUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * The dropdown view responsible for displaying the image insert UI.\n\t */ dropdownView;\n    /**\n\t * Registered integrations map.\n\t */ _integrations = new Map();\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        editor.config.define('image.insert.integrations', [\n            'upload',\n            'assetManager',\n            'url'\n        ]);\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const selection = editor.model.document.selection;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        this.set('isImageSelected', false);\n        this.listenTo(editor.model.document, 'change', ()=>{\n            this.isImageSelected = imageUtils.isImage(selection.getSelectedElement());\n        });\n        const componentCreator = (locale)=>this._createToolbarComponent(locale);\n        const menuBarComponentCreator = (locale)=>this._createMenuBarComponent(locale);\n        // Register `insertImage` dropdown and add `imageInsert` dropdown as an alias for backward compatibility.\n        editor.ui.componentFactory.add('insertImage', componentCreator);\n        editor.ui.componentFactory.add('imageInsert', componentCreator);\n        editor.ui.componentFactory.add('menuBar:insertImage', menuBarComponentCreator);\n    }\n    /**\n\t * Registers the insert image dropdown integration.\n\t */ registerIntegration({ name, observable, buttonViewCreator, formViewCreator, menuBarButtonViewCreator, requiresForm = false, override = false }) {\n        if (this._integrations.has(name) && !override) {\n            /**\n\t\t\t * There are two insert-image integrations registered with the same name.\n\t\t\t *\n\t\t\t * Make sure that you do not load multiple asset manager plugins.\n\t\t\t *\n\t\t\t * @error image-insert-integration-exists\n\t\t\t */ logWarning('image-insert-integration-exists', {\n                name\n            });\n        }\n        this._integrations.set(name, {\n            observable,\n            buttonViewCreator,\n            menuBarButtonViewCreator,\n            formViewCreator,\n            requiresForm\n        });\n    }\n    /**\n\t * Creates the toolbar component.\n\t */ _createToolbarComponent(locale) {\n        const editor = this.editor;\n        const t = locale.t;\n        const integrations = this._prepareIntegrations();\n        if (!integrations.length) {\n            return null;\n        }\n        let dropdownButton;\n        const firstIntegration = integrations[0];\n        if (integrations.length == 1) {\n            // Do not use dropdown for a single integration button (integration that does not require form view).\n            if (!firstIntegration.requiresForm) {\n                return firstIntegration.buttonViewCreator(true);\n            }\n            dropdownButton = firstIntegration.buttonViewCreator(true);\n        } else {\n            const actionButton = firstIntegration.buttonViewCreator(false);\n            dropdownButton = new SplitButtonView(locale, actionButton);\n            dropdownButton.tooltip = true;\n            dropdownButton.bind('label').to(this, 'isImageSelected', (isImageSelected)=>isImageSelected ? t('Replace image') : t('Insert image'));\n        }\n        const dropdownView = this.dropdownView = createDropdown(locale, dropdownButton);\n        const observables = integrations.map(({ observable })=>typeof observable == 'function' ? observable() : observable);\n        dropdownView.bind('isEnabled').toMany(observables, 'isEnabled', (...isEnabled)=>isEnabled.some((isEnabled)=>isEnabled));\n        dropdownView.once('change:isOpen', ()=>{\n            const integrationViews = integrations.flatMap(({ formViewCreator })=>formViewCreator(integrations.length == 1));\n            const imageInsertFormView = new ImageInsertFormView(editor.locale, integrationViews);\n            dropdownView.panelView.children.add(imageInsertFormView);\n        });\n        return dropdownView;\n    }\n    /**\n\t * Creates the menu bar component.\n\t */ _createMenuBarComponent(locale) {\n        const t = locale.t;\n        const integrations = this._prepareIntegrations();\n        if (!integrations.length) {\n            return null;\n        }\n        const integrationViews = integrations.flatMap(({ menuBarButtonViewCreator })=>menuBarButtonViewCreator(integrations.length == 1));\n        const resultView = new MenuBarMenuView(locale);\n        const listView = new MenuBarMenuListView(locale);\n        resultView.panelView.children.add(listView);\n        resultView.buttonView.set({\n            icon: IconImage,\n            label: t('Image')\n        });\n        for (const integrationView of integrationViews){\n            const listItemView = new MenuBarMenuListItemView(locale, resultView);\n            listItemView.children.add(integrationView);\n            listView.items.add(listItemView);\n            integrationView.delegate('execute').to(resultView);\n        }\n        return resultView;\n    }\n    /**\n\t * Validates the integrations list.\n\t */ _prepareIntegrations() {\n        const editor = this.editor;\n        const items = editor.config.get('image.insert.integrations');\n        const result = [];\n        if (!items.length) {\n            /**\n\t\t\t * The insert image feature requires a list of integrations to be provided in the editor configuration.\n\t\t\t *\n\t\t\t * The default list of integrations is `upload`, `assetManager`, `url`. Those integrations are included\n\t\t\t * in the insert image dropdown if the given feature plugin is loaded. You should omit the `integrations`\n\t\t\t * configuration key to use the default set or provide a selected list of integrations that should be used.\n\t\t\t *\n\t\t\t * @error image-insert-integrations-not-specified\n\t\t\t */ logWarning('image-insert-integrations-not-specified');\n            return result;\n        }\n        for (const item of items){\n            if (!this._integrations.has(item)) {\n                if (![\n                    'upload',\n                    'assetManager',\n                    'url'\n                ].includes(item)) {\n                    /**\n\t\t\t\t\t * The specified insert image integration name is unknown or the providing plugin is not loaded in the editor.\n\t\t\t\t\t *\n\t\t\t\t\t * @error image-insert-unknown-integration\n\t\t\t\t\t */ logWarning('image-insert-unknown-integration', {\n                        item\n                    });\n                }\n                continue;\n            }\n            result.push(this._integrations.get(item));\n        }\n        if (!result.length) {\n            /**\n\t\t\t * The image insert feature requires integrations to be registered by separate features.\n\t\t\t *\n\t\t\t * The `insertImage` toolbar button requires integrations to be registered by other features.\n\t\t\t * For example {@link module:image/imageupload~ImageUpload ImageUpload},\n\t\t\t * {@link module:image/imageinsert~ImageInsert ImageInsert},\n\t\t\t * {@link module:image/imageinsertviaurl~ImageInsertViaUrl ImageInsertViaUrl},\n\t\t\t * {@link module:ckbox/ckbox~CKBox CKBox}\n\t\t\t *\n\t\t\t * @error image-insert-integrations-not-registered\n\t\t\t */ logWarning('image-insert-integrations-not-registered');\n        }\n        return result;\n    }\n}\n\n/**\n * The image block plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/image/imageblockediting~ImageBlockEditing},\n * * {@link module:image/imagetextalternative~ImageTextAlternative}.\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */ class ImageBlock extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageBlockEditing,\n            Widget,\n            ImageTextAlternative,\n            ImageInsertUI\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageBlock';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * The image inline plugin.\n *\n * It registers:\n *\n * * `<imageInline>` as an inline element in the document schema, and allows `alt`, `src` and `srcset` attributes.\n * * converters for editing and data pipelines.\n * * {@link module:image/image/imagetypecommand~ImageTypeCommand `'imageTypeInline'`} command that converts block images into\n * inline images.\n */ class ImageInlineEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageEditing,\n            ImageSizeAttributes,\n            ImageUtils,\n            ImagePlaceholder,\n            ClipboardPipeline\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageInlineEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const schema = editor.model.schema;\n        // Converters 'alt' and 'srcset' are added in 'ImageEditing' plugin.\n        schema.register('imageInline', {\n            inheritAllFrom: '$inlineObject',\n            allowAttributes: [\n                'alt',\n                'src',\n                'srcset'\n            ],\n            // Disallow inline images in captions (at least for now).\n            // This is the best spot to do that because independent packages can introduce captions (ImageCaption, TableCaption, etc.).\n            disallowIn: [\n                'caption'\n            ]\n        });\n        this._setupConversion();\n        if (editor.plugins.has('ImageBlockEditing')) {\n            editor.commands.add('imageTypeInline', new ImageTypeCommand(this.editor, 'imageInline'));\n            this._setupClipboardIntegration();\n        }\n    }\n    /**\n\t * Configures conversion pipelines to support upcasting and downcasting\n\t * inline images (inline image widgets) and their attributes.\n\t */ _setupConversion() {\n        const editor = this.editor;\n        const t = editor.t;\n        const conversion = editor.conversion;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        conversion.for('dataDowncast').elementToElement({\n            model: 'imageInline',\n            view: (modelElement, { writer })=>writer.createEmptyElement('img')\n        });\n        conversion.for('editingDowncast').elementToStructure({\n            model: 'imageInline',\n            view: (modelElement, { writer })=>imageUtils.toImageWidget(createInlineImageViewElement(writer), writer, t('image widget'))\n        });\n        conversion.for('downcast').add(downcastImageAttribute(imageUtils, 'imageInline', 'src')).add(downcastImageAttribute(imageUtils, 'imageInline', 'alt')).add(downcastSrcsetAttribute(imageUtils, 'imageInline'));\n        // More image related upcasts are in 'ImageEditing' plugin.\n        conversion.for('upcast').elementToElement({\n            view: getImgViewElementMatcher(editor, 'imageInline'),\n            model: (viewImage, { writer })=>writer.createElement('imageInline', viewImage.hasAttribute('src') ? {\n                    src: viewImage.getAttribute('src')\n                } : undefined)\n        });\n    }\n    /**\n\t * Integrates the plugin with the clipboard pipeline.\n\t *\n\t * Idea is that the feature should recognize the user's intent when an **block** image is\n\t * pasted or dropped. If such an image is pasted/dropped into a non-empty block\n\t * (e.g. a paragraph with some text) it gets converted into an inline image on the fly.\n\t *\n\t * We assume this is the user's intent if they decided to put their image there.\n\t *\n\t * **Note**: If a block image has a caption, it will not be converted to an inline image\n\t * to avoid the confusion. Captions are added on purpose and they should never be lost\n\t * in the clipboard pipeline.\n\t *\n\t * See the `ImageBlockEditing` for the similar integration that works in the opposite direction.\n\t *\n\t * The feature also sets image `width` and `height` attributes when pasting.\n\t */ _setupClipboardIntegration() {\n        const editor = this.editor;\n        const model = editor.model;\n        const editingView = editor.editing.view;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n        this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data)=>{\n            const docFragmentChildren = Array.from(data.content.getChildren());\n            let modelRange;\n            // Make sure only <figure class=\"image\"></figure> elements are dropped or pasted. Otherwise, if there some other HTML\n            // mixed up, this should be handled as a regular paste.\n            if (!docFragmentChildren.every(imageUtils.isBlockImageView)) {\n                return;\n            }\n            // When drag and dropping, data.targetRanges specifies where to drop because\n            // this is usually a different place than the current model selection (the user\n            // uses a drop marker to specify the drop location).\n            if (data.targetRanges) {\n                modelRange = editor.editing.mapper.toModelRange(data.targetRanges[0]);\n            } else {\n                modelRange = model.document.selection.getFirstRange();\n            }\n            const selection = model.createSelection(modelRange);\n            // Convert block images into inline images only when pasting or dropping into non-empty blocks\n            // and when the block is not an object (e.g. pasting to replace another widget).\n            if (determineImageTypeForInsertionAtSelection(model.schema, selection) === 'imageInline') {\n                const writer = new ViewUpcastWriter(editingView.document);\n                // Unwrap <figure class=\"image\"><img .../></figure> -> <img ... />\n                // but <figure class=\"image\"><img .../><figcaption>...</figcaption></figure> -> stays the same\n                const inlineViewImages = docFragmentChildren.map((blockViewImage)=>{\n                    // If there's just one child, it can be either <img /> or <a><img></a>.\n                    // If there are other children than <img>, this means that the block image\n                    // has a caption or some other features and this kind of image should be\n                    // pasted/dropped without modifications.\n                    if (blockViewImage.childCount === 1) {\n                        // Pass the attributes which are present only in the <figure> to the <img>\n                        // (e.g. the style=\"width:10%\" attribute applied by the ImageResize plugin).\n                        Array.from(blockViewImage.getAttributes()).forEach((attribute)=>writer.setAttribute(...attribute, imageUtils.findViewImgElement(blockViewImage)));\n                        return blockViewImage.getChild(0);\n                    } else {\n                        return blockViewImage;\n                    }\n                });\n                data.content = writer.createDocumentFragment(inlineViewImages);\n            }\n        });\n        this.listenTo(clipboardPipeline, 'contentInsertion', (evt, data)=>{\n            if (data.method !== 'paste') {\n                return;\n            }\n            model.change((writer)=>{\n                const range = writer.createRangeIn(data.content);\n                for (const item of range.getItems()){\n                    if (item.is('element', 'imageInline')) {\n                        imageUtils.setImageNaturalSizeAttributes(item);\n                    }\n                }\n            });\n        });\n    }\n}\n\n/**\n * The image inline plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/image/imageinlineediting~ImageInlineEditing},\n * * {@link module:image/imagetextalternative~ImageTextAlternative}.\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */ class ImageInline extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageInlineEditing,\n            Widget,\n            ImageTextAlternative,\n            ImageInsertUI\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageInline';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * The image plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-overview image feature} documentation.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/imageblock~ImageBlock},\n * * {@link module:image/imageinline~ImageInline},\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */ class Image extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageBlock,\n            ImageInline\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'Image';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * The image caption utilities plugin.\n */ class ImageCaptionUtils extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageCaptionUtils';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * Returns the caption model element from a given image element. Returns `null` if no caption is found.\n\t */ getCaptionFromImageModelElement(imageModelElement) {\n        for (const node of imageModelElement.getChildren()){\n            if (!!node && node.is('element', 'caption')) {\n                return node;\n            }\n        }\n        return null;\n    }\n    /**\n\t * Returns the caption model element for a model selection. Returns `null` if the selection has no caption element ancestor.\n\t */ getCaptionFromModelSelection(selection) {\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        const captionElement = selection.getFirstPosition().findAncestor('caption');\n        if (!captionElement) {\n            return null;\n        }\n        if (imageUtils.isBlockImage(captionElement.parent)) {\n            return captionElement;\n        }\n        return null;\n    }\n    /**\n\t * {@link module:engine/view/matcher~Matcher} pattern. Checks if a given element is a `<figcaption>` element that is placed\n\t * inside the image `<figure>` element.\n\t * @returns Returns the object accepted by {@link module:engine/view/matcher~Matcher} or `null` if the element\n\t * cannot be matched.\n\t */ matchImageCaptionViewElement(element) {\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        // Convert only captions for images.\n        if (element.name == 'figcaption' && imageUtils.isBlockImageView(element.parent)) {\n            return {\n                name: true\n            };\n        }\n        return null;\n    }\n}\n\n/**\n * The toggle image caption command.\n *\n * This command is registered by {@link module:image/imagecaption/imagecaptionediting~ImageCaptionEditing} as the\n * `'toggleImageCaption'` editor command.\n *\n * Executing this command:\n *\n * * either adds or removes the image caption of a selected image (depending on whether the caption is present or not),\n * * removes the image caption if the selection is anchored in one.\n *\n * ```ts\n * // Toggle the presence of the caption.\n * editor.execute( 'toggleImageCaption' );\n * ```\n *\n * **Note**: Upon executing this command, the selection will be set on the image if previously anchored in the caption element.\n *\n * **Note**: You can move the selection to the caption right away as it shows up upon executing this command by using\n * the `focusCaptionOnShow` option:\n *\n * ```ts\n * editor.execute( 'toggleImageCaption', { focusCaptionOnShow: true } );\n * ```\n */ class ToggleImageCaptionCommand extends Command {\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n        const imageUtils = editor.plugins.get('ImageUtils');\n        // Only block images can get captions.\n        if (!editor.plugins.has(ImageBlockEditing)) {\n            this.isEnabled = false;\n            this.value = false;\n            return;\n        }\n        const selection = editor.model.document.selection;\n        const selectedElement = selection.getSelectedElement();\n        if (!selectedElement) {\n            const ancestorCaptionElement = imageCaptionUtils.getCaptionFromModelSelection(selection);\n            this.isEnabled = !!ancestorCaptionElement;\n            this.value = !!ancestorCaptionElement;\n            return;\n        }\n        // Block images support captions by default but the command should also be enabled for inline\n        // images because toggling the caption when one is selected should convert it into a block image.\n        this.isEnabled = imageUtils.isImage(selectedElement);\n        if (!this.isEnabled) {\n            this.value = false;\n        } else {\n            this.value = !!imageCaptionUtils.getCaptionFromImageModelElement(selectedElement);\n        }\n    }\n    /**\n\t * Executes the command.\n\t *\n\t * ```ts\n\t * editor.execute( 'toggleImageCaption' );\n\t * ```\n\t *\n\t * @param options Options for the executed command.\n\t * @param options.focusCaptionOnShow When true and the caption shows up, the selection will be moved into it straight away.\n\t * @fires execute\n\t */ execute(options = {}) {\n        const { focusCaptionOnShow } = options;\n        this.editor.model.change((writer)=>{\n            if (this.value) {\n                this._hideImageCaption(writer);\n            } else {\n                this._showImageCaption(writer, focusCaptionOnShow);\n            }\n        });\n    }\n    /**\n\t * Shows the caption of the `<imageBlock>` or `<imageInline>`. Also:\n\t *\n\t * * it converts `<imageInline>` to `<imageBlock>` to show the caption,\n\t * * it attempts to restore the caption content from the `ImageCaptionEditing` caption registry,\n\t * * it moves the selection to the caption right away, it the `focusCaptionOnShow` option was set.\n\t */ _showImageCaption(writer, focusCaptionOnShow) {\n        const model = this.editor.model;\n        const selection = model.document.selection;\n        const imageCaptionEditing = this.editor.plugins.get('ImageCaptionEditing');\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        let selectedImage = selection.getSelectedElement();\n        const savedCaption = imageCaptionEditing._getSavedCaption(selectedImage);\n        // Convert imageInline -> image first.\n        if (imageUtils.isInlineImage(selectedImage)) {\n            this.editor.execute('imageTypeBlock');\n            // Executing the command created a new model element. Let's pick it again.\n            selectedImage = selection.getSelectedElement();\n        }\n        // Try restoring the caption from the ImageCaptionEditing plugin storage.\n        const newCaptionElement = savedCaption || writer.createElement('caption');\n        writer.append(newCaptionElement, selectedImage);\n        if (focusCaptionOnShow) {\n            writer.setSelection(newCaptionElement, 'in');\n        }\n    }\n    /**\n\t * Hides the caption of a selected image (or an image caption the selection is anchored to).\n\t *\n\t * The content of the caption is stored in the `ImageCaptionEditing` caption registry to make this\n\t * a reversible action.\n\t */ _hideImageCaption(writer) {\n        const editor = this.editor;\n        const selection = editor.model.document.selection;\n        const imageCaptionEditing = editor.plugins.get('ImageCaptionEditing');\n        const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n        let selectedImage = selection.getSelectedElement();\n        let captionElement;\n        if (selectedImage) {\n            captionElement = imageCaptionUtils.getCaptionFromImageModelElement(selectedImage);\n        } else {\n            captionElement = imageCaptionUtils.getCaptionFromModelSelection(selection);\n            selectedImage = captionElement.parent;\n        }\n        // Store the caption content so it can be restored quickly if the user changes their mind even if they toggle image<->imageInline.\n        imageCaptionEditing._saveCaption(selectedImage, captionElement);\n        writer.setSelection(selectedImage, 'on');\n        writer.remove(captionElement);\n    }\n}\n\n/**\n * The image caption engine plugin. It is responsible for:\n *\n * * registering converters for the caption element,\n * * registering converters for the caption model attribute,\n * * registering the {@link module:image/imagecaption/toggleimagecaptioncommand~ToggleImageCaptionCommand `toggleImageCaption`} command.\n */ class ImageCaptionEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils,\n            ImageCaptionUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageCaptionEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * A map that keeps saved JSONified image captions and image model elements they are\n\t * associated with.\n\t *\n\t * To learn more about this system, see {@link #_saveCaption}.\n\t */ _savedCaptionsMap;\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        this._savedCaptionsMap = new WeakMap();\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const schema = editor.model.schema;\n        // Schema configuration.\n        if (!schema.isRegistered('caption')) {\n            schema.register('caption', {\n                allowIn: 'imageBlock',\n                allowContentOf: '$block',\n                isLimit: true\n            });\n        } else {\n            schema.extend('caption', {\n                allowIn: 'imageBlock'\n            });\n        }\n        editor.commands.add('toggleImageCaption', new ToggleImageCaptionCommand(this.editor));\n        this._setupConversion();\n        this._setupImageTypeCommandsIntegration();\n        this._registerCaptionReconversion();\n    }\n    /**\n\t * Configures conversion pipelines to support upcasting and downcasting\n\t * image captions.\n\t */ _setupConversion() {\n        const editor = this.editor;\n        const view = editor.editing.view;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n        const t = editor.t;\n        // View -> model converter for the data pipeline.\n        editor.conversion.for('upcast').elementToElement({\n            view: (element)=>imageCaptionUtils.matchImageCaptionViewElement(element),\n            model: 'caption'\n        });\n        // Model -> view converter for the data pipeline.\n        editor.conversion.for('dataDowncast').elementToElement({\n            model: 'caption',\n            view: (modelElement, { writer })=>{\n                if (!imageUtils.isBlockImage(modelElement.parent)) {\n                    return null;\n                }\n                return writer.createContainerElement('figcaption');\n            }\n        });\n        // Model -> view converter for the editing pipeline.\n        editor.conversion.for('editingDowncast').elementToElement({\n            model: 'caption',\n            view: (modelElement, { writer })=>{\n                if (!imageUtils.isBlockImage(modelElement.parent)) {\n                    return null;\n                }\n                const figcaptionElement = writer.createEditableElement('figcaption');\n                writer.setCustomProperty('imageCaption', true, figcaptionElement);\n                figcaptionElement.placeholder = t('Enter image caption');\n                enableViewPlaceholder({\n                    view,\n                    element: figcaptionElement,\n                    keepOnFocus: true\n                });\n                const imageAlt = modelElement.parent.getAttribute('alt');\n                const label = imageAlt ? t('Caption for image: %0', [\n                    imageAlt\n                ]) : t('Caption for the image');\n                return toWidgetEditable(figcaptionElement, writer, {\n                    label\n                });\n            }\n        });\n    }\n    /**\n\t * Integrates with {@link module:image/image/imagetypecommand~ImageTypeCommand image type commands}\n\t * to make sure the caption is preserved when the type of an image changes so it can be restored\n\t * in the future if the user decides they want their caption back.\n\t */ _setupImageTypeCommandsIntegration() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n        const imageTypeInlineCommand = editor.commands.get('imageTypeInline');\n        const imageTypeBlockCommand = editor.commands.get('imageTypeBlock');\n        const handleImageTypeChange = (evt)=>{\n            // The image type command execution can be unsuccessful.\n            if (!evt.return) {\n                return;\n            }\n            const { oldElement, newElement } = evt.return;\n            /* istanbul ignore if: paranoid check -- @preserve */ if (!oldElement) {\n                return;\n            }\n            if (imageUtils.isBlockImage(oldElement)) {\n                const oldCaptionElement = imageCaptionUtils.getCaptionFromImageModelElement(oldElement);\n                // If the old element was a captioned block image (the caption was visible),\n                // simply save it so it can be restored.\n                if (oldCaptionElement) {\n                    this._saveCaption(newElement, oldCaptionElement);\n                    return;\n                }\n            }\n            const savedOldElementCaption = this._getSavedCaption(oldElement);\n            // If either:\n            //\n            // * the block image didn't have a visible caption,\n            // * the block image caption was hidden (and already saved),\n            // * the inline image was passed\n            //\n            // just try to \"pass\" the saved caption from the old image to the new image\n            // so it can be retrieved in the future if the user wants it back.\n            if (savedOldElementCaption) {\n                // Note: Since we're writing to a WeakMap, we don't bother with removing the\n                // [ oldElement, savedOldElementCaption ] pair from it.\n                this._saveCaption(newElement, savedOldElementCaption);\n            }\n        };\n        // Presence of the commands depends on the Image(Inline|Block)Editing plugins loaded in the editor.\n        if (imageTypeInlineCommand) {\n            this.listenTo(imageTypeInlineCommand, 'execute', handleImageTypeChange, {\n                priority: 'low'\n            });\n        }\n        if (imageTypeBlockCommand) {\n            this.listenTo(imageTypeBlockCommand, 'execute', handleImageTypeChange, {\n                priority: 'low'\n            });\n        }\n    }\n    /**\n\t * Returns the saved {@link module:engine/model/element~ModelElement#toJSON JSONified} caption\n\t * of an image model element.\n\t *\n\t * See {@link #_saveCaption}.\n\t *\n\t * @internal\n\t * @param imageModelElement The model element the caption should be returned for.\n\t * @returns The model caption element or `null` if there is none.\n\t */ _getSavedCaption(imageModelElement) {\n        const jsonObject = this._savedCaptionsMap.get(imageModelElement);\n        return jsonObject ? ModelElement.fromJSON(jsonObject) : null;\n    }\n    /**\n\t * Saves a {@link module:engine/model/element~ModelElement#toJSON JSONified} caption for\n\t * an image element to allow restoring it in the future.\n\t *\n\t * A caption is saved every time it gets hidden and/or the type of an image changes. The\n\t * user should be able to restore it on demand.\n\t *\n\t * **Note**: The caption cannot be stored in the image model element attribute because,\n\t * for instance, when the model state propagates to collaborators, the attribute would get\n\t * lost (mainly because it does not convert to anything when the caption is hidden) and\n\t * the states of collaborators' models would de-synchronize causing numerous issues.\n\t *\n\t * See {@link #_getSavedCaption}.\n\t *\n\t * @internal\n\t * @param imageModelElement The model element the caption is saved for.\n\t * @param caption The caption model element to be saved.\n\t */ _saveCaption(imageModelElement, caption) {\n        this._savedCaptionsMap.set(imageModelElement, caption.toJSON());\n    }\n    /**\n\t * Reconverts image caption when image alt attribute changes.\n\t * The change of alt attribute is reflected in caption's aria-label attribute.\n\t */ _registerCaptionReconversion() {\n        const editor = this.editor;\n        const model = editor.model;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n        model.document.on('change:data', ()=>{\n            const changes = model.document.differ.getChanges();\n            for (const change of changes){\n                if (change.attributeKey !== 'alt') {\n                    continue;\n                }\n                const image = change.range.start.nodeAfter;\n                if (imageUtils.isBlockImage(image)) {\n                    const caption = imageCaptionUtils.getCaptionFromImageModelElement(image);\n                    if (!caption) {\n                        return;\n                    }\n                    editor.editing.reconvertItem(caption);\n                }\n            }\n        });\n    }\n}\n\n/**\n * The image caption UI plugin. It introduces the `'toggleImageCaption'` UI button.\n */ class ImageCaptionUI extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageCaptionUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageCaptionUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const editingView = editor.editing.view;\n        const imageCaptionUtils = editor.plugins.get('ImageCaptionUtils');\n        const t = editor.t;\n        editor.ui.componentFactory.add('toggleImageCaption', (locale)=>{\n            const command = editor.commands.get('toggleImageCaption');\n            const view = new ButtonView(locale);\n            view.set({\n                icon: IconCaption,\n                tooltip: true,\n                isToggleable: true\n            });\n            view.bind('isOn', 'isEnabled').to(command, 'value', 'isEnabled');\n            view.bind('label').to(command, 'value', (value)=>value ? t('Toggle caption off') : t('Toggle caption on'));\n            this.listenTo(view, 'execute', ()=>{\n                editor.execute('toggleImageCaption', {\n                    focusCaptionOnShow: true\n                });\n                // Scroll to the selection and highlight the caption if the caption showed up.\n                const modelCaptionElement = imageCaptionUtils.getCaptionFromModelSelection(editor.model.document.selection);\n                if (modelCaptionElement) {\n                    const figcaptionElement = editor.editing.mapper.toViewElement(modelCaptionElement);\n                    editingView.scrollToTheSelection();\n                    editingView.change((writer)=>{\n                        writer.addClass('image__caption_highlighted', figcaptionElement);\n                    });\n                }\n                editor.editing.view.focus();\n            });\n            return view;\n        });\n    }\n}\n\n/**\n * The image caption plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-captions image caption} documentation.\n */ class ImageCaption extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageCaptionEditing,\n            ImageCaptionUI\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageCaption';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * Creates a regular expression used to test for image files.\n *\n * ```ts\n * const imageType = createImageTypeRegExp( [ 'png', 'jpeg', 'svg+xml', 'vnd.microsoft.icon' ] );\n *\n * console.log( 'is supported image', imageType.test( file.type ) );\n * ```\n */ function createImageTypeRegExp(types) {\n    // Sanitize the MIME type name which may include: \"+\", \"-\" or \".\".\n    const regExpSafeNames = types.map((type)=>type.replace('+', '\\\\+'));\n    return new RegExp(`^image\\\\/(${regExpSafeNames.join('|')})$`);\n}\n/**\n * Creates a promise that fetches the image local source (Base64 or blob) and resolves with a `File` object.\n *\n * @internal\n * @param image Image whose source to fetch.\n * @returns A promise which resolves when an image source is fetched and converted to a `File` instance.\n * It resolves with a `File` object. If there were any errors during file processing, the promise will be rejected.\n */ function fetchLocalImage(image) {\n    return new Promise((resolve, reject)=>{\n        const imageSrc = image.getAttribute('src');\n        // Fetch works asynchronously and so does not block browser UI when processing data.\n        fetch(imageSrc).then((resource)=>resource.blob()).then((blob)=>{\n            const mimeType = getImageMimeType(blob, imageSrc);\n            const ext = mimeType.replace('image/', '');\n            const filename = `image.${ext}`;\n            const file = new File([\n                blob\n            ], filename, {\n                type: mimeType\n            });\n            resolve(file);\n        }).catch((err)=>{\n            // Fetch fails only, if it can't make a request due to a network failure or if anything prevented the request\n            // from completing, i.e. the Content Security Policy rules. It is not possible to detect the exact cause of failure,\n            // so we are just trying the fallback solution, if general TypeError is thrown.\n            return err && err.name === 'TypeError' ? convertLocalImageOnCanvas(imageSrc).then(resolve).catch(reject) : reject(err);\n        });\n    });\n}\n/**\n * Checks whether a given node is an image element with a local source (Base64 or blob).\n *\n * @param node The node to check.\n * @internal\n */ function isLocalImage(imageUtils, node) {\n    if (!imageUtils.isInlineImageView(node) || !node.getAttribute('src')) {\n        return false;\n    }\n    return !!node.getAttribute('src').match(/^data:image\\/\\w+;base64,/g) || !!node.getAttribute('src').match(/^blob:/g);\n}\n/**\n * Extracts an image type based on its blob representation or its source.\n * @param blob Image blob representation.\n * @param src Image `src` attribute value.\n */ function getImageMimeType(blob, src) {\n    if (blob.type) {\n        return blob.type;\n    } else if (src.match(/data:(image\\/\\w+);base64/)) {\n        return src.match(/data:(image\\/\\w+);base64/)[1].toLowerCase();\n    } else {\n        // Fallback to 'jpeg' as common extension.\n        return 'image/jpeg';\n    }\n}\n/**\n * Creates a promise that converts the image local source (Base64 or blob) to a blob using canvas and resolves\n * with a `File` object.\n * @param imageSrc Image `src` attribute value.\n * @returns A promise which resolves when an image source is converted to a `File` instance.\n * It resolves with a `File` object. If there were any errors during file processing, the promise will be rejected.\n */ function convertLocalImageOnCanvas(imageSrc) {\n    return getBlobFromCanvas(imageSrc).then((blob)=>{\n        const mimeType = getImageMimeType(blob, imageSrc);\n        const ext = mimeType.replace('image/', '');\n        const filename = `image.${ext}`;\n        return new File([\n            blob\n        ], filename, {\n            type: mimeType\n        });\n    });\n}\n/**\n * Creates a promise that resolves with a `Blob` object converted from the image source (Base64 or blob).\n * @param imageSrc Image `src` attribute value.\n */ function getBlobFromCanvas(imageSrc) {\n    return new Promise((resolve, reject)=>{\n        const image = global.document.createElement('img');\n        image.addEventListener('load', ()=>{\n            const canvas = global.document.createElement('canvas');\n            canvas.width = image.width;\n            canvas.height = image.height;\n            const ctx = canvas.getContext('2d');\n            ctx.drawImage(image, 0, 0);\n            canvas.toBlob((blob)=>blob ? resolve(blob) : reject());\n        });\n        image.addEventListener('error', ()=>reject());\n        image.src = imageSrc;\n    });\n}\n\n/**\n * The image upload button plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature} documentation.\n *\n * Adds the `'uploadImage'` button to the {@link module:ui/componentfactory~ComponentFactory UI component factory}\n * and also the `imageUpload` button as an alias for backward compatibility.\n *\n * Adds the `'menuBar:uploadImage'` menu button to the {@link module:ui/componentfactory~ComponentFactory UI component factory}.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component, which are the default components\n * through which image upload is available.\n */ class ImageUploadUI extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageUploadUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        // Setup `uploadImage` button and add `imageUpload` button as an alias for backward compatibility.\n        editor.ui.componentFactory.add('uploadImage', ()=>this._createToolbarButton());\n        editor.ui.componentFactory.add('imageUpload', ()=>this._createToolbarButton());\n        editor.ui.componentFactory.add('menuBar:uploadImage', ()=>this._createMenuBarButton('standalone'));\n        if (editor.plugins.has('ImageInsertUI')) {\n            editor.plugins.get('ImageInsertUI').registerIntegration({\n                name: 'upload',\n                observable: ()=>editor.commands.get('uploadImage'),\n                buttonViewCreator: ()=>this._createToolbarButton(),\n                formViewCreator: ()=>this._createDropdownButton(),\n                menuBarButtonViewCreator: (isOnly)=>this._createMenuBarButton(isOnly ? 'insertOnly' : 'insertNested')\n            });\n        }\n    }\n    /**\n\t * Creates the base for various kinds of the button component provided by this feature.\n\t */ _createButton(ButtonClass) {\n        const editor = this.editor;\n        const locale = editor.locale;\n        const command = editor.commands.get('uploadImage');\n        const imageTypes = editor.config.get('image.upload.types');\n        const imageTypesRegExp = createImageTypeRegExp(imageTypes);\n        const view = new ButtonClass(editor.locale);\n        const t = locale.t;\n        view.set({\n            acceptedType: imageTypes.map((type)=>`image/${type}`).join(','),\n            allowMultipleFiles: true,\n            label: t('Upload from computer'),\n            icon: IconImageUpload\n        });\n        view.bind('isEnabled').to(command);\n        view.on('done', (evt, files)=>{\n            const imagesToUpload = Array.from(files).filter((file)=>imageTypesRegExp.test(file.type));\n            if (imagesToUpload.length) {\n                editor.execute('uploadImage', {\n                    file: imagesToUpload\n                });\n                editor.editing.view.focus();\n            }\n        });\n        return view;\n    }\n    /**\n\t * Creates a simple toolbar button, with an icon and a tooltip.\n\t */ _createToolbarButton() {\n        const t = this.editor.locale.t;\n        const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n        const uploadImageCommand = this.editor.commands.get('uploadImage');\n        const button = this._createButton(FileDialogButtonView);\n        button.tooltip = true;\n        button.bind('label').to(imageInsertUI, 'isImageSelected', uploadImageCommand, 'isAccessAllowed', (isImageSelected, isAccessAllowed)=>{\n            if (!isAccessAllowed) {\n                return t('You have no image upload permissions.');\n            }\n            return isImageSelected ? t('Replace image from computer') : t('Upload image from computer');\n        });\n        return button;\n    }\n    /**\n\t * Creates a button for the dropdown view, with an icon, text and no tooltip.\n\t */ _createDropdownButton() {\n        const t = this.editor.locale.t;\n        const imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n        const button = this._createButton(FileDialogButtonView);\n        button.withText = true;\n        button.bind('label').to(imageInsertUI, 'isImageSelected', (isImageSelected)=>isImageSelected ? t('Replace from computer') : t('Upload from computer'));\n        button.on('execute', ()=>{\n            imageInsertUI.dropdownView.isOpen = false;\n        });\n        return button;\n    }\n    /**\n\t * Creates a button for the menu bar.\n\t */ _createMenuBarButton(type) {\n        const t = this.editor.locale.t;\n        const button = this._createButton(MenuBarMenuListItemFileDialogButtonView);\n        button.withText = true;\n        switch(type){\n            case 'standalone':\n                button.label = t('Image from computer');\n                break;\n            case 'insertOnly':\n                button.label = t('Image');\n                break;\n            case 'insertNested':\n                button.label = t('From computer');\n                break;\n        }\n        return button;\n    }\n}\n\n/**\n * The image upload progress plugin.\n * It shows a placeholder when the image is read from the disk and a progress bar while the image is uploading.\n */ class ImageUploadProgress extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageUploadProgress';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * The image placeholder that is displayed before real image data can be accessed.\n\t *\n\t * For the record, this image is a 1x1 px GIF with an aspect ratio set by CSS.\n\t */ placeholder;\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        this.placeholder = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        // Upload status change - update image's view according to that status.\n        if (editor.plugins.has('ImageBlockEditing')) {\n            editor.editing.downcastDispatcher.on('attribute:uploadStatus:imageBlock', this.uploadStatusChange);\n        }\n        if (editor.plugins.has('ImageInlineEditing')) {\n            editor.editing.downcastDispatcher.on('attribute:uploadStatus:imageInline', this.uploadStatusChange);\n        }\n    }\n    /**\n\t * This method is called each time the image `uploadStatus` attribute is changed.\n\t *\n\t * @param evt An object containing information about the fired event.\n\t * @param data Additional information about the change.\n\t */ uploadStatusChange = (evt, data, conversionApi)=>{\n        const editor = this.editor;\n        const modelImage = data.item;\n        const uploadId = modelImage.getAttribute('uploadId');\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n            return;\n        }\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const fileRepository = editor.plugins.get(FileRepository);\n        const status = uploadId ? data.attributeNewValue : null;\n        const placeholder = this.placeholder;\n        const viewFigure = editor.editing.mapper.toViewElement(modelImage);\n        const viewWriter = conversionApi.writer;\n        if (status == 'reading') {\n            // Start \"appearing\" effect and show placeholder with infinite progress bar on the top\n            // while image is read from disk.\n            _startAppearEffect(viewFigure, viewWriter);\n            _showPlaceholder(imageUtils, placeholder, viewFigure, viewWriter);\n            return;\n        }\n        // Show progress bar on the top of the image when image is uploading.\n        if (status == 'uploading') {\n            const loader = fileRepository.loaders.get(uploadId);\n            // Start appear effect if needed - see https://github.com/ckeditor/ckeditor5-image/issues/191.\n            _startAppearEffect(viewFigure, viewWriter);\n            if (!loader) {\n                // There is no loader associated with uploadId - this means that image came from external changes.\n                // In such cases we still want to show the placeholder until image is fully uploaded.\n                // Show placeholder if needed - see https://github.com/ckeditor/ckeditor5-image/issues/191.\n                _showPlaceholder(imageUtils, placeholder, viewFigure, viewWriter);\n            } else {\n                // Hide placeholder and initialize progress bar showing upload progress.\n                _hidePlaceholder(viewFigure, viewWriter);\n                _showProgressBar(viewFigure, viewWriter, loader, editor.editing.view);\n                _displayLocalImage(imageUtils, viewFigure, viewWriter, loader);\n            }\n            return;\n        }\n        if (status == 'complete' && fileRepository.loaders.get(uploadId)) {\n            _showCompleteIcon(viewFigure, viewWriter, editor.editing.view);\n        }\n        // Clean up.\n        _hideProgressBar(viewFigure, viewWriter);\n        _hidePlaceholder(viewFigure, viewWriter);\n        _stopAppearEffect(viewFigure, viewWriter);\n    };\n}\n/**\n * Adds ck-appear class to the image figure if one is not already applied.\n */ function _startAppearEffect(viewFigure, writer) {\n    if (!viewFigure.hasClass('ck-appear')) {\n        writer.addClass('ck-appear', viewFigure);\n    }\n}\n/**\n * Removes ck-appear class to the image figure if one is not already removed.\n */ function _stopAppearEffect(viewFigure, writer) {\n    writer.removeClass('ck-appear', viewFigure);\n}\n/**\n * Shows placeholder together with infinite progress bar on given image figure.\n */ function _showPlaceholder(imageUtils, placeholder, viewFigure, writer) {\n    if (!viewFigure.hasClass('ck-image-upload-placeholder')) {\n        writer.addClass('ck-image-upload-placeholder', viewFigure);\n    }\n    const viewImg = imageUtils.findViewImgElement(viewFigure);\n    if (viewImg.getAttribute('src') !== placeholder) {\n        writer.setAttribute('src', placeholder, viewImg);\n    }\n    if (!_getUIElement(viewFigure, 'placeholder')) {\n        writer.insert(writer.createPositionAfter(viewImg), _createPlaceholder(writer));\n    }\n}\n/**\n * Removes placeholder together with infinite progress bar on given image figure.\n */ function _hidePlaceholder(viewFigure, writer) {\n    if (viewFigure.hasClass('ck-image-upload-placeholder')) {\n        writer.removeClass('ck-image-upload-placeholder', viewFigure);\n    }\n    _removeUIElement(viewFigure, writer, 'placeholder');\n}\n/**\n * Shows progress bar displaying upload progress.\n * Attaches it to the file loader to update when upload percentace is changed.\n */ function _showProgressBar(viewFigure, writer, loader, view) {\n    const progressBar = _createProgressBar(writer);\n    writer.insert(writer.createPositionAt(viewFigure, 'end'), progressBar);\n    // Update progress bar width when uploadedPercent is changed.\n    loader.on('change:uploadedPercent', (evt, name, value)=>{\n        view.change((writer)=>{\n            writer.setStyle('width', value + '%', progressBar);\n        });\n    });\n}\n/**\n * Hides upload progress bar.\n */ function _hideProgressBar(viewFigure, writer) {\n    _removeUIElement(viewFigure, writer, 'progressBar');\n}\n/**\n * Shows complete icon and hides after a certain amount of time.\n */ function _showCompleteIcon(viewFigure, writer, view) {\n    const completeIcon = writer.createUIElement('div', {\n        class: 'ck-image-upload-complete-icon'\n    });\n    writer.insert(writer.createPositionAt(viewFigure, 'end'), completeIcon);\n    setTimeout(()=>{\n        view.change((writer)=>writer.remove(writer.createRangeOn(completeIcon)));\n    }, 3000);\n}\n/**\n * Create progress bar element using {@link module:engine/view/uielement~ViewUIElement}.\n */ function _createProgressBar(writer) {\n    const progressBar = writer.createUIElement('div', {\n        class: 'ck-progress-bar'\n    });\n    writer.setCustomProperty('progressBar', true, progressBar);\n    return progressBar;\n}\n/**\n * Create placeholder element using {@link module:engine/view/uielement~ViewUIElement}.\n */ function _createPlaceholder(writer) {\n    const placeholder = writer.createUIElement('div', {\n        class: 'ck-upload-placeholder-loader'\n    });\n    writer.setCustomProperty('placeholder', true, placeholder);\n    return placeholder;\n}\n/**\n * Returns {@link module:engine/view/uielement~ViewUIElement} of given unique property from image figure element.\n * Returns `undefined` if element is not found.\n */ function _getUIElement(imageFigure, uniqueProperty) {\n    for (const child of imageFigure.getChildren()){\n        if (child.getCustomProperty(uniqueProperty)) {\n            return child;\n        }\n    }\n}\n/**\n * Removes {@link module:engine/view/uielement~ViewUIElement} of given unique property from image figure element.\n */ function _removeUIElement(viewFigure, writer, uniqueProperty) {\n    const element = _getUIElement(viewFigure, uniqueProperty);\n    if (element) {\n        writer.remove(writer.createRangeOn(element));\n    }\n}\n/**\n * Displays local data from file loader.\n */ function _displayLocalImage(imageUtils, viewFigure, writer, loader) {\n    if (loader.data) {\n        const viewImg = imageUtils.findViewImgElement(viewFigure);\n        writer.setAttribute('src', loader.data, viewImg);\n    }\n}\n\n/**\n * @module image/imageupload/uploadimagecommand\n */ /**\n * The upload image command.\n *\n * The command is registered by the {@link module:image/imageupload/imageuploadediting~ImageUploadEditing} plugin as `uploadImage`\n * and it is also available via aliased `imageUpload` name.\n *\n * In order to upload an image at the current selection position\n * (according to the {@link module:widget/utils~findOptimalInsertionRange} algorithm),\n * execute the command and pass the native image file instance:\n *\n * ```ts\n * this.listenTo( editor.editing.view.document, 'clipboardInput', ( evt, data ) => {\n * \t// Assuming that only images were pasted:\n * \tconst images = Array.from( data.dataTransfer.files );\n *\n * \t// Upload the first image:\n * \teditor.execute( 'uploadImage', { file: images[ 0 ] } );\n * } );\n * ```\n *\n * It is also possible to insert multiple images at once:\n *\n * ```ts\n * editor.execute( 'uploadImage', {\n * \tfile: [\n * \t\tfile1,\n * \t\tfile2\n * \t]\n * } );\n * ```\n */ class UploadImageCommand extends Command {\n    /**\n\t * Creates an instance of the `imageUlpoad` command. When executed, the command upload one of\n\t * the currently selected image from computer.\n\t *\n\t * @param editor The editor instance.\n\t */ constructor(editor){\n        super(editor);\n        this.set('isAccessAllowed', true);\n    }\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const selectedElement = editor.model.document.selection.getSelectedElement();\n        // TODO: This needs refactoring.\n        this.isEnabled = imageUtils.isImageAllowed() || imageUtils.isImage(selectedElement);\n    }\n    /**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options Options for the executed command.\n\t * @param options.file The image file or an array of image files to upload.\n\t */ execute(options) {\n        const files = toArray(options.file);\n        const selection = this.editor.model.document.selection;\n        const imageUtils = this.editor.plugins.get('ImageUtils');\n        // In case of multiple files, each file (starting from the 2nd) will be inserted at a position that\n        // follows the previous one. That will move the selection and, to stay on the safe side and make sure\n        // all images inherit the same selection attributes, they are collected beforehand.\n        //\n        // Applying these attributes ensures, for instance, that inserting an (inline) image into a link does\n        // not split that link but preserves its continuity.\n        //\n        // Note: Selection attributes that do not make sense for images will be filtered out by insertImage() anyway.\n        const selectionAttributes = Object.fromEntries(selection.getAttributes());\n        files.forEach((file, index)=>{\n            const selectedElement = selection.getSelectedElement();\n            // Inserting of an inline image replace the selected element and make a selection on the inserted image.\n            // Therefore inserting multiple inline images requires creating position after each element.\n            if (index && selectedElement && imageUtils.isImage(selectedElement)) {\n                const position = this.editor.model.createPositionAfter(selectedElement);\n                this._uploadImage(file, selectionAttributes, position);\n            } else {\n                this._uploadImage(file, selectionAttributes);\n            }\n        });\n    }\n    /**\n\t * Handles uploading single file.\n\t */ _uploadImage(file, attributes, position) {\n        const editor = this.editor;\n        const fileRepository = editor.plugins.get(FileRepository);\n        const loader = fileRepository.createLoader(file);\n        const imageUtils = editor.plugins.get('ImageUtils');\n        // Do not throw when upload adapter is not set. FileRepository will log an error anyway.\n        if (!loader) {\n            return;\n        }\n        imageUtils.insertImage({\n            ...attributes,\n            uploadId: loader.id\n        }, position);\n    }\n}\n\n/**\n * The editing part of the image upload feature. It registers the `'uploadImage'` command\n * and the `imageUpload` command as an aliased name.\n *\n * When an image is uploaded, it fires the {@link ~ImageUploadEditing#event:uploadComplete `uploadComplete`} event\n * that allows adding custom attributes to the {@link module:engine/model/element~ModelElement image element}.\n */ class ImageUploadEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            FileRepository,\n            Notification,\n            ClipboardPipeline,\n            ImageUtils\n        ];\n    }\n    static get pluginName() {\n        return 'ImageUploadEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * An internal mapping of {@link module:upload/filerepository~FileLoader#id file loader UIDs} and\n\t * model elements during the upload.\n\t *\n\t * Model element of the uploaded image can change, for instance, when {@link module:image/image/imagetypecommand~ImageTypeCommand}\n\t * is executed as a result of adding caption or changing image style. As a result, the upload logic must keep track of the model\n\t * element (reference) and resolve the upload for the correct model element (instead of the one that landed in the `$graveyard`\n\t * after image type changed).\n\t */ _uploadImageElements;\n    /**\n\t * An internal mapping of {@link module:upload/filerepository~FileLoader#id file loader UIDs} and\n\t * upload responses for handling images dragged during their upload process. When such images are later\n\t * dropped, their original upload IDs no longer exist in the registry (as the original upload completed).\n\t * This map preserves the upload responses to properly handle such cases.\n\t */ _uploadedImages = new Map();\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        editor.config.define('image', {\n            upload: {\n                types: [\n                    'jpeg',\n                    'png',\n                    'gif',\n                    'bmp',\n                    'webp',\n                    'tiff'\n                ]\n            }\n        });\n        this._uploadImageElements = new Map();\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const doc = editor.model.document;\n        const conversion = editor.conversion;\n        const fileRepository = editor.plugins.get(FileRepository);\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const clipboardPipeline = editor.plugins.get('ClipboardPipeline');\n        const imageTypes = createImageTypeRegExp(editor.config.get('image.upload.types'));\n        const uploadImageCommand = new UploadImageCommand(editor);\n        // Register `uploadImage` command and add `imageUpload` command as an alias for backward compatibility.\n        editor.commands.add('uploadImage', uploadImageCommand);\n        editor.commands.add('imageUpload', uploadImageCommand);\n        // Register upcast converter for uploadId.\n        conversion.for('upcast').attributeToAttribute({\n            view: {\n                name: 'img',\n                key: 'uploadId'\n            },\n            model: 'uploadId'\n        })// Handle the case when the image is not fully uploaded yet but it's being moved.\n        // See more: https://github.com/ckeditor/ckeditor5/pull/17327\n        .add((dispatcher)=>dispatcher.on('element:img', (evt, data, conversionApi)=>{\n                if (!conversionApi.consumable.test(data.viewItem, {\n                    attributes: [\n                        'data-ck-upload-id'\n                    ]\n                })) {\n                    return;\n                }\n                const uploadId = data.viewItem.getAttribute('data-ck-upload-id');\n                if (!uploadId) {\n                    return;\n                }\n                const [modelElement] = Array.from(data.modelRange.getItems({\n                    shallow: true\n                }));\n                const loader = fileRepository.loaders.get(uploadId);\n                if (modelElement) {\n                    // Handle case when `uploadId` is set on the image element but the loader is not present in the registry.\n                    // It may happen when the image was successfully uploaded and the loader was removed from the registry.\n                    // It's still present in the `_uploadedImages` map though. It's why we do not place this line in the condition below.\n                    conversionApi.writer.setAttribute('uploadId', uploadId, modelElement);\n                    conversionApi.consumable.consume(data.viewItem, {\n                        attributes: [\n                            'data-ck-upload-id'\n                        ]\n                    });\n                    if (loader && loader.data) {\n                        conversionApi.writer.setAttribute('uploadStatus', loader.status, modelElement);\n                    }\n                }\n            }, {\n                priority: 'low'\n            }));\n        // Handle pasted images.\n        // For every image file, a new file loader is created and a placeholder image is\n        // inserted into the content. Then, those images are uploaded once they appear in the model\n        // (see Document#change listener below).\n        this.listenTo(editor.editing.view.document, 'clipboardInput', (evt, data)=>{\n            // Skip if non empty HTML data is included.\n            // https://github.com/ckeditor/ckeditor5-upload/issues/68\n            if (isHtmlInDataTransfer(data.dataTransfer)) {\n                return;\n            }\n            const images = Array.from(data.dataTransfer.files).filter((file)=>{\n                // See https://github.com/ckeditor/ckeditor5-image/pull/254.\n                if (!file) {\n                    return false;\n                }\n                return imageTypes.test(file.type);\n            });\n            if (!images.length) {\n                return;\n            }\n            evt.stop();\n            editor.model.change((writer)=>{\n                // Set selection to paste target.\n                if (data.targetRanges) {\n                    writer.setSelection(data.targetRanges.map((viewRange)=>editor.editing.mapper.toModelRange(viewRange)));\n                }\n                editor.execute('uploadImage', {\n                    file: images\n                });\n            });\n            const uploadImageCommand = editor.commands.get('uploadImage');\n            if (!uploadImageCommand.isAccessAllowed) {\n                const notification = editor.plugins.get('Notification');\n                const t = editor.locale.t;\n                notification.showWarning(t('You have no image upload permissions.'), {\n                    namespace: 'image'\n                });\n            }\n        });\n        // Handle HTML pasted with images with base64 or blob sources.\n        // For every image file, a new file loader is created and a placeholder image is\n        // inserted into the content. Then, those images are uploaded once they appear in the model\n        // (see Document#change listener below).\n        this.listenTo(clipboardPipeline, 'inputTransformation', (evt, data)=>{\n            const fetchableImages = Array.from(editor.editing.view.createRangeIn(data.content)).map((value)=>value.item).filter((viewElement)=>isLocalImage(imageUtils, viewElement) && !viewElement.getAttribute('uploadProcessed')).map((viewElement)=>{\n                return {\n                    promise: fetchLocalImage(viewElement),\n                    imageElement: viewElement\n                };\n            });\n            if (!fetchableImages.length) {\n                return;\n            }\n            const writer = new ViewUpcastWriter(editor.editing.view.document);\n            for (const fetchableImage of fetchableImages){\n                // Set attribute marking that the image was processed already.\n                writer.setAttribute('uploadProcessed', true, fetchableImage.imageElement);\n                const loader = fileRepository.createLoader(fetchableImage.promise);\n                if (loader) {\n                    writer.setAttribute('src', '', fetchableImage.imageElement);\n                    writer.setAttribute('uploadId', loader.id, fetchableImage.imageElement);\n                }\n            }\n        });\n        // Prevents from the browser redirecting to the dropped image.\n        editor.editing.view.document.on('dragover', (evt, data)=>{\n            data.preventDefault();\n        });\n        // Upload placeholder images that appeared in the model.\n        doc.on('change', ()=>{\n            // Note: Reversing changes to start with insertions and only then handle removals. If it was the other way around,\n            // loaders for **all** images that land in the $graveyard would abort while in fact only those that were **not** replaced\n            // by other images should be aborted.\n            const changes = doc.differ.getChanges({\n                includeChangesInGraveyard: true\n            }).reverse();\n            const insertedImagesIds = new Set();\n            for (const entry of changes){\n                if (entry.type == 'insert' && entry.name != '$text') {\n                    const item = entry.position.nodeAfter;\n                    const isInsertedInGraveyard = entry.position.root.rootName == '$graveyard';\n                    for (const imageElement of getImagesFromChangeItem(editor, item)){\n                        // Check if the image element still has upload id.\n                        const uploadId = imageElement.getAttribute('uploadId');\n                        if (!uploadId) {\n                            continue;\n                        }\n                        // Check if the image is loaded on this client.\n                        const loader = fileRepository.loaders.get(uploadId);\n                        if (!loader) {\n                            // If the loader does not exist, it means that the image was already uploaded\n                            // and the loader promise was removed from the registry. In that scenario we need\n                            // to restore response object from the internal map.\n                            if (!isInsertedInGraveyard && this._uploadedImages.has(uploadId)) {\n                                // Fire `uploadComplete` to set proper attributes on the image element.\n                                editor.model.enqueueChange({\n                                    isUndoable: false\n                                }, (writer)=>{\n                                    writer.setAttribute('uploadStatus', 'complete', imageElement);\n                                    this.fire('uploadComplete', {\n                                        data: this._uploadedImages.get(uploadId),\n                                        imageElement: imageElement\n                                    });\n                                });\n                            // While it makes sense to remove the image from the `_uploadedImages` map here,\n                            // it's counterintuitive for the user that pastes image in uploading several times.\n                            // It'll work the first time, but the next time the image will be empty because the\n                            // `_uploadedImages` no longer contain the response.\n                            }\n                            continue;\n                        }\n                        if (isInsertedInGraveyard) {\n                            // If the image was inserted to the graveyard for good (**not** replaced by another image),\n                            // only then abort the loading process.\n                            if (!insertedImagesIds.has(uploadId)) {\n                                // ... but abort it only if all remain images that share the same loader are in the graveyard too.\n                                // This is to prevent situation when we have two images in uploading state and one of them is being\n                                // placed in the graveyard (e.g. using undo). The other one should not be aborted.\n                                const allImagesThatShareUploaderInGraveyard = Array.from(this._uploadImageElements.get(uploadId)).every((element)=>element.root.rootName == '$graveyard');\n                                if (allImagesThatShareUploaderInGraveyard) {\n                                    loader.abort();\n                                }\n                            }\n                        } else {\n                            // Remember the upload id of the inserted image. If it acted as a replacement for another\n                            // image (which landed in the $graveyard), the related loader will not be aborted because\n                            // this is still the same image upload.\n                            insertedImagesIds.add(uploadId);\n                            // Keep the mapping between the upload ID and the image model element so the upload\n                            // can later resolve in the context of the correct model element. The model element could\n                            // change for the same upload if one image was replaced by another (e.g. image type was changed),\n                            // so this may also replace an existing mapping.\n                            if (!this._uploadImageElements.has(uploadId)) {\n                                this._uploadImageElements.set(uploadId, new Set([\n                                    imageElement\n                                ]));\n                            } else {\n                                this._uploadImageElements.get(uploadId).add(imageElement);\n                            }\n                            if (loader.status == 'idle') {\n                                // If the image was inserted into content and has not been loaded yet, start loading it.\n                                this._readAndUpload(loader);\n                            }\n                        }\n                    }\n                }\n            }\n        });\n        // Set the default handler for feeding the image element with `src` and `srcset` attributes.\n        // Also set the natural `width` and `height` attributes (if not already set).\n        this.on('uploadComplete', (evt, { imageElement, data })=>{\n            const urls = data.urls ? data.urls : data;\n            this.editor.model.change((writer)=>{\n                writer.setAttribute('src', urls.default, imageElement);\n                this._parseAndSetSrcsetAttributeOnImage(urls, imageElement, writer);\n                imageUtils.setImageNaturalSizeAttributes(imageElement);\n            });\n        }, {\n            priority: 'low'\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        const schema = this.editor.model.schema;\n        // Setup schema to allow uploadId and uploadStatus for images.\n        // Wait for ImageBlockEditing or ImageInlineEditing to register their elements first,\n        // that's why doing this in afterInit() instead of init().\n        if (this.editor.plugins.has('ImageBlockEditing')) {\n            schema.extend('imageBlock', {\n                allowAttributes: [\n                    'uploadId',\n                    'uploadStatus'\n                ]\n            });\n            this._registerConverters('imageBlock');\n        }\n        if (this.editor.plugins.has('ImageInlineEditing')) {\n            schema.extend('imageInline', {\n                allowAttributes: [\n                    'uploadId',\n                    'uploadStatus'\n                ]\n            });\n            this._registerConverters('imageInline');\n        }\n    }\n    /**\n\t * Reads and uploads an image.\n\t *\n\t * The image is read from the disk and as a Base64-encoded string it is set temporarily to\n\t * `image[src]`. When the image is successfully uploaded, the temporary data is replaced with the target\n\t * image's URL (the URL to the uploaded image on the server).\n\t */ _readAndUpload(loader) {\n        const editor = this.editor;\n        const model = editor.model;\n        const t = editor.locale.t;\n        const fileRepository = editor.plugins.get(FileRepository);\n        const notification = editor.plugins.get(Notification);\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const imageUploadElements = this._uploadImageElements;\n        model.enqueueChange({\n            isUndoable: false\n        }, (writer)=>{\n            const elements = imageUploadElements.get(loader.id);\n            for (const element of elements){\n                writer.setAttribute('uploadStatus', 'reading', element);\n            }\n        });\n        return loader.read().then(()=>{\n            const promise = loader.upload();\n            if (editor.ui) {\n                editor.ui.ariaLiveAnnouncer.announce(t('Uploading image'));\n            }\n            for (const imageElement of imageUploadElements.get(loader.id)){\n                // Force re–paint in Safari. Without it, the image will display with a wrong size.\n                // https://github.com/ckeditor/ckeditor5/issues/1975\n                /* istanbul ignore next -- @preserve */ if (env.isSafari) {\n                    const viewFigure = editor.editing.mapper.toViewElement(imageElement);\n                    const viewImg = imageUtils.findViewImgElement(viewFigure);\n                    editor.editing.view.once('render', ()=>{\n                        // Early returns just to be safe. There might be some code ran\n                        // in between the outer scope and this callback.\n                        if (!viewImg.parent) {\n                            return;\n                        }\n                        const domFigure = editor.editing.view.domConverter.mapViewToDom(viewImg.parent);\n                        if (!domFigure) {\n                            return;\n                        }\n                        const originalDisplay = domFigure.style.display;\n                        domFigure.style.display = 'none';\n                        // Make sure this line will never be removed during minification for having \"no effect\".\n                        domFigure._ckHack = domFigure.offsetHeight;\n                        domFigure.style.display = originalDisplay;\n                    });\n                }\n                model.enqueueChange({\n                    isUndoable: false\n                }, (writer)=>{\n                    writer.setAttribute('uploadStatus', 'uploading', imageElement);\n                });\n            }\n            return promise;\n        }).then((data)=>{\n            model.enqueueChange({\n                isUndoable: false\n            }, (writer)=>{\n                for (const imageElement of imageUploadElements.get(loader.id)){\n                    writer.setAttribute('uploadStatus', 'complete', imageElement);\n                    this.fire('uploadComplete', {\n                        data,\n                        imageElement\n                    });\n                }\n                if (editor.ui) {\n                    editor.ui.ariaLiveAnnouncer.announce(t('Image upload complete'));\n                }\n                this._uploadedImages.set(loader.id, data);\n            });\n            clean();\n        }).catch((error)=>{\n            if (editor.ui) {\n                editor.ui.ariaLiveAnnouncer.announce(t('Error during image upload'));\n            }\n            // If status is not 'error' nor 'aborted' - throw error because it means that something else went wrong,\n            // it might be generic error and it would be real pain to find what is going on.\n            if (loader.status !== 'error' && loader.status !== 'aborted') {\n                throw error;\n            }\n            // Might be 'aborted'.\n            if (loader.status == 'error' && error) {\n                notification.showWarning(error, {\n                    title: t('Upload failed'),\n                    namespace: 'upload'\n                });\n            }\n            // Permanently remove image from insertion batch.\n            model.enqueueChange({\n                isUndoable: false\n            }, (writer)=>{\n                for (const imageElement of imageUploadElements.get(loader.id)){\n                    // Handle situation when the image has been removed and then `abort` exception was thrown.\n                    // See: https://github.com/ckeditor/ckeditor5-commercial/issues/6817\n                    if (imageElement.root.rootName !== '$graveyard') {\n                        writer.remove(imageElement);\n                    }\n                }\n            });\n            clean();\n        });\n        function clean() {\n            model.enqueueChange({\n                isUndoable: false\n            }, (writer)=>{\n                for (const imageElement of imageUploadElements.get(loader.id)){\n                    writer.removeAttribute('uploadId', imageElement);\n                    writer.removeAttribute('uploadStatus', imageElement);\n                }\n                imageUploadElements.delete(loader.id);\n            });\n            fileRepository.destroyLoader(loader);\n        }\n    }\n    /**\n\t * Creates the `srcset` attribute based on a given file upload response and sets it as an attribute to a specific image element.\n\t *\n\t * @param data Data object from which `srcset` will be created.\n\t * @param image The image element on which the `srcset` attribute will be set.\n\t */ _parseAndSetSrcsetAttributeOnImage(data, image, writer) {\n        // Srcset attribute for responsive images support.\n        let maxWidth = 0;\n        const srcsetAttribute = Object.keys(data)// Filter out keys that are not integers.\n        .filter((key)=>{\n            const width = parseInt(key, 10);\n            if (!isNaN(width)) {\n                maxWidth = Math.max(maxWidth, width);\n                return true;\n            }\n        })// Convert each key to srcset entry.\n        .map((key)=>`${data[key]} ${key}w`)// Join all entries.\n        .join(', ');\n        if (srcsetAttribute != '') {\n            const attributes = {\n                srcset: srcsetAttribute\n            };\n            if (!image.hasAttribute('width') && !image.hasAttribute('height')) {\n                attributes.width = maxWidth;\n            }\n            writer.setAttributes(attributes, image);\n        }\n    }\n    /**\n\t * Registers image upload converters.\n\t *\n\t * @param imageType The type of the image.\n\t */ _registerConverters(imageType) {\n        const { conversion, plugins } = this.editor;\n        const fileRepository = plugins.get(FileRepository);\n        const imageUtils = plugins.get(ImageUtils);\n        // It sets `data-ck-upload-id` attribute on the view image elements that are not fully uploaded.\n        // It avoids the situation when image disappears when it's being moved and upload is not finished yet.\n        // See more: https://github.com/ckeditor/ckeditor5/issues/16967\n        conversion.for('dataDowncast').add((dispatcher)=>{\n            dispatcher.on(`attribute:uploadId:${imageType}`, (evt, data, conversionApi)=>{\n                if (!conversionApi.consumable.test(data.item, evt.name)) {\n                    return;\n                }\n                const loader = fileRepository.loaders.get(data.attributeNewValue);\n                if (!loader || !loader.data) {\n                    return null;\n                }\n                const viewElement = conversionApi.mapper.toViewElement(data.item);\n                const img = imageUtils.findViewImgElement(viewElement);\n                if (img) {\n                    conversionApi.consumable.consume(data.item, evt.name);\n                    conversionApi.writer.setAttribute('data-ck-upload-id', loader.id, img);\n                }\n            });\n        });\n    }\n}\n/**\n * TODO move this to the clipboard package.\n *\n * Returns `true` if non-empty `text/html` is included in the data transfer.\n */ function isHtmlInDataTransfer(dataTransfer) {\n    return Array.from(dataTransfer.types).includes('text/html') && dataTransfer.getData('text/html') !== '';\n}\nfunction getImagesFromChangeItem(editor, item) {\n    const imageUtils = editor.plugins.get('ImageUtils');\n    return Array.from(editor.model.createRangeOn(item)).filter((value)=>imageUtils.isImage(value.item)).map((value)=>value.item);\n}\n\n/**\n * The image upload plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload image upload feature} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins to enable image uploading:\n *\n * * {@link module:image/imageupload/imageuploadediting~ImageUploadEditing},\n * * {@link module:image/imageupload/imageuploadui~ImageUploadUI},\n * * {@link module:image/imageupload/imageuploadprogress~ImageUploadProgress}.\n */ class ImageUpload extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageUpload';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUploadEditing,\n            ImageUploadUI,\n            ImageUploadProgress\n        ];\n    }\n}\n\n/**\n * The insert an image via URL view.\n *\n * See {@link module:image/imageinsert/imageinsertviaurlui~ImageInsertViaUrlUI}.\n *\n * @internal\n */ class ImageInsertUrlView extends View {\n    /**\n\t * The URL input field view.\n\t */ urlInputView;\n    /**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */ keystrokes;\n    /**\n\t * Creates a view for the dropdown panel of {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n\t *\n\t * @param locale The localization services instance.\n\t */ constructor(locale){\n        super(locale);\n        this.set('imageURLInputValue', '');\n        this.set('isImageSelected', false);\n        this.set('isEnabled', true);\n        this.keystrokes = new KeystrokeHandler();\n        this.urlInputView = this._createUrlInputView();\n        this.setTemplate({\n            tag: 'form',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-image-insert-url'\n                ],\n                tabindex: '-1'\n            },\n            children: [\n                this.urlInputView,\n                {\n                    tag: 'div',\n                    attributes: {\n                        class: [\n                            'ck',\n                            'ck-image-insert-url__action-row'\n                        ]\n                    }\n                }\n            ]\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ render() {\n        super.render();\n        submitHandler({\n            view: this\n        });\n        // Start listening for the keystrokes coming from #element.\n        this.keystrokes.listenTo(this.element);\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        super.destroy();\n        this.keystrokes.destroy();\n    }\n    /**\n\t * Creates the {@link #urlInputView}.\n\t */ _createUrlInputView() {\n        const locale = this.locale;\n        const t = locale.t;\n        const urlInputView = new LabeledFieldView(locale, createLabeledInputText);\n        urlInputView.bind('label').to(this, 'isImageSelected', (value)=>value ? t('Update image URL') : t('Insert image via URL'));\n        urlInputView.bind('isEnabled').to(this);\n        urlInputView.fieldView.inputMode = 'url';\n        urlInputView.fieldView.placeholder = 'https://example.com/image.png';\n        urlInputView.fieldView.bind('value').to(this, 'imageURLInputValue', (value)=>value || '');\n        urlInputView.fieldView.on('input', ()=>{\n            this.imageURLInputValue = urlInputView.fieldView.element.value.trim();\n        });\n        return urlInputView;\n    }\n    /**\n\t * Focuses the view.\n\t */ focus() {\n        this.urlInputView.focus();\n    }\n}\n\n/**\n * The image insert via URL plugin (UI part).\n *\n * The plugin introduces two UI components to the {@link module:ui/componentfactory~ComponentFactory UI component factory}:\n *\n * * the `'insertImageViaUrl'` toolbar button,\n * * the `'menuBar:insertImageViaUrl'` menu bar component.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component, which are default components\n * through which inserting image via URL is available.\n */ class ImageInsertViaUrlUI extends Plugin {\n    _imageInsertUI;\n    _formView;\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageInsertViaUrlUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageInsertUI,\n            Dialog\n        ];\n    }\n    init() {\n        this.editor.ui.componentFactory.add('insertImageViaUrl', ()=>this._createToolbarButton());\n        this.editor.ui.componentFactory.add('menuBar:insertImageViaUrl', ()=>this._createMenuBarButton('standalone'));\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        this._imageInsertUI = this.editor.plugins.get('ImageInsertUI');\n        this._imageInsertUI.registerIntegration({\n            name: 'url',\n            observable: ()=>this.editor.commands.get('insertImage'),\n            buttonViewCreator: ()=>this._createToolbarButton(),\n            formViewCreator: ()=>this._createDropdownButton(),\n            menuBarButtonViewCreator: (isOnly)=>this._createMenuBarButton(isOnly ? 'insertOnly' : 'insertNested')\n        });\n    }\n    /**\n\t * Creates the base for various kinds of the button component provided by this feature.\n\t */ _createInsertUrlButton(ButtonClass) {\n        const button = new ButtonClass(this.editor.locale);\n        button.icon = IconImageUrl;\n        button.on('execute', ()=>{\n            this._showModal();\n        });\n        return button;\n    }\n    /**\n\t * Creates a simple toolbar button, with an icon and a tooltip.\n\t */ _createToolbarButton() {\n        const t = this.editor.locale.t;\n        const button = this._createInsertUrlButton(ButtonView);\n        button.tooltip = true;\n        button.bind('label').to(this._imageInsertUI, 'isImageSelected', (isImageSelected)=>isImageSelected ? t('Update image URL') : t('Insert image via URL'));\n        return button;\n    }\n    /**\n\t * Creates a button for the dropdown view, with an icon, text and no tooltip.\n\t */ _createDropdownButton() {\n        const t = this.editor.locale.t;\n        const button = this._createInsertUrlButton(ButtonView);\n        button.withText = true;\n        button.bind('label').to(this._imageInsertUI, 'isImageSelected', (isImageSelected)=>isImageSelected ? t('Update image URL') : t('Insert via URL'));\n        return button;\n    }\n    /**\n\t * Creates a button for the menu bar.\n\t */ _createMenuBarButton(type) {\n        const t = this.editor.locale.t;\n        const button = this._createInsertUrlButton(MenuBarMenuListItemButtonView);\n        button.withText = true;\n        switch(type){\n            case 'standalone':\n                button.label = t('Image via URL');\n                break;\n            case 'insertOnly':\n                button.label = t('Image');\n                break;\n            case 'insertNested':\n                button.label = t('Via URL');\n                break;\n        }\n        return button;\n    }\n    /**\n\t * Creates the form view used to submit the image URL.\n\t */ _createInsertUrlView() {\n        const editor = this.editor;\n        const locale = editor.locale;\n        const replaceImageSourceCommand = editor.commands.get('replaceImageSource');\n        const insertImageCommand = editor.commands.get('insertImage');\n        const imageInsertUrlView = new ImageInsertUrlView(locale);\n        imageInsertUrlView.bind('isImageSelected').to(this._imageInsertUI);\n        imageInsertUrlView.bind('isEnabled').toMany([\n            insertImageCommand,\n            replaceImageSourceCommand\n        ], 'isEnabled', (...isEnabled)=>isEnabled.some((isCommandEnabled)=>isCommandEnabled));\n        return imageInsertUrlView;\n    }\n    /**\n\t * Shows the insert image via URL form view in a modal.\n\t */ _showModal() {\n        const editor = this.editor;\n        const locale = editor.locale;\n        const t = locale.t;\n        const dialog = editor.plugins.get('Dialog');\n        if (!this._formView) {\n            this._formView = this._createInsertUrlView();\n            this._formView.on('submit', ()=>this._handleSave());\n        }\n        const replaceImageSourceCommand = editor.commands.get('replaceImageSource');\n        this._formView.imageURLInputValue = replaceImageSourceCommand.value || '';\n        dialog.show({\n            id: 'insertImageViaUrl',\n            title: t('Image via URL'),\n            isModal: true,\n            content: this._formView,\n            actionButtons: [\n                {\n                    label: t('Cancel'),\n                    withText: true,\n                    onExecute: ()=>dialog.hide()\n                },\n                {\n                    label: this._imageInsertUI.isImageSelected ? t('Save') : t('Insert'),\n                    class: 'ck-button-action',\n                    withText: true,\n                    onExecute: ()=>this._handleSave()\n                }\n            ]\n        });\n    }\n    /**\n\t * Executes appropriate command depending on selection and form value.\n\t */ _handleSave() {\n        const replaceImageSourceCommand = this.editor.commands.get('replaceImageSource');\n        // If an image element is currently selected, we want to replace its source attribute (instead of inserting a new image).\n        // We detect if an image is selected by checking `replaceImageSource` command state.\n        if (replaceImageSourceCommand.isEnabled) {\n            this.editor.execute('replaceImageSource', {\n                source: this._formView.imageURLInputValue\n            });\n        } else {\n            this.editor.execute('insertImage', {\n                source: this._formView.imageURLInputValue\n            });\n        }\n        this.editor.plugins.get('Dialog').hide();\n    }\n}\n\n/**\n * The image insert via URL plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-inserting\n * Insert images via source URL} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins\n * to enable image inserting via implemented integrations:\n *\n * * {@link module:image/imageinsert/imageinsertui~ImageInsertUI},\n */ class ImageInsertViaUrl extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageInsertViaUrl';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageInsertViaUrlUI,\n            ImageInsertUI\n        ];\n    }\n}\n\n/**\n * The image insert plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature}\n * and {@glink features/images/images-inserting Insert images via source URL} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins\n * to enable image uploading or inserting via implemented integrations:\n *\n * * {@link module:image/imageupload~ImageUpload}\n * * {@link module:image/imageinsert/imageinsertui~ImageInsertUI}\n */ class ImageInsert extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageInsert';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUpload,\n            ImageInsertViaUrl,\n            ImageInsertUI\n        ];\n    }\n}\n\n/**\n * The resize image command. Currently, it only supports the width attribute.\n */ class ResizeImageCommand extends Command {\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const element = imageUtils.getClosestSelectedImageElement(editor.model.document.selection);\n        this.isEnabled = !!element;\n        if (!element || !element.hasAttribute('resizedWidth')) {\n            this.value = null;\n        } else {\n            this.value = {\n                width: element.getAttribute('resizedWidth'),\n                height: null\n            };\n        }\n    }\n    /**\n\t * Executes the command.\n\t *\n\t * ```ts\n\t * // Sets the width to 50%:\n\t * editor.execute( 'resizeImage', { width: '50%' } );\n\t *\n\t * // Removes the width attribute:\n\t * editor.execute( 'resizeImage', { width: null } );\n\t * ```\n\t *\n\t * @param options\n\t * @param options.width The new width of the image.\n\t * @fires execute\n\t */ execute(options) {\n        const editor = this.editor;\n        const model = editor.model;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n        this.value = {\n            width: options.width,\n            height: null\n        };\n        if (imageElement) {\n            model.change((writer)=>{\n                writer.setAttribute('resizedWidth', options.width, imageElement);\n                writer.removeAttribute('resizedHeight', imageElement);\n                imageUtils.setImageNaturalSizeAttributes(imageElement);\n            });\n        }\n    }\n}\n\n/**\n * The image resize editing feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n */ class ImageResizeEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageResizeEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        editor.config.define('image', {\n            resizeUnit: '%',\n            resizeOptions: [\n                {\n                    name: 'resizeImage:original',\n                    value: null,\n                    icon: 'original'\n                },\n                {\n                    name: 'resizeImage:custom',\n                    value: 'custom',\n                    icon: 'custom'\n                },\n                {\n                    name: 'resizeImage:25',\n                    value: '25',\n                    icon: 'small'\n                },\n                {\n                    name: 'resizeImage:50',\n                    value: '50',\n                    icon: 'medium'\n                },\n                {\n                    name: 'resizeImage:75',\n                    value: '75',\n                    icon: 'large'\n                }\n            ]\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const resizeImageCommand = new ResizeImageCommand(editor);\n        this._registerConverters('imageBlock');\n        this._registerConverters('imageInline');\n        // Register `resizeImage` command and add `imageResize` command as an alias for backward compatibility.\n        editor.commands.add('resizeImage', resizeImageCommand);\n        editor.commands.add('imageResize', resizeImageCommand);\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        this._registerSchema();\n    }\n    _registerSchema() {\n        const schema = this.editor.model.schema;\n        if (this.editor.plugins.has('ImageBlockEditing')) {\n            schema.extend('imageBlock', {\n                allowAttributes: [\n                    'resizedWidth',\n                    'resizedHeight'\n                ]\n            });\n            schema.setAttributeProperties('resizedWidth', {\n                isFormatting: true\n            });\n            schema.setAttributeProperties('resizedHeight', {\n                isFormatting: true\n            });\n        }\n        if (this.editor.plugins.has('ImageInlineEditing')) {\n            schema.extend('imageInline', {\n                allowAttributes: [\n                    'resizedWidth',\n                    'resizedHeight'\n                ]\n            });\n            schema.setAttributeProperties('resizedWidth', {\n                isFormatting: true\n            });\n            schema.setAttributeProperties('resizedHeight', {\n                isFormatting: true\n            });\n        }\n    }\n    /**\n\t * Registers image resize converters.\n\t *\n\t * @param imageType The type of the image.\n\t */ _registerConverters(imageType) {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        // Dedicated converter to propagate image's attribute to the img tag.\n        editor.conversion.for('downcast').add((dispatcher)=>dispatcher.on(`attribute:resizedWidth:${imageType}`, (evt, data, conversionApi)=>{\n                if (!conversionApi.consumable.consume(data.item, evt.name)) {\n                    return;\n                }\n                const viewWriter = conversionApi.writer;\n                const viewImg = conversionApi.mapper.toViewElement(data.item);\n                if (data.attributeNewValue !== null) {\n                    viewWriter.setStyle('width', data.attributeNewValue, viewImg);\n                    viewWriter.addClass('image_resized', viewImg);\n                } else {\n                    viewWriter.removeStyle('width', viewImg);\n                    viewWriter.removeClass('image_resized', viewImg);\n                }\n            }));\n        editor.conversion.for('dataDowncast').attributeToAttribute({\n            model: {\n                name: imageType,\n                key: 'resizedHeight'\n            },\n            view: (modelAttributeValue)=>({\n                    key: 'style',\n                    value: {\n                        'height': modelAttributeValue\n                    }\n                })\n        });\n        editor.conversion.for('editingDowncast').add((dispatcher)=>dispatcher.on(`attribute:resizedHeight:${imageType}`, (evt, data, conversionApi)=>{\n                if (!conversionApi.consumable.consume(data.item, evt.name)) {\n                    return;\n                }\n                const viewWriter = conversionApi.writer;\n                const viewImg = conversionApi.mapper.toViewElement(data.item);\n                const target = imageType === 'imageInline' ? imageUtils.findViewImgElement(viewImg) : viewImg;\n                if (data.attributeNewValue !== null) {\n                    viewWriter.setStyle('height', data.attributeNewValue, target);\n                } else {\n                    viewWriter.removeStyle('height', target);\n                }\n            }));\n        editor.conversion.for('upcast').attributeToAttribute({\n            view: {\n                name: imageType === 'imageBlock' ? 'figure' : 'img',\n                styles: {\n                    width: /.+/\n                }\n            },\n            model: {\n                key: 'resizedWidth',\n                value: (viewElement)=>{\n                    if (widthAndHeightStylesAreBothSet(viewElement)) {\n                        return null;\n                    }\n                    return viewElement.getStyle('width');\n                }\n            }\n        });\n        editor.conversion.for('upcast').attributeToAttribute({\n            view: {\n                name: imageType === 'imageBlock' ? 'figure' : 'img',\n                styles: {\n                    height: /.+/\n                }\n            },\n            model: {\n                key: 'resizedHeight',\n                value: (viewElement)=>{\n                    if (widthAndHeightStylesAreBothSet(viewElement)) {\n                        return null;\n                    }\n                    return viewElement.getStyle('height');\n                }\n            }\n        });\n        editor.conversion.for('upcast').add((dispatcher)=>{\n            dispatcher.on(`element:${imageType === 'imageBlock' ? 'figure' : 'img'}`, (evt, data, conversionApi)=>{\n                conversionApi.consumable.consume(data.viewItem, {\n                    classes: [\n                        'image_resized'\n                    ]\n                });\n            });\n        });\n    }\n}\n\nconst RESIZE_ICONS = /* #__PURE__ */ (()=>({\n        small: IconObjectSizeSmall,\n        medium: IconObjectSizeMedium,\n        large: IconObjectSizeLarge,\n        custom: IconObjectSizeCustom,\n        original: IconObjectSizeFull\n    }))();\n/**\n * The image resize buttons plugin.\n *\n * It adds a possibility to resize images using the toolbar dropdown or individual buttons, depending on the plugin configuration.\n */ class ImageResizeButtons extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageResizeEditing\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageResizeButtons';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * The resize unit.\n\t * @default '%'\n\t */ _resizeUnit;\n    /**\n\t * @inheritDoc\n\t */ constructor(editor){\n        super(editor);\n        this._resizeUnit = editor.config.get('image.resizeUnit');\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const options = editor.config.get('image.resizeOptions');\n        const command = editor.commands.get('resizeImage');\n        this.bind('isEnabled').to(command);\n        for (const option of options){\n            this._registerImageResizeButton(option);\n        }\n        this._registerImageResizeDropdown(options);\n    }\n    /**\n\t * A helper function that creates a standalone button component for the plugin.\n\t *\n\t * @param option A model of the resize option.\n\t */ _registerImageResizeButton(option) {\n        const editor = this.editor;\n        const { name, value, icon } = option;\n        editor.ui.componentFactory.add(name, (locale)=>{\n            const button = new ButtonView(locale);\n            const command = editor.commands.get('resizeImage');\n            const labelText = this._getOptionLabelValue(option, true);\n            if (!RESIZE_ICONS[icon]) {\n                /**\n\t\t\t\t * When configuring {@link module:image/imageconfig~ImageConfig#resizeOptions `config.image.resizeOptions`} for standalone\n\t\t\t\t * buttons, a valid `icon` token must be set for each option.\n\t\t\t\t *\n\t\t\t\t * See all valid options described in the\n\t\t\t\t * {@link module:image/imageconfig~ImageResizeOption plugin configuration}.\n\t\t\t\t *\n\t\t\t\t * @error imageresizebuttons-missing-icon\n\t\t\t\t * @param {module:image/imageconfig~ImageResizeOption} option Invalid image resize option.\n\t\t\t\t*/ throw new CKEditorError('imageresizebuttons-missing-icon', editor, option);\n            }\n            button.set({\n                // Use the `label` property for a verbose description (because of ARIA).\n                label: labelText,\n                icon: RESIZE_ICONS[icon],\n                tooltip: labelText,\n                isToggleable: true\n            });\n            // Bind button to the command.\n            button.bind('isEnabled').to(this);\n            if (editor.plugins.has('ImageCustomResizeUI') && isCustomImageResizeOption(option)) {\n                const customResizeUI = editor.plugins.get('ImageCustomResizeUI');\n                this.listenTo(button, 'execute', ()=>{\n                    customResizeUI._showForm(this._resizeUnit);\n                });\n            } else {\n                const optionValueWithUnit = value ? value + this._resizeUnit : null;\n                button.bind('isOn').to(command, 'value', command, 'isEnabled', getIsOnButtonCallback(optionValueWithUnit));\n                this.listenTo(button, 'execute', ()=>{\n                    editor.execute('resizeImage', {\n                        width: optionValueWithUnit\n                    });\n                });\n            }\n            return button;\n        });\n    }\n    /**\n\t * A helper function that creates a dropdown component for the plugin containing all the resize options defined in\n\t * the editor configuration.\n\t *\n\t * @param options An array of configured options.\n\t */ _registerImageResizeDropdown(options) {\n        const editor = this.editor;\n        const t = editor.t;\n        const originalSizeOption = options.find((option)=>!option.value);\n        const componentCreator = (locale)=>{\n            const command = editor.commands.get('resizeImage');\n            const dropdownView = createDropdown(locale, DropdownButtonView);\n            const dropdownButton = dropdownView.buttonView;\n            const accessibleLabel = t('Resize image');\n            dropdownButton.set({\n                tooltip: accessibleLabel,\n                commandValue: originalSizeOption.value,\n                icon: RESIZE_ICONS.medium,\n                isToggleable: true,\n                label: this._getOptionLabelValue(originalSizeOption),\n                withText: true,\n                class: 'ck-resize-image-button',\n                ariaLabel: accessibleLabel,\n                ariaLabelledBy: undefined\n            });\n            dropdownButton.bind('label').to(command, 'value', (commandValue)=>{\n                if (commandValue && commandValue.width) {\n                    return commandValue.width;\n                } else {\n                    return this._getOptionLabelValue(originalSizeOption);\n                }\n            });\n            dropdownView.bind('isEnabled').to(this);\n            addListToDropdown(dropdownView, ()=>this._getResizeDropdownListItemDefinitions(options, command), {\n                ariaLabel: t('Image resize list'),\n                role: 'menu'\n            });\n            // Execute command when an item from the dropdown is selected.\n            this.listenTo(dropdownView, 'execute', (evt)=>{\n                if ('onClick' in evt.source) {\n                    evt.source.onClick();\n                } else {\n                    editor.execute(evt.source.commandName, {\n                        width: evt.source.commandValue\n                    });\n                    editor.editing.view.focus();\n                }\n            });\n            return dropdownView;\n        };\n        // Register `resizeImage` dropdown and add `imageResize` dropdown as an alias for backward compatibility.\n        editor.ui.componentFactory.add('resizeImage', componentCreator);\n        editor.ui.componentFactory.add('imageResize', componentCreator);\n    }\n    /**\n\t * A helper function for creating an option label value string.\n\t *\n\t * @param option A resize option object.\n\t * @param forTooltip An optional flag for creating a tooltip label.\n\t * @returns A user-defined label combined from the numeric value and the resize unit or the default label\n\t * for reset options (`Original`).\n\t */ _getOptionLabelValue(option, forTooltip = false) {\n        const t = this.editor.t;\n        if (option.label) {\n            return option.label;\n        } else if (forTooltip) {\n            if (isCustomImageResizeOption(option)) {\n                return t('Custom image size');\n            } else if (option.value) {\n                return t('Resize image to %0', option.value + this._resizeUnit);\n            } else {\n                return t('Resize image to the original size');\n            }\n        } else {\n            if (isCustomImageResizeOption(option)) {\n                return t('Custom');\n            } else if (option.value) {\n                return option.value + this._resizeUnit;\n            } else {\n                return t('Original');\n            }\n        }\n    }\n    /**\n\t * A helper function that parses the resize options and returns list item definitions ready for use in the dropdown.\n\t *\n\t * @param options The resize options.\n\t * @param command The resize image command.\n\t * @returns Dropdown item definitions.\n\t */ _getResizeDropdownListItemDefinitions(options, command) {\n        const { editor } = this;\n        const itemDefinitions = new Collection();\n        const optionsWithSerializedValues = options.map((option)=>{\n            if (isCustomImageResizeOption(option)) {\n                return {\n                    ...option,\n                    valueWithUnits: 'custom'\n                };\n            }\n            if (!option.value) {\n                return {\n                    ...option,\n                    valueWithUnits: null\n                };\n            }\n            return {\n                ...option,\n                valueWithUnits: `${option.value}${this._resizeUnit}`\n            };\n        });\n        for (const option of optionsWithSerializedValues){\n            let definition = null;\n            if (editor.plugins.has('ImageCustomResizeUI') && isCustomImageResizeOption(option)) {\n                const customResizeUI = editor.plugins.get('ImageCustomResizeUI');\n                definition = {\n                    type: 'button',\n                    model: new UIModel({\n                        label: this._getOptionLabelValue(option),\n                        role: 'menuitemradio',\n                        withText: true,\n                        icon: null,\n                        onClick: ()=>{\n                            customResizeUI._showForm(this._resizeUnit);\n                        }\n                    })\n                };\n                const allDropdownValues = Object.values(optionsWithSerializedValues).map((option)=>option.valueWithUnits);\n                definition.model.bind('isOn').to(command, 'value', command, 'isEnabled', getIsOnCustomButtonCallback(allDropdownValues));\n            } else {\n                definition = {\n                    type: 'button',\n                    model: new UIModel({\n                        commandName: 'resizeImage',\n                        commandValue: option.valueWithUnits,\n                        label: this._getOptionLabelValue(option),\n                        role: 'menuitemradio',\n                        withText: true,\n                        icon: null\n                    })\n                };\n                definition.model.bind('isOn').to(command, 'value', command, 'isEnabled', getIsOnButtonCallback(option.valueWithUnits));\n            }\n            definition.model.bind('isEnabled').to(command, 'isEnabled');\n            itemDefinitions.add(definition);\n        }\n        return itemDefinitions;\n    }\n}\n/**\n * A helper that checks if provided option triggers custom resize balloon.\n */ function isCustomImageResizeOption(option) {\n    return option.value === 'custom';\n}\n/**\n * A helper function for setting the `isOn` state of buttons in value bindings.\n */ function getIsOnButtonCallback(value) {\n    return (commandValue, isEnabled)=>{\n        const objectCommandValue = commandValue;\n        if (objectCommandValue === undefined || !isEnabled) {\n            return false;\n        }\n        if (value === null && objectCommandValue === value) {\n            return true;\n        }\n        return objectCommandValue !== null && objectCommandValue.width === value;\n    };\n}\n/**\n * A helper function for setting the `isOn` state of custom size button in value bindings.\n */ function getIsOnCustomButtonCallback(allDropdownValues) {\n    return (commandValue, isEnabled)=>!allDropdownValues.some((dropdownValue)=>getIsOnButtonCallback(dropdownValue)(commandValue, isEnabled));\n}\n\nconst RESIZABLE_IMAGES_CSS_SELECTOR = 'figure.image.ck-widget > img,' + 'figure.image.ck-widget > picture > img,' + 'figure.image.ck-widget > a > img,' + 'figure.image.ck-widget > a > picture > img,' + 'span.image-inline.ck-widget > img,' + 'span.image-inline.ck-widget > picture > img';\nconst RESIZED_IMAGE_CLASS = 'image_resized';\n/**\n * The image resize by handles feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n */ class ImageResizeHandles extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            WidgetResize,\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageResizeHandles';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const command = this.editor.commands.get('resizeImage');\n        this.bind('isEnabled').to(command);\n        this._setupResizerCreator();\n    }\n    /**\n\t * Attaches the listeners responsible for creating a resizer for each image, except for images inside the HTML embed preview.\n\t */ _setupResizerCreator() {\n        const editor = this.editor;\n        const editingView = editor.editing.view;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        editingView.addObserver(ImageLoadObserver);\n        this.listenTo(editingView.document, 'imageLoaded', (evt, domEvent)=>{\n            // The resizer must be attached only to images loaded by the `ImageInsert`, `ImageUpload` or `LinkImage` plugins.\n            if (!domEvent.target.matches(RESIZABLE_IMAGES_CSS_SELECTOR)) {\n                return;\n            }\n            const domConverter = editor.editing.view.domConverter;\n            const imageView = domConverter.domToView(domEvent.target);\n            const widgetView = imageUtils.getImageWidgetFromImageView(imageView);\n            let resizer = this.editor.plugins.get(WidgetResize).getResizerByViewElement(widgetView);\n            if (resizer) {\n                // There are rare cases when the image will be triggered multiple times for the same widget, e.g. when\n                // the image's source was changed after upload (https://github.com/ckeditor/ckeditor5/pull/8108#issuecomment-708302992).\n                resizer.redraw();\n                return;\n            }\n            const mapper = editor.editing.mapper;\n            const imageModel = mapper.toModelElement(widgetView);\n            resizer = editor.plugins.get(WidgetResize).attachTo({\n                unit: editor.config.get('image.resizeUnit'),\n                modelElement: imageModel,\n                viewElement: widgetView,\n                editor,\n                getHandleHost (domWidgetElement) {\n                    return domWidgetElement.querySelector('img');\n                },\n                getResizeHost () {\n                    return domConverter.mapViewToDom(mapper.toViewElement(imageModel));\n                },\n                isCentered () {\n                    const imageStyle = imageModel.getAttribute('imageStyle');\n                    return imageStyle == 'alignCenter';\n                },\n                onCommit (newValue) {\n                    // Get rid of the CSS class in case the command execution that follows is unsuccessful\n                    // (e.g. Track Changes can override it and the new dimensions will not apply). Otherwise,\n                    // the presence of the class and the absence of the width style will cause it to take 100%\n                    // of the horizontal space.\n                    editingView.change((writer)=>{\n                        writer.removeClass(RESIZED_IMAGE_CLASS, widgetView);\n                    });\n                    editor.execute('resizeImage', {\n                        width: newValue\n                    });\n                }\n            });\n            resizer.on('updateSize', ()=>{\n                if (!widgetView.hasClass(RESIZED_IMAGE_CLASS)) {\n                    editingView.change((writer)=>{\n                        writer.addClass(RESIZED_IMAGE_CLASS, widgetView);\n                    });\n                }\n                const target = imageModel.name === 'imageInline' ? imageView : widgetView;\n                if (target.getStyle('height')) {\n                    editingView.change((writer)=>{\n                        writer.removeStyle('height', target);\n                    });\n                }\n            });\n            resizer.bind('isEnabled').to(this);\n        });\n    }\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n * @module image/imageresize/utils/tryparsedimensionwithunit\n */ /**\n * Parses provided string with dimension value and returns extracted numeric value and unit.\n *\n * \t* If non-string dimension is passed then `null` value is returned.\n * \t* If unit is missing then `null` is returned.\n * \t* If numeric value part of string is not a number then `null` is returned.\n *\n * Example:\n * \t`\"222px\"` => `{ value: 222, unit: \"px\" }`\n *\t`\"99%\"` => `{ value: 99, unit: \"%\" }`\n\n * @param dimension Unsafe string with dimension.\n * @returns Parsed dimension with extracted numeric value and units.\n * @internal\n */ function tryParseDimensionWithUnit(dimension) {\n    if (!dimension) {\n        return null;\n    }\n    const [, rawValue, unit] = dimension.trim().match(/([.,\\d]+)(%|px)$/) || [];\n    const parsedValue = Number.parseFloat(rawValue);\n    if (Number.isNaN(parsedValue)) {\n        return null;\n    }\n    return {\n        value: parsedValue,\n        unit\n    };\n}\n/**\n * Converts dimension between `px` -> `%` and `%` -> `px`.\n *\n * @param parentDimensionPx\tDimension of parent element that contains measured element.\n * @param dimension Measured element dimension.\n * @returns Casted dimension.\n * @internal\n */ function tryCastDimensionsToUnit(parentDimensionPx, dimension, targetUnit) {\n    // \"%\" -> \"px\" conversion\n    if (targetUnit === 'px') {\n        return {\n            value: dimension.value,\n            unit: 'px'\n        };\n    }\n    // \"px\" -> \"%\" conversion\n    return {\n        value: dimension.value / parentDimensionPx * 100,\n        unit: '%'\n    };\n}\n\n/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */ /**\n * @module image/imageresize/utils/getselectedimageeditornodes\n */ /**\n * Finds model, view and DOM element for selected image element. Returns `null` if there is no image selected.\n *\n * @param editor Editor instance.\n * @internal\n */ function getSelectedImageEditorNodes(editor) {\n    const { editing } = editor;\n    const imageUtils = editor.plugins.get('ImageUtils');\n    const imageModelElement = imageUtils.getClosestSelectedImageElement(editor.model.document.selection);\n    if (!imageModelElement) {\n        return null;\n    }\n    const imageViewElement = editing.mapper.toViewElement(imageModelElement);\n    const imageDOMElement = editing.view.domConverter.mapViewToDom(imageViewElement);\n    return {\n        model: imageModelElement,\n        view: imageViewElement,\n        dom: imageDOMElement\n    };\n}\n\n/**\n * Returns image width in specified units. It is width of image after resize.\n *\n * \t* If image is not selected or command is disabled then `null` will be returned.\n * \t* If image is not fully loaded (and it is impossible to determine its natural size) then `null` will be returned.\n *\t* If `targetUnit` percentage is passed then it will return width percentage of image related to its accessors.\n *\n * @param editor Editor instance.\n * @param targetUnit Unit in which dimension will be returned.\n * @returns Parsed image width after resize (with unit).\n * @internal\n */ function getSelectedImageWidthInUnits(editor, targetUnit) {\n    const imageNodes = getSelectedImageEditorNodes(editor);\n    if (!imageNodes) {\n        return null;\n    }\n    const parsedResizedWidth = tryParseDimensionWithUnit(imageNodes.model.getAttribute('resizedWidth') || null);\n    if (!parsedResizedWidth) {\n        return null;\n    }\n    if (parsedResizedWidth.unit === targetUnit) {\n        return parsedResizedWidth;\n    }\n    const imageParentWidthPx = calculateResizeHostAncestorWidth(imageNodes.dom);\n    const imageHolderDimension = {\n        value: new Rect(imageNodes.dom).width\n    };\n    return tryCastDimensionsToUnit(imageParentWidthPx, imageHolderDimension, targetUnit);\n}\n\n/**\n * The ImageCustomResizeFormView class.\n *\n * @internal\n */ class ImageCustomResizeFormView extends View {\n    /**\n\t * Tracks information about the DOM focus in the form.\n\t */ focusTracker;\n    /**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */ keystrokes;\n    /**\n\t * Resize unit shortcut.\n\t */ unit;\n    /**\n\t * The Back button view displayed in the header.\n\t */ backButtonView;\n    /**\n\t * A button used to submit the form.\n\t */ saveButtonView;\n    /**\n\t * An input with a label.\n\t */ labeledInput;\n    /**\n\t * A collection of child views.\n\t */ children;\n    /**\n\t * A collection of views which can be focused in the form.\n\t */ _focusables;\n    /**\n\t * Helps cycling over {@link #_focusables} in the form.\n\t */ _focusCycler;\n    /**\n\t * An array of form validators used by {@link #isValid}.\n\t */ _validators;\n    /**\n\t * @inheritDoc\n\t */ constructor(locale, unit, validators){\n        super(locale);\n        this.focusTracker = new FocusTracker();\n        this.keystrokes = new KeystrokeHandler();\n        this.unit = unit;\n        // Create buttons.\n        this.backButtonView = this._createBackButton();\n        this.saveButtonView = this._createSaveButton();\n        // Create input fields.\n        this.labeledInput = this._createLabeledInputView();\n        this.children = this.createCollection([\n            this._createHeaderView()\n        ]);\n        this.children.add(new FormRowView(locale, {\n            children: [\n                this.labeledInput,\n                this.saveButtonView\n            ],\n            class: [\n                'ck-form__row_with-submit',\n                'ck-form__row_large-top-padding'\n            ]\n        }));\n        this._focusables = new ViewCollection();\n        this._validators = validators;\n        // Close the panel on esc key press when the **form has focus**.\n        this.keystrokes.set('Esc', (data, cancel)=>{\n            this.fire('cancel');\n            cancel();\n        });\n        this._focusCycler = new FocusCycler({\n            focusables: this._focusables,\n            focusTracker: this.focusTracker,\n            keystrokeHandler: this.keystrokes,\n            actions: {\n                // Navigate form fields backwards using the Shift + Tab keystroke.\n                focusPrevious: 'shift + tab',\n                // Navigate form fields forwards using the Tab key.\n                focusNext: 'tab'\n            }\n        });\n        this.setTemplate({\n            tag: 'form',\n            attributes: {\n                class: [\n                    'ck',\n                    'ck-form',\n                    'ck-image-custom-resize-form',\n                    'ck-responsive-form'\n                ],\n                // https://github.com/ckeditor/ckeditor5-image/issues/40\n                tabindex: '-1'\n            },\n            children: this.children\n        });\n    }\n    /**\n\t * @inheritDoc\n\t */ render() {\n        super.render();\n        submitHandler({\n            view: this\n        });\n        const childViews = [\n            this.backButtonView,\n            this.labeledInput,\n            this.saveButtonView\n        ];\n        childViews.forEach((v)=>{\n            // Register the view as focusable.\n            this._focusables.add(v);\n            // Register the view in the focus tracker.\n            this.focusTracker.add(v.element);\n        });\n        this.keystrokes.listenTo(this.element);\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        super.destroy();\n        this.focusTracker.destroy();\n        this.keystrokes.destroy();\n    }\n    /**\n\t * Creates a back button view that cancels the form.\n\t */ _createBackButton() {\n        const t = this.locale.t;\n        const backButton = new ButtonView(this.locale);\n        backButton.set({\n            class: 'ck-button-back',\n            label: t('Back'),\n            icon: IconPreviousArrow,\n            tooltip: true\n        });\n        backButton.delegate('execute').to(this, 'cancel');\n        return backButton;\n    }\n    /**\n\t * Creates a save button view that resize the image.\n\t */ _createSaveButton() {\n        const t = this.locale.t;\n        const saveButton = new ButtonView(this.locale);\n        saveButton.set({\n            label: t('Save'),\n            withText: true,\n            type: 'submit',\n            class: 'ck-button-action ck-button-bold'\n        });\n        return saveButton;\n    }\n    /**\n\t * Creates a header view for the form.\n\t */ _createHeaderView() {\n        const t = this.locale.t;\n        const header = new FormHeaderView(this.locale, {\n            label: t('Image Resize')\n        });\n        header.children.add(this.backButtonView, 0);\n        return header;\n    }\n    /**\n\t * Creates an input with a label.\n\t *\n\t * @returns Labeled field view instance.\n\t */ _createLabeledInputView() {\n        const t = this.locale.t;\n        const labeledInput = new LabeledFieldView(this.locale, createLabeledInputNumber);\n        labeledInput.label = t('Resize image (in %0)', this.unit);\n        labeledInput.class = 'ck-labeled-field-view_full-width';\n        labeledInput.fieldView.set({\n            step: 0.1\n        });\n        return labeledInput;\n    }\n    /**\n\t * Validates the form and returns `false` when some fields are invalid.\n\t */ isValid() {\n        this.resetFormStatus();\n        for (const validator of this._validators){\n            const errorText = validator(this);\n            // One error per field is enough.\n            if (errorText) {\n                // Apply updated error.\n                this.labeledInput.errorText = errorText;\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n\t * Cleans up the supplementary error and information text of the {@link #labeledInput}\n\t * bringing them back to the state when the form has been displayed for the first time.\n\t *\n\t * See {@link #isValid}.\n\t */ resetFormStatus() {\n        this.labeledInput.errorText = null;\n    }\n    /**\n\t * The native DOM `value` of the input element of {@link #labeledInput}.\n\t */ get rawSize() {\n        const { element } = this.labeledInput.fieldView;\n        if (!element) {\n            return null;\n        }\n        return element.value;\n    }\n    /**\n\t * Get numeric value of size. Returns `null` if value of size input element in {@link #labeledInput}.is not a number.\n\t */ get parsedSize() {\n        const { rawSize } = this;\n        if (rawSize === null) {\n            return null;\n        }\n        const parsed = Number.parseFloat(rawSize);\n        if (Number.isNaN(parsed)) {\n            return null;\n        }\n        return parsed;\n    }\n    /**\n\t * Returns serialized image input size with unit.\n\t * Returns `null` if value of size input element in {@link #labeledInput}.is not a number.\n\t */ get sizeWithUnits() {\n        const { parsedSize, unit } = this;\n        if (parsedSize === null) {\n            return null;\n        }\n        return `${parsedSize}${unit}`;\n    }\n}\n\n/**\n * Returns min and max value of resize image in specified unit.\n *\n * @param editor Editor instance.\n * @param targetUnit Unit in which dimension will be returned.\n * @returns Possible resize range in numeric form.\n * @internal\n */ function getSelectedImagePossibleResizeRange(editor, targetUnit) {\n    const imageNodes = getSelectedImageEditorNodes(editor);\n    if (!imageNodes) {\n        return null;\n    }\n    const imageParentWidthPx = calculateResizeHostAncestorWidth(imageNodes.dom);\n    const minimumImageWidth = tryParseDimensionWithUnit(window.getComputedStyle(imageNodes.dom).minWidth) || {\n        value: 1};\n    const lower = Math.max(0.1, tryCastDimensionsToUnit(imageParentWidthPx, minimumImageWidth, targetUnit).value);\n    const upper = targetUnit === 'px' ? imageParentWidthPx : 100;\n    return {\n        unit: targetUnit,\n        lower,\n        upper\n    };\n}\n\n/**\n * The custom resize image UI plugin.\n *\n * The plugin uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */ class ImageCustomResizeUI extends Plugin {\n    /**\n\t * The contextual balloon plugin instance.\n\t */ _balloon;\n    /**\n\t * A form containing a textarea and buttons, used to change the `alt` text value.\n\t */ _form;\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ContextualBalloon\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageCustomResizeUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ destroy() {\n        super.destroy();\n        // Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n        if (this._form) {\n            this._form.destroy();\n        }\n    }\n    /**\n\t * Creates the {@link module:image/imageresize/ui/imagecustomresizeformview~ImageCustomResizeFormView}\n\t * form.\n\t */ _createForm(unit) {\n        const editor = this.editor;\n        this._balloon = this.editor.plugins.get('ContextualBalloon');\n        this._form = new (CssTransitionDisablerMixin(ImageCustomResizeFormView))(editor.locale, unit, getFormValidators(editor));\n        // Render the form so its #element is available for clickOutsideHandler.\n        this._form.render();\n        this.listenTo(this._form, 'submit', ()=>{\n            if (this._form.isValid()) {\n                editor.execute('resizeImage', {\n                    width: this._form.sizeWithUnits\n                });\n                this._hideForm(true);\n            }\n        });\n        // Update balloon position when form error label is added .\n        this.listenTo(this._form.labeledInput, 'change:errorText', ()=>{\n            editor.ui.update();\n        });\n        this.listenTo(this._form, 'cancel', ()=>{\n            this._hideForm(true);\n        });\n        // Close on click outside of balloon panel element.\n        clickOutsideHandler({\n            emitter: this._form,\n            activator: ()=>this._isVisible,\n            contextElements: ()=>[\n                    this._balloon.view.element\n                ],\n            callback: ()=>this._hideForm()\n        });\n    }\n    /**\n\t * Shows the {@link #_form} in the {@link #_balloon}.\n\t *\n\t * @internal\n\t */ _showForm(unit) {\n        if (this._isVisible) {\n            return;\n        }\n        if (!this._form) {\n            this._createForm(unit);\n        }\n        const editor = this.editor;\n        const labeledInput = this._form.labeledInput;\n        this._form.disableCssTransitions();\n        this._form.resetFormStatus();\n        if (!this._isInBalloon) {\n            this._balloon.add({\n                view: this._form,\n                position: getBalloonPositionData(editor)\n            });\n        }\n        // Make sure that each time the panel shows up, the field remains in sync with the value of\n        // the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n        // stays unaltered) and re-opened it without changing the value of the command, they would see the\n        // old value instead of the actual value of the command.\n        const currentParsedWidth = getSelectedImageWidthInUnits(editor, unit);\n        const initialInputValue = currentParsedWidth ? currentParsedWidth.value.toFixed(1) : '';\n        const possibleRange = getSelectedImagePossibleResizeRange(editor, unit);\n        labeledInput.fieldView.value = labeledInput.fieldView.element.value = initialInputValue;\n        if (possibleRange) {\n            Object.assign(labeledInput.fieldView, {\n                min: possibleRange.lower.toFixed(1),\n                max: Math.ceil(possibleRange.upper).toFixed(1)\n            });\n        }\n        this._form.labeledInput.fieldView.select();\n        this._form.enableCssTransitions();\n    }\n    /**\n\t * Removes the {@link #_form} from the {@link #_balloon}.\n\t *\n\t * @param focusEditable Controls whether the editing view is focused afterwards.\n\t */ _hideForm(focusEditable = false) {\n        if (!this._isInBalloon) {\n            return;\n        }\n        // Blur the input element before removing it from DOM to prevent issues in some browsers.\n        // See https://github.com/ckeditor/ckeditor5/issues/1501.\n        if (this._form.focusTracker.isFocused) {\n            this._form.saveButtonView.focus();\n        }\n        this._balloon.remove(this._form);\n        if (focusEditable) {\n            this.editor.editing.view.focus();\n        }\n    }\n    /**\n\t * Returns `true` when the {@link #_form} is the visible view in the {@link #_balloon}.\n\t */ get _isVisible() {\n        return !!this._balloon && this._balloon.visibleView === this._form;\n    }\n    /**\n\t * Returns `true` when the {@link #_form} is in the {@link #_balloon}.\n\t */ get _isInBalloon() {\n        return !!this._balloon && this._balloon.hasView(this._form);\n    }\n}\n/**\n * Returns image resize form validation callbacks.\n *\n * @param editor Editor instance.\n */ function getFormValidators(editor) {\n    const t = editor.t;\n    return [\n        (form)=>{\n            if (form.rawSize.trim() === '') {\n                return t('The value must not be empty.');\n            }\n            if (form.parsedSize === null) {\n                return t('The value should be a plain number.');\n            }\n        }\n    ];\n}\n\n/**\n * The image resize plugin.\n *\n * It adds a possibility to resize each image using handles.\n */ class ImageResize extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageResizeEditing,\n            ImageResizeHandles,\n            ImageCustomResizeUI,\n            ImageResizeButtons\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageResize';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * The image style command. It is used to apply {@link module:image/imageconfig~ImageStyleConfig#options image style option}\n * to a selected image.\n *\n * **Note**: Executing this command may change the image model element if the desired style requires an image of a different\n * type. See {@link module:image/imagestyle/imagestylecommand~ImageStyleCommand#execute} to learn more.\n */ class ImageStyleCommand extends Command {\n    /**\n\t * An object containing names of default style options for the inline and block images.\n\t * If there is no default style option for the given image type in the configuration,\n\t * the name will be `false`.\n\t */ _defaultStyles;\n    /**\n\t * The styles handled by this command.\n\t */ _styles;\n    /**\n\t * Creates an instance of the image style command. When executed, the command applies one of\n\t * {@link module:image/imageconfig~ImageStyleConfig#options style options} to the currently selected image.\n\t *\n\t * @param editor The editor instance.\n\t * @param styles The style options that this command supports.\n\t */ constructor(editor, styles){\n        super(editor);\n        this._defaultStyles = {\n            imageBlock: false,\n            imageInline: false\n        };\n        this._styles = new Map(styles.map((style)=>{\n            if (style.isDefault) {\n                for (const modelElementName of style.modelElements){\n                    this._defaultStyles[modelElementName] = style.name;\n                }\n            }\n            return [\n                style.name,\n                style\n            ];\n        }));\n    }\n    /**\n\t * @inheritDoc\n\t */ refresh() {\n        const editor = this.editor;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        const element = imageUtils.getClosestSelectedImageElement(this.editor.model.document.selection);\n        this.isEnabled = !!element;\n        if (!this.isEnabled) {\n            this.value = false;\n        } else if (element.hasAttribute('imageStyle')) {\n            this.value = element.getAttribute('imageStyle');\n        } else {\n            this.value = this._defaultStyles[element.name];\n        }\n    }\n    /**\n\t * Executes the command and applies the style to the currently selected image:\n\t *\n\t * ```ts\n\t * editor.execute( 'imageStyle', { value: 'side' } );\n\t * ```\n\t *\n\t * **Note**: Executing this command may change the image model element if the desired style requires an image\n\t * of a different type. Learn more about {@link module:image/imageconfig~ImageStyleOptionDefinition#modelElements model element}\n\t * configuration for the style option.\n\t *\n\t * @param options.value The name of the style (as configured in {@link module:image/imageconfig~ImageStyleConfig#options}).\n\t * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n\t * The default is `true`.\n\t * @fires execute\n\t */ execute(options = {}) {\n        const editor = this.editor;\n        const model = editor.model;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        model.change((writer)=>{\n            const requestedStyle = options.value;\n            const { setImageSizes = true } = options;\n            let imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n            // Change the image type if a style requires it.\n            if (requestedStyle && this.shouldConvertImageType(requestedStyle, imageElement)) {\n                this.editor.execute(imageUtils.isBlockImage(imageElement) ? 'imageTypeInline' : 'imageTypeBlock', {\n                    setImageSizes\n                });\n                // Update the imageElement to the newly created image.\n                imageElement = imageUtils.getClosestSelectedImageElement(model.document.selection);\n            }\n            // Default style means that there is no `imageStyle` attribute in the model.\n            // https://github.com/ckeditor/ckeditor5-image/issues/147\n            if (!requestedStyle || this._styles.get(requestedStyle).isDefault) {\n                writer.removeAttribute('imageStyle', imageElement);\n            } else {\n                writer.setAttribute('imageStyle', requestedStyle, imageElement);\n            }\n            if (setImageSizes) {\n                imageUtils.setImageNaturalSizeAttributes(imageElement);\n            }\n        });\n    }\n    /**\n\t * Returns `true` if requested style change would trigger the image type change.\n\t *\n\t * @param requestedStyle The name of the style (as configured in {@link module:image/imageconfig~ImageStyleConfig#options}).\n\t * @param imageElement The image model element.\n\t */ shouldConvertImageType(requestedStyle, imageElement) {\n        const supportedTypes = this._styles.get(requestedStyle).modelElements;\n        return !supportedTypes.includes(imageElement.name);\n    }\n}\n\n/**\n * Default image style options provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#styles}\n * configuration.\n *\n * There are available 5 styles focused on formatting:\n *\n * * **`'alignLeft'`** aligns the inline or block image to the left and wraps it with the text using the `image-style-align-left` class,\n * * **`'alignRight'`** aligns the inline or block image to the right and wraps it with the text using the `image-style-align-right` class,\n * * **`'alignCenter'`** centers the block image using the `image-style-align-center` class,\n * * **`'alignBlockLeft'`** aligns the block image to the left using the `image-style-block-align-left` class,\n * * **`'alignBlockRight'`** aligns the block image to the right using the `image-style-block-align-right` class,\n *\n * and 3 semantic styles:\n *\n * * **`'inline'`** is an inline image without any CSS class,\n * * **`'block'`** is a block image without any CSS class,\n * * **`'side'`** is a block image styled with the `image-style-side` CSS class.\n *\n * @internal\n */ const DEFAULT_OPTIONS = {\n    // This style represents an image placed in the line of text.\n    get inline () {\n        return {\n            name: 'inline',\n            title: 'In line',\n            icon: IconObjectInline,\n            modelElements: [\n                'imageInline'\n            ],\n            isDefault: true\n        };\n    },\n    // This style represents an image aligned to the left and wrapped with text.\n    get alignLeft () {\n        return {\n            name: 'alignLeft',\n            title: 'Left aligned image',\n            icon: IconObjectInlineLeft,\n            modelElements: [\n                'imageBlock',\n                'imageInline'\n            ],\n            className: 'image-style-align-left'\n        };\n    },\n    // This style represents an image aligned to the left.\n    get alignBlockLeft () {\n        return {\n            name: 'alignBlockLeft',\n            title: 'Left aligned image',\n            icon: IconObjectLeft,\n            modelElements: [\n                'imageBlock'\n            ],\n            className: 'image-style-block-align-left'\n        };\n    },\n    // This style represents a centered image.\n    get alignCenter () {\n        return {\n            name: 'alignCenter',\n            title: 'Centered image',\n            icon: IconObjectCenter,\n            modelElements: [\n                'imageBlock'\n            ],\n            className: 'image-style-align-center'\n        };\n    },\n    // This style represents an image aligned to the right and wrapped with text.\n    get alignRight () {\n        return {\n            name: 'alignRight',\n            title: 'Right aligned image',\n            icon: IconObjectInlineRight,\n            modelElements: [\n                'imageBlock',\n                'imageInline'\n            ],\n            className: 'image-style-align-right'\n        };\n    },\n    // This style represents an image aligned to the right.\n    get alignBlockRight () {\n        return {\n            name: 'alignBlockRight',\n            title: 'Right aligned image',\n            icon: IconObjectRight,\n            modelElements: [\n                'imageBlock'\n            ],\n            className: 'image-style-block-align-right'\n        };\n    },\n    // This option is equal to the situation when no style is applied.\n    get block () {\n        return {\n            name: 'block',\n            title: 'Centered image',\n            icon: IconObjectCenter,\n            modelElements: [\n                'imageBlock'\n            ],\n            isDefault: true\n        };\n    },\n    // This represents a side image.\n    get side () {\n        return {\n            name: 'side',\n            title: 'Side image',\n            icon: IconObjectInlineRight,\n            modelElements: [\n                'imageBlock'\n            ],\n            className: 'image-style-side'\n        };\n    }\n};\n/**\n * Default image style icons provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#styles}\n * configuration.\n *\n * See {@link module:image/imageconfig~ImageStyleOptionDefinition#icon} to learn more.\n *\n * There are 7 default icons available: `'full'`, `'left'`, `'inlineLeft'`, `'center'`, `'right'`, `'inlineRight'`, and `'inline'`.\n *\n * @internal\n */ const DEFAULT_ICONS = /* #__PURE__ */ (()=>({\n        full: IconObjectFullWidth,\n        left: IconObjectLeft,\n        right: IconObjectRight,\n        center: IconObjectCenter,\n        inlineLeft: IconObjectInlineLeft,\n        inlineRight: IconObjectInlineRight,\n        inline: IconObjectInline\n    }))();\n/**\n * Default drop-downs provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#toolbar}\n * configuration. The drop-downs are containers for the {@link module:image/imageconfig~ImageStyleConfig#options image style options}.\n *\n * If both of the `ImageEditing` plugins are loaded, there are 2 predefined drop-downs available:\n *\n * * **`'imageStyle:wrapText'`**, which contains the `alignLeft` and `alignRight` options, that is,\n * those that wraps the text around the image,\n * * **`'imageStyle:breakText'`**, which contains the `alignBlockLeft`, `alignCenter` and `alignBlockRight` options, that is,\n * those that breaks the text around the image.\n *\n * @internal\n */ const DEFAULT_DROPDOWN_DEFINITIONS = [\n    {\n        name: 'imageStyle:wrapText',\n        title: 'Wrap text',\n        defaultItem: 'imageStyle:alignLeft',\n        items: [\n            'imageStyle:alignLeft',\n            'imageStyle:alignRight'\n        ]\n    },\n    {\n        name: 'imageStyle:breakText',\n        title: 'Break text',\n        defaultItem: 'imageStyle:block',\n        items: [\n            'imageStyle:alignBlockLeft',\n            'imageStyle:block',\n            'imageStyle:alignBlockRight'\n        ]\n    }\n];\n/**\n * Returns a list of the normalized and validated image style options.\n *\n * @param config\n * @param config.isInlinePluginLoaded\n * Determines whether the {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugin has been loaded.\n * @param config.isBlockPluginLoaded\n * Determines whether the {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} plugin has been loaded.\n * @param config.configuredStyles\n * The image styles configuration provided in the image styles {@link module:image/imageconfig~ImageConfig#styles configuration}\n * as a default or custom value.\n * @returns\n * * Each of options contains a complete icon markup.\n * * The image style options not supported by any of the loaded plugins are filtered out.\n */ function normalizeStyles(config) {\n    const configuredStyles = config.configuredStyles.options || [];\n    const styles = configuredStyles.map((arrangement)=>normalizeDefinition(arrangement)).filter((arrangement)=>isValidOption(arrangement, config));\n    return styles;\n}\n/**\n * Returns the default image styles configuration depending on the loaded image editing plugins.\n *\n * @param isInlinePluginLoaded\n * Determines whether the {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugin has been loaded.\n *\n * @param isBlockPluginLoaded\n * Determines whether the {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} plugin has been loaded.\n *\n * @returns\n * It returns an object with the lists of the image style options and groups defined as strings related to the\n * {@link module:image/imagestyle/utils#DEFAULT_OPTIONS default options}\n */ function getDefaultStylesConfiguration(isBlockPluginLoaded, isInlinePluginLoaded) {\n    if (isBlockPluginLoaded && isInlinePluginLoaded) {\n        return {\n            options: [\n                'inline',\n                'alignLeft',\n                'alignRight',\n                'alignCenter',\n                'alignBlockLeft',\n                'alignBlockRight',\n                'block',\n                'side'\n            ]\n        };\n    } else if (isBlockPluginLoaded) {\n        return {\n            options: [\n                'block',\n                'side'\n            ]\n        };\n    } else if (isInlinePluginLoaded) {\n        return {\n            options: [\n                'inline',\n                'alignLeft',\n                'alignRight'\n            ]\n        };\n    }\n    return {};\n}\n/**\n * Returns a list of the available predefined drop-downs' definitions depending on the loaded image editing plugins.\n */ function getDefaultDropdownDefinitions(pluginCollection) {\n    if (pluginCollection.has('ImageBlockEditing') && pluginCollection.has('ImageInlineEditing')) {\n        return [\n            ...DEFAULT_DROPDOWN_DEFINITIONS\n        ];\n    } else {\n        return [];\n    }\n}\n/**\n * Normalizes an image style option or group provided in the {@link module:image/imageconfig~ImageConfig#styles}\n * and returns it in a {@link module:image/imageconfig~ImageStyleOptionDefinition}/\n */ function normalizeDefinition(definition) {\n    if (typeof definition === 'string') {\n        // Just the name of the style has been passed, but none of the defaults.\n        if (!DEFAULT_OPTIONS[definition]) {\n            // Normalize the style anyway to prevent errors.\n            definition = {\n                name: definition\n            };\n        } else {\n            definition = {\n                ...DEFAULT_OPTIONS[definition]\n            };\n        }\n    } else {\n        // If an object style has been passed and if the name matches one of the defaults,\n        // extend it with defaults – the user wants to customize a default style.\n        // Note: Don't override the user–defined style object, clone it instead.\n        definition = extendStyle(DEFAULT_OPTIONS[definition.name], definition);\n    }\n    // If an icon is defined as a string and correspond with a name\n    // in default icons, use the default icon provided by the plugin.\n    if (typeof definition.icon === 'string') {\n        definition.icon = DEFAULT_ICONS[definition.icon] || definition.icon;\n    }\n    return definition;\n}\n/**\n * Checks if the image style option is valid:\n * * if it has the modelElements fields defined and filled,\n * * if the defined modelElements are supported by any of the loaded image editing plugins.\n * It also displays a console warning these conditions are not met.\n *\n * @param option image style option\n */ function isValidOption(option, { isBlockPluginLoaded, isInlinePluginLoaded }) {\n    const { modelElements, name } = option;\n    if (!modelElements || !modelElements.length || !name) {\n        warnInvalidStyle({\n            style: option\n        });\n        return false;\n    } else {\n        const supportedElements = [\n            isBlockPluginLoaded ? 'imageBlock' : null,\n            isInlinePluginLoaded ? 'imageInline' : null\n        ];\n        // Check if the option is supported by any of the loaded plugins.\n        if (!modelElements.some((elementName)=>supportedElements.includes(elementName))) {\n            /**\n\t\t\t * In order to work correctly, each image style {@link module:image/imageconfig~ImageStyleOptionDefinition option}\n\t\t\t * requires specific model elements (also: types of images) to be supported by the editor.\n\t\t\t *\n\t\t\t * Model element names to which the image style option can be applied are defined in the\n\t\t\t * {@link module:image/imageconfig~ImageStyleOptionDefinition#modelElements} property of the style option\n\t\t\t * definition.\n\t\t\t *\n\t\t\t * Explore the warning in the console to find out precisely which option is not supported and which editor plugins\n\t\t\t * are missing. Make sure these plugins are loaded in your editor to get this image style option working.\n\t\t\t *\n\t\t\t * @error image-style-missing-dependency\n\t\t\t * @param {string} style The name of the unsupported option.\n\t\t\t * @param {Array.<string>} missingPlugins The names of the plugins one of which has to be loaded for the particular option.\n\t\t\t */ logWarning('image-style-missing-dependency', {\n                style: option,\n                missingPlugins: modelElements.map((name)=>name === 'imageBlock' ? 'ImageBlockEditing' : 'ImageInlineEditing')\n            });\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Extends the default style with a style provided by the developer.\n * Note: Don't override the custom–defined style object, clone it instead.\n */ function extendStyle(source, style) {\n    const extendedStyle = {\n        ...style\n    };\n    for(const prop in source){\n        if (!Object.prototype.hasOwnProperty.call(style, prop)) {\n            extendedStyle[prop] = source[prop];\n        }\n    }\n    return extendedStyle;\n}\n/**\n * Displays a console warning with the 'image-style-configuration-definition-invalid' error.\n */ function warnInvalidStyle(info) {\n    /**\n\t * The image style definition provided in the configuration is invalid.\n\t *\n\t * Please make sure the definition implements properly one of the following:\n\t *\n\t * * {@link module:image/imageconfig~ImageStyleOptionDefinition image style option definition},\n\t * * {@link module:image/imageconfig~ImageStyleDropdownDefinition image style dropdown definition}\n\t *\n\t * @error image-style-configuration-definition-invalid\n\t * @param {object} info The information about the invalid definition.\n\t */ logWarning('image-style-configuration-definition-invalid', info);\n}\n/**\n * @internal\n */ const utils = {\n    normalizeStyles,\n    getDefaultStylesConfiguration,\n    getDefaultDropdownDefinitions,\n    warnInvalidStyle\n};\n\n/**\n * @module image/imagestyle/converters\n */ /**\n * Returns a converter for the `imageStyle` attribute. It can be used for adding, changing and removing the attribute.\n *\n * @param styles An array containing available image style options.\n * @returns A model-to-view attribute converter.\n * @internal\n */ function modelToViewStyleAttribute(styles) {\n    return (evt, data, conversionApi)=>{\n        if (!conversionApi.consumable.consume(data.item, evt.name)) {\n            return;\n        }\n        // Check if there is class name associated with given value.\n        const newStyle = getStyleDefinitionByName(data.attributeNewValue, styles);\n        const oldStyle = getStyleDefinitionByName(data.attributeOldValue, styles);\n        const viewElement = conversionApi.mapper.toViewElement(data.item);\n        const viewWriter = conversionApi.writer;\n        if (oldStyle) {\n            viewWriter.removeClass(oldStyle.className, viewElement);\n        }\n        if (newStyle) {\n            viewWriter.addClass(newStyle.className, viewElement);\n        }\n    };\n}\n/**\n * Returns a view-to-model converter converting image CSS classes to a proper value in the model.\n *\n * @param styles Image style options for which the converter is created.\n * @returns A view-to-model converter.\n * @internal\n */ function viewToModelStyleAttribute(styles) {\n    // Convert only non–default styles.\n    const nonDefaultStyles = {\n        imageInline: styles.filter((style)=>!style.isDefault && style.modelElements.includes('imageInline')),\n        imageBlock: styles.filter((style)=>!style.isDefault && style.modelElements.includes('imageBlock'))\n    };\n    return (evt, data, conversionApi)=>{\n        if (!data.modelRange) {\n            return;\n        }\n        const viewElement = data.viewItem;\n        const modelImageElement = first(data.modelRange.getItems());\n        // Run this converter only if an image has been found in the model.\n        // In some cases it may not be found (for example if we run this on a figure with different type than image).\n        if (!modelImageElement) {\n            return;\n        }\n        // ...and the `imageStyle` attribute is allowed for that element, otherwise stop conversion early.\n        if (!conversionApi.schema.checkAttribute(modelImageElement, 'imageStyle')) {\n            return;\n        }\n        // Convert styles one by one.\n        for (const style of nonDefaultStyles[modelImageElement.name]){\n            // Try to consume class corresponding with the style.\n            if (conversionApi.consumable.consume(viewElement, {\n                classes: style.className\n            })) {\n                // And convert this style to model attribute.\n                conversionApi.writer.setAttribute('imageStyle', style.name, modelImageElement);\n            }\n        }\n    };\n}\n/**\n * Returns the style with a given `name` from an array of styles.\n */ function getStyleDefinitionByName(name, styles) {\n    for (const style of styles){\n        if (style.name === name) {\n            return style;\n        }\n    }\n}\n\n/**\n * The image style engine plugin. It sets the default configuration, creates converters and registers\n * {@link module:image/imagestyle/imagestylecommand~ImageStyleCommand ImageStyleCommand}.\n */ class ImageStyleEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageStyleEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageUtils\n        ];\n    }\n    /**\n\t * It contains a list of the normalized and validated style options.\n\t *\n\t * * Each option contains a complete icon markup.\n\t * * The style options not supported by any of the loaded image editing plugins (\n\t * {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} or\n\t * {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`}) are filtered out.\n\t *\n\t * @internal\n\t * @readonly\n\t */ normalizedStyles;\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const editor = this.editor;\n        const isBlockPluginLoaded = editor.plugins.has('ImageBlockEditing');\n        const isInlinePluginLoaded = editor.plugins.has('ImageInlineEditing');\n        editor.config.define('image.styles', utils.getDefaultStylesConfiguration(isBlockPluginLoaded, isInlinePluginLoaded));\n        this.normalizedStyles = utils.normalizeStyles({\n            configuredStyles: editor.config.get('image.styles'),\n            isBlockPluginLoaded,\n            isInlinePluginLoaded\n        });\n        this._setupConversion(isBlockPluginLoaded, isInlinePluginLoaded);\n        this._setupPostFixer();\n        // Register imageStyle command.\n        editor.commands.add('imageStyle', new ImageStyleCommand(editor, this.normalizedStyles));\n    }\n    /**\n\t * Sets the editor conversion taking the presence of\n\t * {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`}\n\t * and {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugins into consideration.\n\t */ _setupConversion(isBlockPluginLoaded, isInlinePluginLoaded) {\n        const editor = this.editor;\n        const schema = editor.model.schema;\n        const modelToViewConverter = modelToViewStyleAttribute(this.normalizedStyles);\n        const viewToModelConverter = viewToModelStyleAttribute(this.normalizedStyles);\n        editor.editing.downcastDispatcher.on('attribute:imageStyle', modelToViewConverter);\n        editor.data.downcastDispatcher.on('attribute:imageStyle', modelToViewConverter);\n        // Allow imageStyle attribute in image and imageInline.\n        // We could call it 'style' but https://github.com/ckeditor/ckeditor5-engine/issues/559.\n        if (isBlockPluginLoaded) {\n            schema.extend('imageBlock', {\n                allowAttributes: 'imageStyle'\n            });\n            schema.setAttributeProperties('imageStyle', {\n                isFormatting: true\n            });\n            // Converter for figure element from view to model.\n            editor.data.upcastDispatcher.on('element:figure', viewToModelConverter, {\n                priority: 'low'\n            });\n        }\n        if (isInlinePluginLoaded) {\n            schema.extend('imageInline', {\n                allowAttributes: 'imageStyle'\n            });\n            schema.setAttributeProperties('imageStyle', {\n                isFormatting: true\n            });\n            // Converter for the img element from view to model.\n            editor.data.upcastDispatcher.on('element:img', viewToModelConverter, {\n                priority: 'low'\n            });\n        }\n    }\n    /**\n\t * Registers a post-fixer that will make sure that the style attribute value is correct for a specific image type (block vs inline).\n\t */ _setupPostFixer() {\n        const editor = this.editor;\n        const document = editor.model.document;\n        const imageUtils = editor.plugins.get(ImageUtils);\n        const stylesMap = new Map(this.normalizedStyles.map((style)=>[\n                style.name,\n                style\n            ]));\n        // Make sure that style attribute is valid for the image type.\n        document.registerPostFixer((writer)=>{\n            let changed = false;\n            for (const change of document.differ.getChanges()){\n                if (change.type == 'insert' || change.type == 'attribute' && change.attributeKey == 'imageStyle') {\n                    let element = change.type == 'insert' ? change.position.nodeAfter : change.range.start.nodeAfter;\n                    if (element && element.is('element', 'paragraph') && element.childCount > 0) {\n                        element = element.getChild(0);\n                    }\n                    if (!imageUtils.isImage(element)) {\n                        continue;\n                    }\n                    const imageStyle = element.getAttribute('imageStyle');\n                    if (!imageStyle) {\n                        continue;\n                    }\n                    const imageStyleDefinition = stylesMap.get(imageStyle);\n                    if (!imageStyleDefinition || !imageStyleDefinition.modelElements.includes(element.name)) {\n                        writer.removeAttribute('imageStyle', element);\n                        changed = true;\n                    }\n                }\n            }\n            return changed;\n        });\n    }\n}\n\n/**\n * The image style UI plugin.\n *\n * It registers buttons corresponding to the {@link module:image/imageconfig~ImageConfig#styles} configuration.\n * It also registers the {@link module:image/imagestyle/utils#DEFAULT_DROPDOWN_DEFINITIONS default drop-downs} and the\n * custom drop-downs defined by the developer in the {@link module:image/imageconfig~ImageConfig#toolbar} configuration.\n */ class ImageStyleUI extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageStyleEditing\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageStyleUI';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * Returns the default localized style titles provided by the plugin.\n\t *\n\t * The following localized titles corresponding with\n\t * {@link module:image/imagestyle/utils#DEFAULT_OPTIONS} are available:\n\t *\n\t * * `'Wrap text'`,\n\t * * `'Break text'`,\n\t * * `'In line'`,\n\t * * `'Full size image'`,\n\t * * `'Side image'`,\n\t * * `'Left aligned image'`,\n\t * * `'Centered image'`,\n\t * * `'Right aligned image'`\n\t */ get localizedDefaultStylesTitles() {\n        const t = this.editor.t;\n        return {\n            'Wrap text': t('Wrap text'),\n            'Break text': t('Break text'),\n            'In line': t('In line'),\n            'Full size image': t('Full size image'),\n            'Side image': t('Side image'),\n            'Left aligned image': t('Left aligned image'),\n            'Centered image': t('Centered image'),\n            'Right aligned image': t('Right aligned image')\n        };\n    }\n    /**\n\t * @inheritDoc\n\t */ init() {\n        const plugins = this.editor.plugins;\n        const toolbarConfig = this.editor.config.get('image.toolbar') || [];\n        const imageStyleEditing = plugins.get('ImageStyleEditing');\n        const definedStyles = translateStyles(imageStyleEditing.normalizedStyles, this.localizedDefaultStylesTitles);\n        for (const styleConfig of definedStyles){\n            this._createButton(styleConfig);\n        }\n        const definedDropdowns = translateStyles([\n            ...toolbarConfig.filter(isObject),\n            ...utils.getDefaultDropdownDefinitions(plugins)\n        ], this.localizedDefaultStylesTitles);\n        for (const dropdownConfig of definedDropdowns){\n            this._createDropdown(dropdownConfig, definedStyles);\n        }\n    }\n    /**\n\t * Creates a dropdown and stores it in the editor {@link module:ui/componentfactory~ComponentFactory}.\n\t */ _createDropdown(dropdownConfig, definedStyles) {\n        const factory = this.editor.ui.componentFactory;\n        factory.add(dropdownConfig.name, (locale)=>{\n            let defaultButton;\n            const { defaultItem, items, title } = dropdownConfig;\n            const buttonViews = items.filter((itemName)=>definedStyles.find(({ name })=>getUIComponentName(name) === itemName)).map((buttonName)=>{\n                const button = factory.create(buttonName);\n                if (buttonName === defaultItem) {\n                    defaultButton = button;\n                }\n                return button;\n            });\n            if (items.length !== buttonViews.length) {\n                utils.warnInvalidStyle({\n                    dropdown: dropdownConfig\n                });\n            }\n            const dropdownView = createDropdown(locale, SplitButtonView);\n            const splitButtonView = dropdownView.buttonView;\n            const splitButtonViewArrow = splitButtonView.arrowView;\n            addToolbarToDropdown(dropdownView, buttonViews, {\n                enableActiveItemFocusOnDropdownOpen: true\n            });\n            splitButtonView.set({\n                label: getDropdownButtonTitle(title, defaultButton.label),\n                class: null,\n                tooltip: true\n            });\n            splitButtonViewArrow.unbind('label');\n            splitButtonViewArrow.set({\n                label: title\n            });\n            splitButtonView.bind('icon').toMany(buttonViews, 'isOn', (...areOn)=>{\n                const index = areOn.findIndex(identity);\n                return index < 0 ? defaultButton.icon : buttonViews[index].icon;\n            });\n            splitButtonView.bind('label').toMany(buttonViews, 'isOn', (...areOn)=>{\n                const index = areOn.findIndex(identity);\n                return getDropdownButtonTitle(title, index < 0 ? defaultButton.label : buttonViews[index].label);\n            });\n            splitButtonView.bind('isOn').toMany(buttonViews, 'isOn', (...areOn)=>areOn.some(identity));\n            splitButtonView.bind('class').toMany(buttonViews, 'isOn', (...areOn)=>areOn.some(identity) ? 'ck-splitbutton_flatten' : undefined);\n            splitButtonView.on('execute', ()=>{\n                if (!buttonViews.some(({ isOn })=>isOn)) {\n                    defaultButton.fire('execute');\n                } else {\n                    dropdownView.isOpen = !dropdownView.isOpen;\n                }\n            });\n            dropdownView.bind('isEnabled').toMany(buttonViews, 'isEnabled', (...areEnabled)=>areEnabled.some(identity));\n            // Focus the editable after executing the command.\n            // Overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n            this.listenTo(dropdownView, 'execute', ()=>{\n                this.editor.editing.view.focus();\n            });\n            return dropdownView;\n        });\n    }\n    /**\n\t * Creates a button and stores it in the editor {@link module:ui/componentfactory~ComponentFactory}.\n\t */ _createButton(buttonConfig) {\n        const buttonName = buttonConfig.name;\n        this.editor.ui.componentFactory.add(getUIComponentName(buttonName), (locale)=>{\n            const command = this.editor.commands.get('imageStyle');\n            const view = new ButtonView(locale);\n            view.set({\n                label: buttonConfig.title,\n                icon: buttonConfig.icon,\n                tooltip: true,\n                isToggleable: true\n            });\n            view.bind('isEnabled').to(command, 'isEnabled');\n            view.bind('isOn').to(command, 'value', (value)=>value === buttonName);\n            view.on('execute', this._executeCommand.bind(this, buttonName));\n            return view;\n        });\n    }\n    _executeCommand(name) {\n        this.editor.execute('imageStyle', {\n            value: name\n        });\n        this.editor.editing.view.focus();\n    }\n}\n/**\n * Returns the translated `title` from the passed styles array.\n */ function translateStyles(styles, titles) {\n    for (const style of styles){\n        // Localize the titles of the styles, if a title corresponds with\n        // a localized default provided by the plugin.\n        if (titles[style.title]) {\n            style.title = titles[style.title];\n        }\n    }\n    return styles;\n}\n/**\n * Returns the image style component name with the \"imageStyle:\" prefix.\n */ function getUIComponentName(name) {\n    return `imageStyle:${name}`;\n}\n/**\n * Returns title for the splitbutton containing the dropdown title and default action item title.\n */ function getDropdownButtonTitle(dropdownTitle, buttonTitle) {\n    return (dropdownTitle ? dropdownTitle + ': ' : '') + buttonTitle;\n}\n\n/**\n * The image style plugin.\n *\n * For a detailed overview of the image styles feature, check the {@glink features/images/images-styles documentation}.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n * * {@link module:image/imagestyle/imagestyleediting~ImageStyleEditing},\n * * {@link module:image/imagestyle/imagestyleui~ImageStyleUI}\n *\n * It provides a default configuration, which can be extended or overwritten.\n * Read more about the {@link module:image/imageconfig~ImageConfig#styles image styles configuration}.\n */ class ImageStyle extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageStyleEditing,\n            ImageStyleUI\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageStyle';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n}\n\n/**\n * The image toolbar plugin. It creates and manages the image toolbar (the toolbar displayed when an image is selected).\n *\n * For an overview, check the {@glink features/images/images-overview#image-contextual-toolbar image contextual toolbar} documentation.\n *\n * Instances of toolbar components (e.g. buttons) are created using the editor's\n * {@link module:ui/componentfactory~ComponentFactory component factory}\n * based on the {@link module:image/imageconfig~ImageConfig#toolbar `image.toolbar` configuration option}.\n *\n * The toolbar uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */ class ImageToolbar extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            WidgetToolbarRepository,\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'ImageToolbar';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        const editor = this.editor;\n        const t = editor.t;\n        const widgetToolbarRepository = editor.plugins.get(WidgetToolbarRepository);\n        const imageUtils = editor.plugins.get('ImageUtils');\n        widgetToolbarRepository.register('image', {\n            ariaLabel: t('Image toolbar'),\n            items: normalizeDeclarativeConfig(editor.config.get('image.toolbar') || []),\n            getRelatedElement: (selection)=>imageUtils.getClosestSelectedImageWidget(selection)\n        });\n    }\n}\n/**\n * Convert the dropdown definitions to their keys registered in the ComponentFactory.\n * The registration precess should be handled by the plugin which handles the UI of a particular feature.\n */ function normalizeDeclarativeConfig(config) {\n    return config.map((item)=>isObject(item) ? item.name : item);\n}\n\n/**\n * This plugin enables the [`<picture>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture) element support in the editor.\n *\n * * It enables the `sources` model attribute on `imageBlock` and `imageInline` model elements\n * (brought by {@link module:image/imageblock~ImageBlock} and {@link module:image/imageinline~ImageInline}, respectively).\n * * It translates the `sources` model element to the view (also: data) structure that may look as follows:\n *\n * ```html\n * <p>Inline image using picture:\n * \t<picture>\n * \t\t<source media=\"(min-width: 800px)\" srcset=\"image-large.webp\" type=\"image/webp\">\n * \t\t<source media=\"(max-width: 800px)\" srcset=\"image-small.webp\" type=\"image/webp\">\n * \t\t<!-- Other sources as specified in the \"sources\" model attribute... -->\n * \t\t<img src=\"image.png\" alt=\"An image using picture\" />\n * \t</picture>\n * </p>\n *\n * <p>Block image using picture:</p>\n * <figure class=\"image\">\n * \t<picture>\n * \t\t<source media=\"(min-width: 800px)\" srcset=\"image-large.webp\" type=\"image/webp\">\n * \t\t<source media=\"(max-width: 800px)\" srcset=\"image-small.webp\" type=\"image/webp\">\n * \t\t<!-- Other sources as specified in the \"sources\" model attribute... -->\n * \t\t<img src=\"image.png\" alt=\"An image using picture\" />\n * \t</picture>\n * \t<figcaption>Caption of the image</figcaption>\n * </figure>\n * ```\n *\n * **Note:** The value of the `sources` {@glink framework/architecture/editing-engine#changing-the-model model attribute}\n * in both examples equals:\n *\n * ```css\n * [\n * \t{\n * \t\tmedia: '(min-width: 800px)',\n * \t\tsrcset: 'image-large.webp',\n * \t\ttype: 'image/webp'\n * \t},\n * \t{\n * \t\tmedia: '(max-width: 800px)',\n * \t\tsrcset: 'image-small.webp',\n * \t\ttype: 'image/webp'\n * \t}\n * ]\n * ```\n *\n * * It integrates with the {@link module:image/imageupload~ImageUpload} plugin so images uploaded in the editor\n * automatically render using `<picture>` if the {@glink features/images/image-upload/image-upload upload adapter}\n * supports image sources and provides neccessary data.\n *\n * @private\n */ class PictureEditing extends Plugin {\n    /**\n\t * @inheritDoc\n\t */ static get requires() {\n        return [\n            ImageEditing,\n            ImageUtils\n        ];\n    }\n    /**\n\t * @inheritDoc\n\t */ static get pluginName() {\n        return 'PictureEditing';\n    }\n    /**\n\t * @inheritDoc\n\t */ static get isOfficialPlugin() {\n        return true;\n    }\n    /**\n\t * @inheritDoc\n\t */ afterInit() {\n        const editor = this.editor;\n        if (editor.plugins.has('ImageBlockEditing')) {\n            editor.model.schema.extend('imageBlock', {\n                allowAttributes: [\n                    'sources'\n                ]\n            });\n        }\n        if (editor.plugins.has('ImageInlineEditing')) {\n            editor.model.schema.extend('imageInline', {\n                allowAttributes: [\n                    'sources'\n                ]\n            });\n        }\n        this._setupConversion();\n        this._setupImageUploadEditingIntegration();\n    }\n    /**\n\t * Configures conversion pipelines to support upcasting and downcasting images using the `<picture>` view element\n\t * and the model `sources` attribute.\n\t */ _setupConversion() {\n        const editor = this.editor;\n        const conversion = editor.conversion;\n        const imageUtils = editor.plugins.get('ImageUtils');\n        conversion.for('upcast').add(upcastPicture(imageUtils));\n        conversion.for('downcast').add(downcastSourcesAttribute(imageUtils));\n    }\n    /**\n\t * Makes it possible for uploaded images to get the `sources` model attribute and the `<picture>...</picture>`\n\t * view structure out-of-the-box if relevant data is provided along the\n\t * {@link module:image/imageupload/imageuploadediting~ImageUploadEditing#event:uploadComplete} event.\n\t */ _setupImageUploadEditingIntegration() {\n        const editor = this.editor;\n        if (!editor.plugins.has('ImageUploadEditing')) {\n            return;\n        }\n        const imageUploadEditing = editor.plugins.get('ImageUploadEditing');\n        this.listenTo(imageUploadEditing, 'uploadComplete', (evt, { imageElement, data })=>{\n            const sources = data.sources;\n            if (!sources) {\n                return;\n            }\n            editor.model.change((writer)=>{\n                writer.setAttributes({\n                    sources\n                }, imageElement);\n            });\n        });\n    }\n}\n\nexport { AutoImage, Image, ImageBlock, ImageBlockEditing, ImageCaption, ImageCaptionEditing, ImageCaptionUI, ImageCaptionUtils, ImageCustomResizeUI, ImageEditing, ImageInline, ImageInlineEditing, ImageInsert, ImageInsertUI, ImageInsertViaUrl, ImageInsertViaUrlUI, ImageLoadObserver, ImagePlaceholder, ImageResize, ImageResizeButtons, ImageResizeEditing, ImageResizeHandles, ImageSizeAttributes, ImageStyle, ImageStyleCommand, ImageStyleEditing, ImageStyleUI, ImageTextAlternative, ImageTextAlternativeCommand, ImageTextAlternativeEditing, ImageTextAlternativeUI, ImageToolbar, ImageTypeCommand, ImageUpload, ImageUploadEditing, ImageUploadProgress, ImageUploadUI, ImageUtils, InsertImageCommand, PictureEditing, ReplaceImageSourceCommand, ResizeImageCommand, ToggleImageCaptionCommand, UploadImageCommand, DEFAULT_DROPDOWN_DEFINITIONS as _IMAGE_DEFAULT_DROPDOWN_DEFINITIONS, DEFAULT_ICONS as _IMAGE_DEFAULT_ICONS, DEFAULT_OPTIONS as _IMAGE_DEFAULT_OPTIONS, ImageCustomResizeFormView as _ImageCustomResizeFormView, ImageInsertFormView as _ImageInsertFormView, ImageInsertUrlView as _ImageInsertUrlView, utils as _ImageStyleUtils, TextAlternativeFormView as _ImageTextAlternativeFormView, widthAndHeightStylesAreBothSet as _checkIfImageWidthAndHeightStylesAreBothSet, createBlockImageViewElement as _createBlockImageViewElement, createInlineImageViewElement as _createInlineImageViewElement, determineImageTypeForInsertionAtSelection as _determineImageTypeForInsertionAtSelection, downcastImageAttribute as _downcastImageAttribute, downcastSourcesAttribute as _downcastImageSourcesAttribute, downcastSrcsetAttribute as _downcastImageSrcsetAttribute, fetchLocalImage as _fetchLocalImage, getBalloonPositionData as _getImageBalloonPositionData, getSizeValueIfInPx as _getImageSizeValueIfInPx, getImgViewElementMatcher as _getImageViewElementMatcher, getSelectedImageEditorNodes as _getSelectedImageEditorNodes, getSelectedImagePossibleResizeRange as _getSelectedImagePossibleResizeRange, getSelectedImageWidthInUnits as _getSelectedImageWidthInUnits, isLocalImage as _isLocalImage, modelToViewStyleAttribute as _modelToViewImageStyleAttribute, repositionContextualBalloon as _repositionImageContextualBalloon, tryCastDimensionsToUnit as _tryCastImageDimensionsToUnit, tryParseDimensionWithUnit as _tryParseImageDimensionWithUnit, upcastImageFigure as _upcastImageFigure, upcastPicture as _upcastImagePicture, viewToModelStyleAttribute as _viewToModelImageStyleAttribute, createImageTypeRegExp, isHtmlInDataTransfer };\n//# sourceMappingURL=index.js.map\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/utils\n */\n\nimport type {\n\tModelDocumentSelection,\n\tMatcherPattern,\n\tModelSchema,\n\tModelSelection,\n\tViewContainerElement,\n\tViewDowncastWriter,\n\tViewElement\n} from 'ckeditor5/src/engine.js';\nimport type { Editor } from 'ckeditor5/src/core.js';\nimport { first } from 'ckeditor5/src/utils.js';\n\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * Creates a view element representing the inline image.\n *\n * ```html\n * <span class=\"image-inline\"><img></img></span>\n * ```\n *\n * Note that `alt` and `src` attributes are converted separately, so they are not included.\n *\n * @internal\n */\nexport function createInlineImageViewElement( writer: ViewDowncastWriter ): ViewContainerElement {\n\treturn writer.createContainerElement( 'span', { class: 'image-inline' },\n\t\twriter.createEmptyElement( 'img' )\n\t);\n}\n\n/**\n * Creates a view element representing the block image.\n *\n * ```html\n * <figure class=\"image\"><img></img></figure>\n * ```\n *\n * Note that `alt` and `src` attributes are converted separately, so they are not included.\n *\n * @internal\n */\nexport function createBlockImageViewElement( writer: ViewDowncastWriter ): ViewContainerElement {\n\treturn writer.createContainerElement( 'figure', { class: 'image' }, [\n\t\twriter.createEmptyElement( 'img' ),\n\t\twriter.createSlot( 'children' )\n\t] );\n}\n\n/**\n * A function returning a `MatcherPattern` for a particular type of View images.\n *\n * @internal\n * @param matchImageType The type of created image.\n */\nexport function getImgViewElementMatcher( editor: Editor, matchImageType: 'imageBlock' | 'imageInline' ): MatcherPattern {\n\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\tconst areBothImagePluginsLoaded = editor.plugins.has( 'ImageInlineEditing' ) && editor.plugins.has( 'ImageBlockEditing' );\n\n\treturn element => {\n\t\t// Check if the matched view element is an <img>.\n\t\tif ( !imageUtils.isInlineImageView( element ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// If just one of the plugins is loaded (block or inline), it will match all kinds of images.\n\t\tif ( !areBothImagePluginsLoaded ) {\n\t\t\treturn getPositiveMatchPattern( element );\n\t\t}\n\n\t\t// The <img> can be standalone, wrapped in <figure>...</figure> (ImageBlock plugin) or\n\t\t// wrapped in <figure><a>...</a></figure> (LinkImage plugin).\n\t\tconst imageType = element.getStyle( 'display' ) == 'block' || element.findAncestor( imageUtils.isBlockImageView ) ?\n\t\t\t'imageBlock' :\n\t\t\t'imageInline';\n\n\t\tif ( imageType !== matchImageType ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn getPositiveMatchPattern( element );\n\t};\n\n\tfunction getPositiveMatchPattern( element: ViewElement ) {\n\t\tconst pattern: Record<string, unknown> = {\n\t\t\tname: true\n\t\t};\n\n\t\t// This will trigger src consumption (See https://github.com/ckeditor/ckeditor5/issues/11530).\n\t\tif ( element.hasAttribute( 'src' ) ) {\n\t\t\tpattern.attributes = [ 'src' ];\n\t\t}\n\n\t\treturn pattern;\n\t}\n}\n\n/**\n * Considering the current model selection, it returns the name of the model image element\n * (`'imageBlock'` or `'imageInline'`) that will make most sense from the UX perspective if a new\n * image was inserted (also: uploaded, dropped, pasted) at that selection.\n *\n * The assumption is that inserting images into empty blocks or on other block widgets should\n * produce block images. Inline images should be inserted in other cases, e.g. in paragraphs\n * that already contain some text.\n *\n * @internal\n */\nexport function determineImageTypeForInsertionAtSelection(\n\tschema: ModelSchema,\n\tselection: ModelSelection | ModelDocumentSelection\n): 'imageBlock' | 'imageInline' {\n\tconst firstBlock = first( selection.getSelectedBlocks() );\n\n\t// Insert a block image if the selection is not in/on block elements or it's on a block widget.\n\tif ( !firstBlock || schema.isObject( firstBlock ) ) {\n\t\treturn 'imageBlock';\n\t}\n\n\t// A block image should also be inserted into an empty block element\n\t// (that is not an empty list item so the list won't get split).\n\tif ( firstBlock.isEmpty && firstBlock.name != 'listItem' ) {\n\t\treturn 'imageBlock';\n\t}\n\n\t// Otherwise insert an inline image.\n\treturn 'imageInline';\n}\n\n/**\n * Returns parsed value of the size, but only if it contains unit: px.\n *\n * @internal\n */\nexport function getSizeValueIfInPx( size: string | undefined ): number | null {\n\tif ( size && size.endsWith( 'px' ) ) {\n\t\treturn parseInt( size );\n\t}\n\n\treturn null;\n}\n\n/**\n * Returns true if both styles (width and height) are set.\n *\n * If both image styles: width & height are set, they will override the image width & height attributes in the\n * browser. In this case, the image looks the same as if these styles were applied to attributes instead of styles.\n * That's why we can upcast these styles to width & height attributes instead of resizedWidth and resizedHeight.\n *\n * @internal\n */\nexport function widthAndHeightStylesAreBothSet( viewElement: ViewElement ): boolean {\n\tconst widthStyle = getSizeValueIfInPx( viewElement.getStyle( 'width' ) );\n\tconst heightStyle = getSizeValueIfInPx( viewElement.getStyle( 'height' ) );\n\n\treturn !!( widthStyle && heightStyle );\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageutils\n */\n\nimport type {\n\tModelElement,\n\tViewElement,\n\tViewNode,\n\tModelDocumentSelection,\n\tViewDocumentSelection,\n\tModelSelection,\n\tViewSelection,\n\tModelDocumentFragment,\n\tViewDocumentFragment,\n\tViewDowncastWriter,\n\tModel,\n\tModelPosition,\n\tViewContainerElement\n} from 'ckeditor5/src/engine.js';\nimport { Plugin, type Editor } from 'ckeditor5/src/core.js';\nimport { findOptimalInsertionRange, isWidget, toWidget } from 'ckeditor5/src/widget.js';\nimport { determineImageTypeForInsertionAtSelection } from './image/utils.js';\nimport { DomEmitterMixin, type DomEmitter, global } from 'ckeditor5/src/utils.js';\n\nconst IMAGE_WIDGETS_CLASSES_MATCH_REGEXP = /^(image|image-inline)$/;\n\n/**\n * A set of helpers related to images.\n */\nexport class ImageUtils extends Plugin {\n\t/**\n\t * DOM Emitter.\n\t */\n\tprivate _domEmitter: DomEmitter = new ( DomEmitterMixin() )();\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageUtils' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Checks if the provided model element is an `image` or `imageInline`.\n\t */\n\tpublic isImage( modelElement?: ModelElement | null ): modelElement is ModelElement & { name: 'imageInline' | 'imageBlock' } {\n\t\treturn this.isInlineImage( modelElement ) || this.isBlockImage( modelElement );\n\t}\n\n\t/**\n\t * Checks if the provided view element represents an inline image.\n\t *\n\t * Also, see {@link module:image/imageutils~ImageUtils#isImageWidget}.\n\t */\n\tpublic isInlineImageView( element?: ViewElement | null ): boolean {\n\t\treturn !!element && element.is( 'element', 'img' );\n\t}\n\n\t/**\n\t * Checks if the provided view element represents a block image.\n\t *\n\t * Also, see {@link module:image/imageutils~ImageUtils#isImageWidget}.\n\t */\n\tpublic isBlockImageView( element?: ViewElement | null ): boolean {\n\t\treturn !!element && element.is( 'element', 'figure' ) && element.hasClass( 'image' );\n\t}\n\n\t/**\n\t * Handles inserting single file. This method unifies image insertion using {@link module:widget/utils~findOptimalInsertionRange}\n\t * method.\n\t *\n\t * ```ts\n\t * const imageUtils = editor.plugins.get( 'ImageUtils' );\n\t *\n\t * imageUtils.insertImage( { src: 'path/to/image.jpg' } );\n\t * ```\n\t *\n\t * @param attributes Attributes of the inserted image.\n\t * This method filters out the attributes which are disallowed by the {@link module:engine/model/schema~ModelSchema}.\n\t * @param selectable Place to insert the image. If not specified,\n\t * the {@link module:widget/utils~findOptimalInsertionRange} logic will be applied for the block images\n\t * and `model.document.selection` for the inline images.\n\t *\n\t * **Note**: If `selectable` is passed, this helper will not be able to set selection attributes (such as `linkHref`)\n\t * and apply them to the new image. In this case, make sure all selection attributes are passed in `attributes`.\n\t *\n\t * @param imageType Image type of inserted image. If not specified,\n\t * it will be determined automatically depending of editor config or place of the insertion.\n\t * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n\t * The default is `true`.\n\t * @return The inserted model image element.\n\t */\n\tpublic insertImage(\n\t\tattributes: Record<string, unknown> = {},\n\t\tselectable: ModelSelection | ModelPosition | null = null,\n\t\timageType: ( 'imageBlock' | 'imageInline' | null ) = null,\n\t\toptions: { setImageSizes?: boolean } = {}\n\t): ModelElement | null {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst selection = model.document.selection;\n\n\t\tconst determinedImageType = determineImageTypeForInsertion( editor, selectable || selection, imageType );\n\n\t\t// Mix declarative attributes with selection attributes because the new image should \"inherit\"\n\t\t// the latter for best UX. For instance, inline images inserted into existing links\n\t\t// should not split them. To do that, they need to have \"linkHref\" inherited from the selection.\n\t\tattributes = {\n\t\t\t...Object.fromEntries( selection.getAttributes() ),\n\t\t\t...attributes\n\t\t};\n\n\t\tfor ( const attributeName in attributes ) {\n\t\t\tif ( !model.schema.checkAttribute( determinedImageType, attributeName ) ) {\n\t\t\t\tdelete attributes[ attributeName ];\n\t\t\t}\n\t\t}\n\n\t\treturn model.change( writer => {\n\t\t\tconst { setImageSizes = true } = options;\n\t\t\tconst imageElement = writer.createElement( determinedImageType, attributes );\n\n\t\t\tmodel.insertObject( imageElement, selectable, null, {\n\t\t\t\tsetSelection: 'on',\n\t\t\t\t// If we want to insert a block image (for whatever reason) then we don't want to split text blocks.\n\t\t\t\t// This applies only when we don't have the selectable specified (i.e., we insert multiple block images at once).\n\t\t\t\tfindOptimalPosition: !selectable && determinedImageType != 'imageInline' ? 'auto' : undefined\n\t\t\t} );\n\n\t\t\t// Inserting an image might've failed due to schema regulations.\n\t\t\tif ( imageElement.parent ) {\n\t\t\t\tif ( setImageSizes ) {\n\t\t\t\t\tthis.setImageNaturalSizeAttributes( imageElement );\n\t\t\t\t}\n\n\t\t\t\treturn imageElement;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t} );\n\t}\n\n\t/**\n\t * Reads original image sizes and sets them as `width` and `height`.\n\t *\n\t * The `src` attribute may not be available if the user is using an upload adapter. In such a case,\n\t * this method is called again after the upload process is complete and the `src` attribute is available.\n\t */\n\tpublic setImageNaturalSizeAttributes( imageElement: ModelElement ): void {\n\t\tconst src = imageElement.getAttribute( 'src' ) as string;\n\n\t\tif ( !src ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( imageElement.getAttribute( 'width' ) || imageElement.getAttribute( 'height' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.editor.model.change( writer => {\n\t\t\tconst img = new global.window.Image();\n\n\t\t\tthis._domEmitter.listenTo( img, 'load', () => {\n\t\t\t\tif ( !imageElement.getAttribute( 'width' ) && !imageElement.getAttribute( 'height' ) ) {\n\t\t\t\t\t// We use writer.batch to be able to undo (in a single step) width and height setting\n\t\t\t\t\t// along with any change that triggered this action (e.g. image resize or image style change).\n\t\t\t\t\tthis.editor.model.enqueueChange( writer.batch, writer => {\n\t\t\t\t\t\twriter.setAttribute( 'width', img.naturalWidth, imageElement );\n\t\t\t\t\t\twriter.setAttribute( 'height', img.naturalHeight, imageElement );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tthis._domEmitter.stopListening( img, 'load' );\n\t\t\t} );\n\n\t\t\timg.src = src;\n\t\t} );\n\t}\n\n\t/**\n\t * Returns an image widget editing view element if one is selected or is among the selection's ancestors.\n\t */\n\tpublic getClosestSelectedImageWidget( selection: ViewSelection | ViewDocumentSelection ): ViewElement | null {\n\t\tconst selectionPosition = selection.getFirstPosition();\n\n\t\tif ( !selectionPosition ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst viewElement = selection.getSelectedElement();\n\n\t\tif ( viewElement && this.isImageWidget( viewElement ) ) {\n\t\t\treturn viewElement;\n\t\t}\n\n\t\tlet parent: ViewNode | ViewDocumentFragment | null = selectionPosition.parent;\n\n\t\twhile ( parent ) {\n\t\t\tif ( parent.is( 'element' ) && this.isImageWidget( parent ) ) {\n\t\t\t\treturn parent;\n\t\t\t}\n\n\t\t\tparent = parent.parent;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns a image model element if one is selected or is among the selection's ancestors.\n\t */\n\tpublic getClosestSelectedImageElement( selection: ModelSelection | ModelDocumentSelection ): ModelElement | null {\n\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\treturn this.isImage( selectedElement ) ? selectedElement : selection.getFirstPosition()!.findAncestor( 'imageBlock' );\n\t}\n\n\t/**\n\t * Returns an image widget editing view based on the passed image view.\n\t */\n\tpublic getImageWidgetFromImageView( imageView: ViewElement ): ViewContainerElement | null {\n\t\treturn imageView.findAncestor( { classes: IMAGE_WIDGETS_CLASSES_MATCH_REGEXP } ) as ( ViewContainerElement | null );\n\t}\n\n\t/**\n\t * Checks if image can be inserted at current model selection.\n\t *\n\t * @internal\n\t */\n\tpublic isImageAllowed(): boolean {\n\t\tconst model = this.editor.model;\n\t\tconst selection = model.document.selection;\n\n\t\treturn isImageAllowedInParent( this.editor, selection ) && isNotInsideImage( selection );\n\t}\n\n\t/**\n\t * Converts a given {@link module:engine/view/element~ViewElement} to an image widget:\n\t * * Adds a {@link module:engine/view/element~ViewElement#_setCustomProperty custom property} allowing to recognize the image widget\n\t * element.\n\t * * Calls the {@link module:widget/utils~toWidget} function with the proper element's label creator.\n\t *\n\t * @param writer An instance of the view writer.\n\t * @param label The element's label. It will be concatenated with the image `alt` attribute if one is present.\n\t */\n\tpublic toImageWidget( viewElement: ViewElement, writer: ViewDowncastWriter, label: string ): ViewElement {\n\t\twriter.setCustomProperty( 'image', true, viewElement );\n\n\t\tconst labelCreator = () => {\n\t\t\tconst imgElement = this.findViewImgElement( viewElement )!;\n\t\t\tconst altText = imgElement.getAttribute( 'alt' );\n\n\t\t\treturn altText ? `${ altText } ${ label }` : label;\n\t\t};\n\n\t\treturn toWidget( viewElement, writer, { label: labelCreator } );\n\t}\n\n\t/**\n\t * Checks if a given view element is an image widget.\n\t */\n\tprotected isImageWidget( viewElement: ViewElement ): boolean {\n\t\treturn !!viewElement.getCustomProperty( 'image' ) && isWidget( viewElement );\n\t}\n\n\t/**\n\t * Checks if the provided model element is an `image`.\n\t */\n\tpublic isBlockImage( modelElement?: ModelElement | null ): boolean {\n\t\treturn !!modelElement && modelElement.is( 'element', 'imageBlock' );\n\t}\n\n\t/**\n\t * Checks if the provided model element is an `imageInline`.\n\t */\n\tpublic isInlineImage( modelElement?: ModelElement | null ): boolean {\n\t\treturn !!modelElement && modelElement.is( 'element', 'imageInline' );\n\t}\n\n\t/**\n\t * Get the view `<img>` from another view element, e.g. a widget (`<figure class=\"image\">`), a link (`<a>`).\n\t *\n\t * The `<img>` can be located deep in other elements, so this helper performs a deep tree search.\n\t */\n\tpublic findViewImgElement( figureView: ViewElement ): ViewElement | undefined {\n\t\tif ( this.isInlineImageView( figureView ) ) {\n\t\t\treturn figureView;\n\t\t}\n\n\t\tconst editingView = this.editor.editing.view;\n\n\t\tfor ( const { item } of editingView.createRangeIn( figureView ) ) {\n\t\t\tif ( this.isInlineImageView( item as ViewElement ) ) {\n\t\t\t\treturn item as ViewElement;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tthis._domEmitter.stopListening();\n\n\t\treturn super.destroy();\n\t}\n}\n\n/**\n * Checks if image is allowed by schema in optimal insertion parent.\n */\nfunction isImageAllowedInParent( editor: Editor, selection: ModelSelection | ModelDocumentSelection ): boolean {\n\tconst imageType = determineImageTypeForInsertion( editor, selection, null );\n\n\tif ( imageType == 'imageBlock' ) {\n\t\tconst parent = getInsertImageParent( selection, editor.model );\n\n\t\tif ( editor.model.schema.checkChild( parent as ModelElement, 'imageBlock' ) ) {\n\t\t\treturn true;\n\t\t}\n\t} else if ( editor.model.schema.checkChild( selection.focus!, 'imageInline' ) ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n/**\n * Checks if selection is not placed inside an image (e.g. its caption).\n */\nfunction isNotInsideImage( selection: ModelDocumentSelection ): boolean {\n\treturn [ ...selection.focus!.getAncestors() ].every( ancestor => !ancestor.is( 'element', 'imageBlock' ) );\n}\n\n/**\n * Returns a node that will be used to insert image with `model.insertContent`.\n */\nfunction getInsertImageParent( selection: ModelSelection | ModelDocumentSelection, model: Model ): ModelElement | ModelDocumentFragment {\n\tconst insertionRange = findOptimalInsertionRange( selection, model );\n\tconst parent = insertionRange.start.parent;\n\n\tif ( parent.isEmpty && !parent.is( 'element', '$root' ) ) {\n\t\treturn parent.parent!;\n\t}\n\n\treturn parent;\n}\n\n/**\n * Determine image element type name depending on editor config or place of insertion.\n *\n * @param imageType Image element type name. Used to force return of provided element name,\n * but only if there is proper plugin enabled.\n */\nfunction determineImageTypeForInsertion(\n\teditor: Editor,\n\tselectable: ModelPosition | ModelSelection | ModelDocumentSelection,\n\timageType: 'imageBlock' | 'imageInline' | null\n): 'imageBlock' | 'imageInline' {\n\tconst schema = editor.model.schema;\n\tconst configImageInsertType = editor.config.get( 'image.insert.type' );\n\n\tif ( !editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\treturn 'imageInline';\n\t}\n\n\tif ( !editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\treturn 'imageBlock';\n\t}\n\n\tif ( imageType ) {\n\t\treturn imageType;\n\t}\n\n\tif ( configImageInsertType === 'inline' ) {\n\t\treturn 'imageInline';\n\t}\n\n\tif ( configImageInsertType !== 'auto' ) {\n\t\treturn 'imageBlock';\n\t}\n\n\t// Try to replace the selected widget (e.g. another image).\n\tif ( selectable.is( 'selection' ) ) {\n\t\treturn determineImageTypeForInsertionAtSelection( schema, selectable );\n\t}\n\n\treturn schema.checkChild( selectable, 'imageInline' ) ? 'imageInline' : 'imageBlock';\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/autoimage\n */\n\nimport { Plugin, type Editor } from 'ckeditor5/src/core.js';\nimport { Clipboard, type ClipboardPipeline } from 'ckeditor5/src/clipboard.js';\nimport { ModelLivePosition, ModelLiveRange } from 'ckeditor5/src/engine.js';\nimport { Undo } from 'ckeditor5/src/undo.js';\nimport { Delete } from 'ckeditor5/src/typing.js';\nimport { global } from 'ckeditor5/src/utils.js';\n\nimport { ImageUtils } from './imageutils.js';\n\n// Implements the pattern: http(s)://(www.)example.com/path/to/resource.ext?query=params&maybe=too.\nconst IMAGE_URL_REGEXP = new RegExp( String( /^(http(s)?:\\/\\/)?[\\w-]+\\.[\\w.~:/[\\]@!$&'()*+,;=%-]+/.source +\n\t/\\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source +\n\t/(\\?[\\w.~:/[\\]@!$&'()*+,;=%-]*)?/.source +\n\t/(#[\\w.~:/[\\]@!$&'()*+,;=%-]*)?$/.source ) );\n\n/**\n * The auto-image plugin. It recognizes image links in the pasted content and embeds\n * them shortly after they are injected into the document.\n */\nexport class AutoImage extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ Clipboard, ImageUtils, Undo, Delete ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'AutoImage' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * The paste–to–embed `setTimeout` ID. Stored as a property to allow\n\t * cleaning of the timeout.\n\t */\n\tprivate _timeoutId: ReturnType<typeof setTimeout> | null;\n\n\t/**\n\t * The position where the `<imageBlock>` element will be inserted after the timeout,\n\t * determined each time a new content is pasted into the document.\n\t */\n\tprivate _positionToInsert: ModelLivePosition | null;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tthis._timeoutId = null;\n\n\t\tthis._positionToInsert = null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst modelDocument = editor.model.document;\n\t\tconst clipboardPipeline: ClipboardPipeline = editor.plugins.get( 'ClipboardPipeline' );\n\n\t\t// We need to listen on `Clipboard#inputTransformation` because we need to save positions of selection.\n\t\t// After pasting, the content between those positions will be checked for a URL that could be transformed\n\t\t// into an image.\n\t\tthis.listenTo( clipboardPipeline, 'inputTransformation', () => {\n\t\t\tconst firstRange = modelDocument.selection.getFirstRange()!;\n\n\t\t\tconst leftLivePosition = ModelLivePosition.fromPosition( firstRange.start );\n\t\t\tleftLivePosition.stickiness = 'toPrevious';\n\n\t\t\tconst rightLivePosition = ModelLivePosition.fromPosition( firstRange.end );\n\t\t\trightLivePosition.stickiness = 'toNext';\n\n\t\t\tmodelDocument.once( 'change:data', () => {\n\t\t\t\tthis._embedImageBetweenPositions( leftLivePosition, rightLivePosition );\n\n\t\t\t\tleftLivePosition.detach();\n\t\t\t\trightLivePosition.detach();\n\t\t\t}, { priority: 'high' } );\n\t\t} );\n\n\t\teditor.commands.get( 'undo' )!.on( 'execute', () => {\n\t\t\tif ( this._timeoutId ) {\n\t\t\t\tglobal.window.clearTimeout( this._timeoutId );\n\t\t\t\tthis._positionToInsert!.detach();\n\n\t\t\t\tthis._timeoutId = null;\n\t\t\t\tthis._positionToInsert = null;\n\t\t\t}\n\t\t}, { priority: 'high' } );\n\t}\n\n\t/**\n\t * Analyzes the part of the document between provided positions in search for a URL representing an image.\n\t * When the URL is found, it is automatically converted into an image.\n\t *\n\t * @param leftPosition Left position of the selection.\n\t * @param rightPosition Right position of the selection.\n\t */\n\tprivate _embedImageBetweenPositions( leftPosition: ModelLivePosition, rightPosition: ModelLivePosition ): void {\n\t\tconst editor = this.editor;\n\t\t// TODO: Use a marker instead of ModelLiveRange & LivePositions.\n\t\tconst urlRange = new ModelLiveRange( leftPosition, rightPosition );\n\t\tconst walker = urlRange.getWalker( { ignoreElementEnd: true } );\n\t\tconst selectionAttributes = Object.fromEntries( editor.model.document.selection.getAttributes() );\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\tlet src = '';\n\n\t\tfor ( const node of walker ) {\n\t\t\tif ( node.item.is( '$textProxy' ) ) {\n\t\t\t\tsrc += node.item.data;\n\t\t\t}\n\t\t}\n\n\t\tsrc = src.trim();\n\n\t\t// If the URL does not match the image URL regexp, let's skip that.\n\t\tif ( !src.match( IMAGE_URL_REGEXP ) ) {\n\t\t\turlRange.detach();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Position will not be available in the `setTimeout` function so let's clone it.\n\t\tthis._positionToInsert = ModelLivePosition.fromPosition( leftPosition );\n\n\t\t// This action mustn't be executed if undo was called between pasting and auto-embedding.\n\t\tthis._timeoutId = setTimeout( () => {\n\t\t\t// Do nothing if image element cannot be inserted at the current position.\n\t\t\t// See https://github.com/ckeditor/ckeditor5/issues/2763.\n\t\t\t// Condition must be checked after timeout - pasting may take place on an element, replacing it. The final position matters.\n\t\t\tconst imageCommand = editor.commands.get( 'insertImage' )!;\n\n\t\t\tif ( !imageCommand.isEnabled ) {\n\t\t\t\turlRange.detach();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditor.model.change( writer => {\n\t\t\t\tthis._timeoutId = null;\n\n\t\t\t\twriter.remove( urlRange );\n\t\t\t\turlRange.detach();\n\n\t\t\t\tlet insertionPosition;\n\n\t\t\t\t// Check if the position where the element should be inserted is still valid.\n\t\t\t\t// Otherwise leave it as undefined to use the logic of insertImage().\n\t\t\t\tif ( this._positionToInsert!.root.rootName !== '$graveyard' ) {\n\t\t\t\t\tinsertionPosition = this._positionToInsert!.toPosition();\n\t\t\t\t}\n\n\t\t\t\timageUtils.insertImage( { ...selectionAttributes, src }, insertionPosition );\n\n\t\t\t\tthis._positionToInsert!.detach();\n\t\t\t\tthis._positionToInsert = null;\n\t\t\t} );\n\n\t\t\tconst deletePlugin: Delete = editor.plugins.get( 'Delete' );\n\n\t\t\tdeletePlugin.requestUndoOnBackspace();\n\t\t}, 100 );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagetextalternative/imagetextalternativecommand\n */\n\nimport { Command } from 'ckeditor5/src/core.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * The image text alternative command. It is used to change the `alt` attribute of `<imageBlock>` and `<imageInline>` model elements.\n */\nexport class ImageTextAlternativeCommand extends Command {\n\t/**\n\t * The command value: `false` if there is no `alt` attribute, otherwise the value of the `alt` attribute.\n\t *\n\t * @readonly\n\t * @observable\n\t */\n\tdeclare public value: string | false;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst element = imageUtils.getClosestSelectedImageElement( this.editor.model.document.selection )!;\n\n\t\tthis.isEnabled = !!element;\n\n\t\tif ( this.isEnabled && element.hasAttribute( 'alt' ) ) {\n\t\t\tthis.value = element.getAttribute( 'alt' ) as string | false;\n\t\t} else {\n\t\t\tthis.value = false;\n\t\t}\n\t}\n\n\t/**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options\n\t * @param options.newValue The new value of the `alt` attribute to set.\n\t */\n\tpublic override execute( options: { newValue: string } ): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst model = editor.model;\n\t\tconst imageElement = imageUtils.getClosestSelectedImageElement( model.document.selection );\n\n\t\tmodel.change( writer => {\n\t\t\twriter.setAttribute( 'alt', options.newValue, imageElement! );\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagetextalternative/imagetextalternativeediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageTextAlternativeCommand } from './imagetextalternativecommand.js';\nimport { ImageUtils } from '../imageutils.js';\n\n/**\n * The image text alternative editing plugin.\n *\n * Registers the `'imageTextAlternative'` command.\n */\nexport class ImageTextAlternativeEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageTextAlternativeEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tthis.editor.commands.add( 'imageTextAlternative', new ImageTextAlternativeCommand( this.editor ) );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagetextalternative/ui/textalternativeformview\n */\n\nimport {\n\tButtonView,\n\tFocusCycler,\n\tFormRowView,\n\tFormHeaderView,\n\tLabeledFieldView,\n\tView,\n\tViewCollection,\n\tcreateLabeledInputText,\n\tsubmitHandler,\n\ttype InputView,\n\ttype FocusableView\n} from 'ckeditor5/src/ui.js';\nimport { FocusTracker, KeystrokeHandler, type Locale } from 'ckeditor5/src/utils.js';\nimport { IconPreviousArrow } from 'ckeditor5/src/icons.js';\n\nimport '../../../theme/textalternativeform.css';\n\n// See: #8833.\n// eslint-disable-next-line ckeditor5-rules/ckeditor-imports\nimport '@ckeditor/ckeditor5-ui/theme/components/responsive-form/responsiveform.css';\n// eslint-disable-next-line ckeditor5-rules/ckeditor-imports\nimport '@ckeditor/ckeditor5-ui/theme/components/form/form.css';\n\n/**\n * The TextAlternativeFormView class.\n *\n * @internal\n */\nexport class TextAlternativeFormView extends View {\n\t/**\n\t * Tracks information about the DOM focus in the form.\n\t */\n\tpublic readonly focusTracker: FocusTracker;\n\n\t/**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */\n\tpublic readonly keystrokes: KeystrokeHandler;\n\n\t/**\n\t * An input with a label.\n\t */\n\tpublic labeledInput: LabeledFieldView<InputView>;\n\n\t/**\n\t * The Back button view displayed in the header.\n\t */\n\tpublic backButtonView: ButtonView;\n\n\t/**\n\t * A button used to submit the form.\n\t */\n\tpublic saveButtonView: ButtonView;\n\n\t/**\n\t * A collection of child views.\n\t */\n\tpublic readonly children: ViewCollection;\n\n\t/**\n\t * A collection of views which can be focused in the form.\n\t */\n\tprotected readonly _focusables: ViewCollection<FocusableView>;\n\n\t/**\n\t * Helps cycling over {@link #_focusables} in the form.\n\t */\n\tprotected readonly _focusCycler: FocusCycler;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( locale: Locale ) {\n\t\tsuper( locale );\n\n\t\tthis.focusTracker = new FocusTracker();\n\t\tthis.keystrokes = new KeystrokeHandler();\n\n\t\t// Create buttons.\n\t\tthis.backButtonView = this._createBackButton();\n\t\tthis.saveButtonView = this._createSaveButton();\n\n\t\t// Create input fields.\n\t\tthis.labeledInput = this._createLabeledInputView();\n\n\t\tthis.children = this.createCollection( [\n\t\t\tthis._createHeaderView()\n\t\t] );\n\t\tthis.children.add( new FormRowView( locale, {\n\t\t\tchildren: [\n\t\t\t\tthis.labeledInput,\n\t\t\t\tthis.saveButtonView\n\t\t\t],\n\t\t\tclass: [\n\t\t\t\t'ck-form__row_with-submit',\n\t\t\t\t'ck-form__row_large-top-padding'\n\t\t\t]\n\t\t} ) );\n\n\t\tthis._focusables = new ViewCollection();\n\n\t\t// Close the panel on esc key press when the **form has focus**.\n\t\tthis.keystrokes.set( 'Esc', ( data, cancel ) => {\n\t\t\tthis.fire<TextAlternativeFormViewCancelEvent>( 'cancel' );\n\t\t\tcancel();\n\t\t} );\n\n\t\tthis._focusCycler = new FocusCycler( {\n\t\t\tfocusables: this._focusables,\n\t\t\tfocusTracker: this.focusTracker,\n\t\t\tkeystrokeHandler: this.keystrokes,\n\t\t\tactions: {\n\t\t\t\t// Navigate form fields backwards using the Shift + Tab keystroke.\n\t\t\t\tfocusPrevious: 'shift + tab',\n\n\t\t\t\t// Navigate form fields forwards using the Tab key.\n\t\t\t\tfocusNext: 'tab'\n\t\t\t}\n\t\t} );\n\n\t\tthis.setTemplate( {\n\t\t\ttag: 'form',\n\n\t\t\tattributes: {\n\t\t\t\tclass: [\n\t\t\t\t\t'ck',\n\t\t\t\t\t'ck-form',\n\t\t\t\t\t'ck-text-alternative-form',\n\t\t\t\t\t'ck-responsive-form'\n\t\t\t\t],\n\n\t\t\t\t// https://github.com/ckeditor/ckeditor5-image/issues/40\n\t\t\t\ttabindex: '-1'\n\t\t\t},\n\n\t\t\tchildren: this.children\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override render(): void {\n\t\tsuper.render();\n\n\t\tsubmitHandler( {\n\t\t\tview: this\n\t\t} );\n\n\t\tconst childViews = [\n\t\t\tthis.backButtonView,\n\t\t\tthis.labeledInput,\n\t\t\tthis.saveButtonView\n\t\t];\n\n\t\tchildViews.forEach( v => {\n\t\t\t// Register the view as focusable.\n\t\t\tthis._focusables.add( v );\n\n\t\t\t// Register the view in the focus tracker.\n\t\t\tthis.focusTracker.add( v.element! );\n\t\t} );\n\n\t\tthis.keystrokes.listenTo( this.element! );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tsuper.destroy();\n\n\t\tthis.focusTracker.destroy();\n\t\tthis.keystrokes.destroy();\n\t}\n\n\t/**\n\t * Creates a back button view that cancels the form.\n\t */\n\tprivate _createBackButton(): ButtonView {\n\t\tconst t = this.locale!.t;\n\t\tconst backButton = new ButtonView( this.locale );\n\n\t\tbackButton.set( {\n\t\t\tclass: 'ck-button-back',\n\t\t\tlabel: t( 'Back' ),\n\t\t\ticon: IconPreviousArrow,\n\t\t\ttooltip: true\n\t\t} );\n\n\t\tbackButton.delegate( 'execute' ).to( this, 'cancel' );\n\n\t\treturn backButton;\n\t}\n\n\t/**\n\t * Creates a save button view that text alternative the image.\n\t */\n\tprivate _createSaveButton(): ButtonView {\n\t\tconst t = this.locale!.t;\n\t\tconst saveButton = new ButtonView( this.locale );\n\n\t\tsaveButton.set( {\n\t\t\tlabel: t( 'Save' ),\n\t\t\twithText: true,\n\t\t\ttype: 'submit',\n\t\t\tclass: 'ck-button-action ck-button-bold'\n\t\t} );\n\n\t\treturn saveButton;\n\t}\n\n\t/**\n\t * Creates a header view for the form.\n\t */\n\tprivate _createHeaderView(): FormHeaderView {\n\t\tconst t = this.locale!.t;\n\n\t\tconst header = new FormHeaderView( this.locale, {\n\t\t\tlabel: t( 'Text Alternative' )\n\t\t} );\n\n\t\theader.children.add( this.backButtonView, 0 );\n\n\t\treturn header;\n\t}\n\n\t/**\n\t * Creates an input with a label.\n\t *\n\t * @returns Labeled field view instance.\n\t */\n\tprivate _createLabeledInputView(): LabeledFieldView<InputView> {\n\t\tconst t = this.locale!.t;\n\t\tconst labeledInput = new LabeledFieldView<InputView>( this.locale, createLabeledInputText );\n\n\t\tlabeledInput.label = t( 'Text alternative' );\n\t\tlabeledInput.class = 'ck-labeled-field-view_full-width';\n\n\t\treturn labeledInput;\n\t}\n}\n\n/**\n * Fired when the form view is submitted.\n *\n * @eventName ~TextAlternativeFormView#submit\n * @internal\n */\nexport type TextAlternativeFormViewSubmitEvent = {\n\tname: 'submit';\n\targs: [];\n};\n\n/**\n * Fired when the form view is canceled.\n *\n * @eventName ~TextAlternativeFormView#cancel\n * @internal\n */\nexport type TextAlternativeFormViewCancelEvent = {\n\tname: 'cancel';\n\targs: [];\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/ui/utils\n */\n\nimport type { DomOptimalPositionOptions } from 'ckeditor5/src/utils.js';\nimport type { Editor } from 'ckeditor5/src/core.js';\nimport { BalloonPanelView, type ContextualBalloon } from 'ckeditor5/src/ui.js';\n\nimport { type ImageUtils } from '../../imageutils.js';\n\n/**\n * A helper utility that positions the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} instance\n * with respect to the image in the editor content, if one is selected.\n *\n * @param editor The editor instance.\n * @internal\n */\nexport function repositionContextualBalloon( editor: Editor ): void {\n\tconst balloon: ContextualBalloon = editor.plugins.get( 'ContextualBalloon' );\n\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\tif ( imageUtils.getClosestSelectedImageWidget( editor.editing.view.document.selection ) ) {\n\t\tconst position = getBalloonPositionData( editor );\n\n\t\tballoon.updatePosition( position );\n\t}\n}\n\n/**\n * Returns the positioning options that control the geometry of the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon} with respect\n * to the selected element in the editor content.\n *\n * @param editor The editor instance.\n * @internal\n */\nexport function getBalloonPositionData( editor: Editor ): Partial<DomOptimalPositionOptions> {\n\tconst editingView = editor.editing.view;\n\tconst defaultPositions = BalloonPanelView.defaultPositions;\n\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\treturn {\n\t\ttarget: editingView.domConverter.mapViewToDom(\n\t\t\timageUtils.getClosestSelectedImageWidget( editingView.document.selection )!\n\t\t) as HTMLElement,\n\t\tpositions: [\n\t\t\tdefaultPositions.northArrowSouth,\n\t\t\tdefaultPositions.northArrowSouthWest,\n\t\t\tdefaultPositions.northArrowSouthEast,\n\t\t\tdefaultPositions.southArrowNorth,\n\t\t\tdefaultPositions.southArrowNorthWest,\n\t\t\tdefaultPositions.southArrowNorthEast,\n\t\t\tdefaultPositions.viewportStickyNorth\n\t\t]\n\t};\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagetextalternative/imagetextalternativeui\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport {\n\tButtonView,\n\tContextualBalloon,\n\tclickOutsideHandler,\n\tCssTransitionDisablerMixin,\n\ttype ViewWithCssTransitionDisabler\n} from 'ckeditor5/src/ui.js';\nimport { IconTextAlternative } from 'ckeditor5/src/icons.js';\n\nimport {\n\tTextAlternativeFormView,\n\ttype TextAlternativeFormViewCancelEvent,\n\ttype TextAlternativeFormViewSubmitEvent\n} from './ui/textalternativeformview.js';\nimport { repositionContextualBalloon, getBalloonPositionData } from '../image/ui/utils.js';\nimport { type ImageTextAlternativeCommand } from './imagetextalternativecommand.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * The image text alternative UI plugin.\n *\n * The plugin uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */\nexport class ImageTextAlternativeUI extends Plugin {\n\t/**\n\t * The contextual balloon plugin instance.\n\t */\n\tprivate _balloon?: ContextualBalloon;\n\n\t/**\n\t * A form containing a textarea and buttons, used to change the `alt` text value.\n\t */\n\tprivate _form?: TextAlternativeFormView & ViewWithCssTransitionDisabler;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ContextualBalloon ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageTextAlternativeUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tthis._createButton();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tsuper.destroy();\n\n\t\t// Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n\t\tif ( this._form ) {\n\t\t\tthis._form.destroy();\n\t\t}\n\t}\n\n\t/**\n\t * Creates a button showing the balloon panel for changing the image text alternative and\n\t * registers it in the editor {@link module:ui/componentfactory~ComponentFactory ComponentFactory}.\n\t */\n\tprivate _createButton(): void {\n\t\tconst editor = this.editor;\n\t\tconst t = editor.t;\n\n\t\teditor.ui.componentFactory.add( 'imageTextAlternative', locale => {\n\t\t\tconst command: ImageTextAlternativeCommand = editor.commands.get( 'imageTextAlternative' )!;\n\t\t\tconst view = new ButtonView( locale );\n\n\t\t\tview.set( {\n\t\t\t\tlabel: t( 'Change image text alternative' ),\n\t\t\t\ticon: IconTextAlternative,\n\t\t\t\ttooltip: true\n\t\t\t} );\n\n\t\t\tview.bind( 'isEnabled' ).to( command, 'isEnabled' );\n\t\t\tview.bind( 'isOn' ).to( command, 'value', value => !!value );\n\n\t\t\tthis.listenTo( view, 'execute', () => {\n\t\t\t\tthis._showForm();\n\t\t\t} );\n\n\t\t\treturn view;\n\t\t} );\n\t}\n\n\t/**\n\t * Creates the {@link module:image/imagetextalternative/ui/textalternativeformview~TextAlternativeFormView}\n\t * form.\n\t */\n\tprivate _createForm(): void {\n\t\tconst editor = this.editor;\n\t\tconst view = editor.editing.view;\n\t\tconst viewDocument = view.document;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tthis._balloon = this.editor.plugins.get( 'ContextualBalloon' );\n\n\t\tthis._form = new ( CssTransitionDisablerMixin( TextAlternativeFormView ) )( editor.locale );\n\n\t\t// Render the form so its #element is available for clickOutsideHandler.\n\t\tthis._form.render();\n\n\t\tthis.listenTo<TextAlternativeFormViewSubmitEvent>( this._form, 'submit', () => {\n\t\t\teditor.execute( 'imageTextAlternative', {\n\t\t\t\tnewValue: this._form!.labeledInput.fieldView.element!.value\n\t\t\t} );\n\n\t\t\tthis._hideForm( true );\n\t\t} );\n\n\t\tthis.listenTo<TextAlternativeFormViewCancelEvent>( this._form, 'cancel', () => {\n\t\t\tthis._hideForm( true );\n\t\t} );\n\n\t\t// Reposition the balloon or hide the form if an image widget is no longer selected.\n\t\tthis.listenTo( editor.ui, 'update', () => {\n\t\t\tif ( !imageUtils.getClosestSelectedImageWidget( viewDocument.selection ) ) {\n\t\t\t\tthis._hideForm( true );\n\t\t\t} else if ( this._isVisible ) {\n\t\t\t\trepositionContextualBalloon( editor );\n\t\t\t}\n\t\t} );\n\n\t\t// Close on click outside of balloon panel element.\n\t\tclickOutsideHandler( {\n\t\t\temitter: this._form,\n\t\t\tactivator: () => this._isVisible,\n\t\t\tcontextElements: () => [ this._balloon!.view.element! ],\n\t\t\tcallback: () => this._hideForm()\n\t\t} );\n\t}\n\n\t/**\n\t * Shows the {@link #_form} in the {@link #_balloon}.\n\t */\n\tprivate _showForm(): void {\n\t\tif ( this._isVisible ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this._form ) {\n\t\t\tthis._createForm();\n\t\t}\n\n\t\tconst editor = this.editor;\n\t\tconst command: ImageTextAlternativeCommand = editor.commands.get( 'imageTextAlternative' )!;\n\t\tconst labeledInput = this._form!.labeledInput;\n\n\t\tthis._form!.disableCssTransitions();\n\n\t\tif ( !this._isInBalloon ) {\n\t\t\tthis._balloon!.add( {\n\t\t\t\tview: this._form!,\n\t\t\t\tposition: getBalloonPositionData( editor )\n\t\t\t} );\n\t\t}\n\n\t\t// Make sure that each time the panel shows up, the field remains in sync with the value of\n\t\t// the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n\t\t// stays unaltered) and re-opened it without changing the value of the command, they would see the\n\t\t// old value instead of the actual value of the command.\n\t\t// https://github.com/ckeditor/ckeditor5-image/issues/114\n\t\tlabeledInput.fieldView.value = labeledInput.fieldView.element!.value = command.value || '';\n\n\t\tthis._form!.labeledInput.fieldView.select();\n\n\t\tthis._form!.enableCssTransitions();\n\t}\n\n\t/**\n\t * Removes the {@link #_form} from the {@link #_balloon}.\n\t *\n\t * @param focusEditable Controls whether the editing view is focused afterwards.\n\t */\n\tprivate _hideForm( focusEditable: boolean = false ): void {\n\t\tif ( !this._isInBalloon ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Blur the input element before removing it from DOM to prevent issues in some browsers.\n\t\t// See https://github.com/ckeditor/ckeditor5/issues/1501.\n\t\tif ( this._form!.focusTracker.isFocused ) {\n\t\t\tthis._form!.saveButtonView.focus();\n\t\t}\n\n\t\tthis._balloon!.remove( this._form! );\n\n\t\tif ( focusEditable ) {\n\t\t\tthis.editor.editing.view.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` when the {@link #_form} is the visible view in the {@link #_balloon}.\n\t */\n\tprivate get _isVisible(): boolean {\n\t\treturn !!this._balloon && this._balloon.visibleView === this._form;\n\t}\n\n\t/**\n\t * Returns `true` when the {@link #_form} is in the {@link #_balloon}.\n\t */\n\tprivate get _isInBalloon(): boolean {\n\t\treturn !!this._balloon && this._balloon.hasView( this._form! );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagetextalternative\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageTextAlternativeEditing } from './imagetextalternative/imagetextalternativeediting.js';\nimport { ImageTextAlternativeUI } from './imagetextalternative/imagetextalternativeui.js';\n\n/**\n * The image text alternative plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-styles image styles} documentation.\n *\n * This is a \"glue\" plugin which loads the\n *  {@link module:image/imagetextalternative/imagetextalternativeediting~ImageTextAlternativeEditing}\n * and {@link module:image/imagetextalternative/imagetextalternativeui~ImageTextAlternativeUI} plugins.\n */\nexport class ImageTextAlternative extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageTextAlternativeEditing, ImageTextAlternativeUI ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageTextAlternative' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/converters\n */\n\nimport type {\n\tDowncastDispatcher,\n\tModelElement,\n\tUpcastDispatcher,\n\tUpcastElementEvent,\n\tViewElement,\n\tViewElementAttributes,\n\tDowncastAttributeEvent\n} from 'ckeditor5/src/engine.js';\nimport { first, type GetCallback } from 'ckeditor5/src/utils.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * Returns a function that converts the image view representation:\n *\n * ```html\n * <figure class=\"image\"><img src=\"...\" alt=\"...\"></img></figure>\n * ```\n *\n * to the model representation:\n *\n * ```html\n * <imageBlock src=\"...\" alt=\"...\"></imageBlock>\n * ```\n *\n * The entire content of the `<figure>` element except the first `<img>` is being converted as children\n * of the `<imageBlock>` model element.\n *\n * @internal\n */\nexport function upcastImageFigure( imageUtils: ImageUtils ): ( dispatcher: UpcastDispatcher ) => void {\n\tconst converter: GetCallback<UpcastElementEvent> = ( evt, data, conversionApi ) => {\n\t\t// Do not convert if this is not an \"image figure\".\n\t\tif ( !conversionApi.consumable.test( data.viewItem, { name: true, classes: 'image' } ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Find an image element inside the figure element.\n\t\tconst viewImage = imageUtils.findViewImgElement( data.viewItem );\n\n\t\t// Do not convert if image element is absent or was already converted.\n\t\tif ( !viewImage || !conversionApi.consumable.test( viewImage, { name: true } ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Consume the figure to prevent other converters from processing it again.\n\t\tconversionApi.consumable.consume( data.viewItem, { name: true, classes: 'image' } );\n\n\t\t// Convert view image to model image.\n\t\tconst conversionResult = conversionApi.convertItem( viewImage, data.modelCursor );\n\n\t\t// Get image element from conversion result.\n\t\tconst modelImage = first( conversionResult.modelRange!.getItems() ) as ModelElement;\n\n\t\t// When image wasn't successfully converted then finish conversion.\n\t\tif ( !modelImage ) {\n\t\t\t// Revert consumed figure so other features can convert it.\n\t\t\tconversionApi.consumable.revert( data.viewItem, { name: true, classes: 'image' } );\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Convert rest of the figure element's children as an image children.\n\t\tconversionApi.convertChildren( data.viewItem, modelImage );\n\n\t\tconversionApi.updateConversionResult( modelImage, data );\n\t};\n\n\treturn dispatcher => {\n\t\tdispatcher.on<UpcastElementEvent>( 'element:figure', converter );\n\t};\n}\n\n/**\n * Returns a function that converts the image view representation:\n *\n * ```html\n * <picture><source ... /><source ... />...<img ... /></picture>\n * ```\n *\n * to the model representation as the `sources` attribute:\n *\n * ```html\n * <image[Block|Inline] ... sources=\"...\"></image[Block|Inline]>\n * ```\n *\n * @internal\n */\nexport function upcastPicture( imageUtils: ImageUtils ): ( dispatcher: UpcastDispatcher ) => void {\n\tconst sourceAttributeNames = [ 'srcset', 'media', 'type', 'sizes' ];\n\n\tconst converter: GetCallback<UpcastElementEvent> = ( evt, data, conversionApi ) => {\n\t\tconst pictureViewElement = data.viewItem;\n\n\t\t// Do not convert <picture> if already consumed.\n\t\tif ( !conversionApi.consumable.test( pictureViewElement, { name: true } ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst sources = new Map<ViewElement, Record<string, string | undefined>>();\n\n\t\t// Collect all <source /> elements attribute values.\n\t\tfor ( const childSourceElement of pictureViewElement.getChildren() ) {\n\t\t\tif ( childSourceElement.is( 'element', 'source' ) ) {\n\t\t\t\tconst attributes: Record<string, string | undefined> = {};\n\n\t\t\t\tfor ( const name of sourceAttributeNames ) {\n\t\t\t\t\tif ( childSourceElement.hasAttribute( name ) ) {\n\t\t\t\t\t\t// Don't collect <source /> attribute if already consumed somewhere else.\n\t\t\t\t\t\tif ( conversionApi.consumable.test( childSourceElement, { attributes: name } ) ) {\n\t\t\t\t\t\t\tattributes[ name ] = childSourceElement.getAttribute( name );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( attributes ).length ) {\n\t\t\t\t\tsources.set( childSourceElement, attributes );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst imgViewElement = imageUtils.findViewImgElement( pictureViewElement );\n\n\t\t// Don't convert when a picture has no <img/> inside (it is broken).\n\t\tif ( !imgViewElement ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet modelImage = data.modelCursor.parent;\n\n\t\t// - In case of an inline image (cursor parent in a <paragraph>), the <img/> must be converted right away\n\t\t// because no converter handled it yet and otherwise there would be no model element to set the sources attribute on.\n\t\t// - In case of a block image, the <figure class=\"image\"> converter (in ImageBlockEditing) converts the\n\t\t// <img/> right away on its own and the modelCursor is already inside an imageBlock and there's nothing special\n\t\t// to do here.\n\t\tif ( !modelImage.is( 'element', 'imageBlock' ) ) {\n\t\t\tconst conversionResult = conversionApi.convertItem( imgViewElement, data.modelCursor );\n\n\t\t\t// Set image range as conversion result.\n\t\t\tdata.modelRange = conversionResult.modelRange;\n\n\t\t\t// Continue conversion where image conversion ends.\n\t\t\tdata.modelCursor = conversionResult.modelCursor;\n\n\t\t\tmodelImage = first( conversionResult.modelRange!.getItems() ) as ModelElement;\n\t\t}\n\n\t\tconversionApi.consumable.consume( pictureViewElement, { name: true } );\n\n\t\t// Consume only these <source/> attributes that were actually collected and will be passed on\n\t\t// to the image model element.\n\t\tfor ( const [ sourceElement, attributes ] of sources ) {\n\t\t\tconversionApi.consumable.consume( sourceElement, { attributes: Object.keys( attributes ) } );\n\t\t}\n\n\t\tif ( sources.size ) {\n\t\t\tconversionApi.writer.setAttribute( 'sources', Array.from( sources.values() ), modelImage );\n\t\t}\n\n\t\t// Convert rest of the <picture> children as an image children. Other converters may want to consume them.\n\t\tconversionApi.convertChildren( pictureViewElement, modelImage );\n\t};\n\n\treturn dispatcher => {\n\t\tdispatcher.on<UpcastElementEvent>( 'element:picture', converter );\n\t};\n}\n\n/**\n * Converter used to convert the `srcset` model image attribute to the `srcset` and `sizes` attributes in the view.\n *\n * @internal\n * @param imageType The type of the image.\n */\nexport function downcastSrcsetAttribute(\n\timageUtils: ImageUtils,\n\timageType: 'imageBlock' | 'imageInline'\n): ( dispatcher: DowncastDispatcher ) => void {\n\tconst converter: GetCallback<DowncastAttributeEvent<ModelElement>> = ( evt, data, conversionApi\t) => {\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst writer = conversionApi.writer;\n\t\tconst element = conversionApi.mapper.toViewElement( data.item )!;\n\t\tconst img = imageUtils.findViewImgElement( element )!;\n\n\t\tif ( data.attributeNewValue === null ) {\n\t\t\twriter.removeAttribute( 'srcset', img );\n\t\t\twriter.removeAttribute( 'sizes', img );\n\t\t} else {\n\t\t\tif ( data.attributeNewValue ) {\n\t\t\t\twriter.setAttribute( 'srcset', data.attributeNewValue, img );\n\t\t\t\t// Always outputting `100vw`. See https://github.com/ckeditor/ckeditor5-image/issues/2.\n\t\t\t\twriter.setAttribute( 'sizes', '100vw', img );\n\t\t\t}\n\t\t}\n\t};\n\n\treturn dispatcher => {\n\t\tdispatcher.on<DowncastAttributeEvent<ModelElement>>( `attribute:srcset:${ imageType }`, converter );\n\t};\n}\n\n/**\n * Converts the `source` model attribute to the `<picture><source /><source />...<img /></picture>`\n * view structure.\n *\n * @internal\n */\nexport function downcastSourcesAttribute( imageUtils: ImageUtils ): ( dispatcher: DowncastDispatcher ) => void {\n\tconst converter: GetCallback<DowncastAttributeEvent<ModelElement>> = ( evt, data, conversionApi\t) => {\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst viewWriter = conversionApi.writer;\n\t\tconst element = conversionApi.mapper.toViewElement( data.item )!;\n\t\tconst imgElement = imageUtils.findViewImgElement( element )!;\n\t\tconst attributeNewValue = data.attributeNewValue as null | Array<ViewElementAttributes>;\n\n\t\tif ( attributeNewValue && attributeNewValue.length ) {\n\t\t\t// Collect all wrapping attribute elements.\n\t\t\tconst attributeElements = [];\n\t\t\tlet viewElement = imgElement.parent;\n\n\t\t\twhile ( viewElement && viewElement.is( 'attributeElement' ) ) {\n\t\t\t\tconst parentElement = viewElement.parent;\n\n\t\t\t\tviewWriter.unwrap( viewWriter.createRangeOn( imgElement ), viewElement );\n\n\t\t\t\tattributeElements.unshift( viewElement );\n\t\t\t\tviewElement = parentElement;\n\t\t\t}\n\n\t\t\tconst hasPictureElement = imgElement.parent!.is( 'element', 'picture' );\n\n\t\t\t// Reuse existing <picture> element (ckeditor5#17192) or create a new one.\n\t\t\tconst pictureElement = hasPictureElement ? imgElement.parent : viewWriter.createContainerElement( 'picture', null );\n\n\t\t\tif ( !hasPictureElement ) {\n\t\t\t\tviewWriter.insert( viewWriter.createPositionBefore( imgElement ), pictureElement );\n\t\t\t}\n\n\t\t\tviewWriter.remove( viewWriter.createRangeIn( pictureElement ) );\n\n\t\t\tviewWriter.insert( viewWriter.createPositionAt( pictureElement, 'end' ),\n\t\t\t\tattributeNewValue.map( sourceAttributes => {\n\t\t\t\t\treturn viewWriter.createEmptyElement( 'source', sourceAttributes );\n\t\t\t\t} )\n\t\t\t);\n\n\t\t\tviewWriter.move( viewWriter.createRangeOn( imgElement ), viewWriter.createPositionAt( pictureElement, 'end' ) );\n\n\t\t\t// Apply collected attribute elements over the new picture element.\n\t\t\tfor ( const attributeElement of attributeElements ) {\n\t\t\t\tviewWriter.wrap( viewWriter.createRangeOn( pictureElement ), attributeElement );\n\t\t\t}\n\t\t}\n\t\t// Both setting \"sources\" to an empty array and removing the attribute should unwrap the <img />.\n\t\t// Unwrap once if the latter followed the former, though.\n\t\telse if ( imgElement.parent!.is( 'element', 'picture' ) ) {\n\t\t\tconst pictureElement = imgElement.parent;\n\n\t\t\tviewWriter.move( viewWriter.createRangeOn( imgElement ), viewWriter.createPositionBefore( pictureElement ) );\n\t\t\tviewWriter.remove( pictureElement );\n\t\t}\n\t};\n\n\treturn dispatcher => {\n\t\tdispatcher.on<DowncastAttributeEvent<ModelElement>>( 'attribute:sources:imageBlock', converter );\n\t\tdispatcher.on<DowncastAttributeEvent<ModelElement>>( 'attribute:sources:imageInline', converter );\n\t};\n}\n\n/**\n * Converter used to convert a given image attribute from the model to the view.\n *\n * @internal\n * @param imageType The type of the image.\n * @param attributeKey The name of the attribute to convert.\n */\nexport function downcastImageAttribute(\n\timageUtils: ImageUtils,\n\timageType: 'imageBlock' | 'imageInline',\n\tattributeKey: string\n): ( dispatcher: DowncastDispatcher ) => void {\n\tconst converter: GetCallback<DowncastAttributeEvent<ModelElement>> = ( evt, data, conversionApi ) => {\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst viewWriter = conversionApi.writer;\n\t\tconst element = conversionApi.mapper.toViewElement( data.item )!;\n\t\tconst img = imageUtils.findViewImgElement( element )!;\n\n\t\tviewWriter.setAttribute( data.attributeKey, data.attributeNewValue || '', img );\n\t};\n\n\treturn dispatcher => {\n\t\tdispatcher.on<DowncastAttributeEvent<ModelElement>>( `attribute:${ attributeKey }:${ imageType }`, converter );\n\t};\n}\n\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/imageloadobserver\n */\n\nimport { Observer } from 'ckeditor5/src/engine.js';\n\n/**\n * Observes all new images added to the {@link module:engine/view/document~ViewDocument},\n * fires {@link module:engine/view/document~ViewDocument#event:imageLoaded} and\n * {@link module:engine/view/document~ViewDocument#event:layoutChanged} event every time when the new image\n * has been loaded.\n *\n * **Note:** This event is not fired for images that has been added to the document and rendered as `complete` (already loaded).\n */\nexport class ImageLoadObserver extends Observer {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic observe( domRoot: HTMLElement ): void {\n\t\tthis.listenTo( domRoot, 'load', ( event, domEvent ) => {\n\t\t\tconst domElement = domEvent.target as HTMLElement;\n\n\t\t\tif ( this.checkShouldIgnoreEventFromTarget( domElement ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( domElement.tagName == 'IMG' ) {\n\t\t\t\tthis._fireEvents( domEvent );\n\t\t\t}\n\t\t\t// Use capture phase for better performance (#4504).\n\t\t}, { useCapture: true } );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override stopObserving( domRoot: HTMLElement ): void {\n\t\tthis.stopListening( domRoot );\n\t}\n\n\t/**\n\t * Fires {@link module:engine/view/document~ViewDocument#event:layoutChanged} and\n\t * {@link module:engine/view/document~ViewDocument#event:imageLoaded}\n\t * if observer {@link #isEnabled is enabled}.\n\t *\n\t * @param domEvent The DOM event.\n\t */\n\tprivate _fireEvents( domEvent: Event ): void {\n\t\tif ( this.isEnabled ) {\n\t\t\tthis.document.fire( 'layoutChanged' );\n\t\t\tthis.document.fire<ImageLoadedEvent>( 'imageLoaded', domEvent );\n\t\t}\n\t}\n}\n\n/**\n * Fired when an <img/> DOM element has been loaded in the DOM root.\n *\n * Introduced by {@link module:image/image/imageloadobserver~ImageLoadObserver}.\n *\n * @see module:image/image/imageloadobserver~ImageLoadObserver\n *\n * @eventName module:engine/view/document~ViewDocument#imageLoaded\n * @param data Event data.\n */\nexport type ImageLoadedEvent = {\n\tname: 'imageLoaded';\n\targs: [ Event ];\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/insertimagecommand\n */\n\nimport { Command, type Editor } from 'ckeditor5/src/core.js';\nimport { logWarning, toArray, type ArrayOrItem } from 'ckeditor5/src/utils.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * Insert image command.\n *\n * The command is registered by the {@link module:image/image/imageediting~ImageEditing} plugin as `insertImage`\n * and it is also available via aliased `imageInsert` name.\n *\n * In order to insert an image at the current selection position\n * (according to the {@link module:widget/utils~findOptimalInsertionRange} algorithm),\n * execute the command and specify the image source:\n *\n * ```ts\n * editor.execute( 'insertImage', { source: 'http://url.to.the/image' } );\n * ```\n *\n * It is also possible to insert multiple images at once:\n *\n * ```ts\n * editor.execute( 'insertImage', {\n * \tsource:  [\n * \t\t'path/to/image.jpg',\n * \t\t'path/to/other-image.jpg'\n * \t]\n * } );\n * ```\n *\n * If you want to take the full control over the process, you can specify individual model attributes:\n *\n * ```ts\n * editor.execute( 'insertImage', {\n * \tsource:  [\n * \t\t{ src: 'path/to/image.jpg', alt: 'First alt text' },\n * \t\t{ src: 'path/to/other-image.jpg', alt: 'Second alt text', customAttribute: 'My attribute value' }\n * \t]\n * } );\n * ```\n */\nexport class InsertImageCommand extends Command {\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tconst configImageInsertType = editor.config.get( 'image.insert.type' );\n\n\t\tif ( !editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\tif ( configImageInsertType === 'block' ) {\n\t\t\t\t/**\n\t\t\t\t * The {@link module:image/imageblock~ImageBlock} plugin must be enabled to allow inserting block images. See\n\t\t\t\t * {@link module:image/imageconfig~ImageInsertConfig#type} to learn more.\n\t\t\t\t *\n\t\t\t\t * @error image-block-plugin-required\n\t\t\t\t */\n\t\t\t\tlogWarning( 'image-block-plugin-required' );\n\t\t\t}\n\t\t}\n\n\t\tif ( !editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\tif ( configImageInsertType === 'inline' ) {\n\t\t\t\t/**\n\t\t\t\t * The {@link module:image/imageinline~ImageInline} plugin must be enabled to allow inserting inline images. See\n\t\t\t\t * {@link module:image/imageconfig~ImageInsertConfig#type} to learn more.\n\t\t\t\t *\n\t\t\t\t * @error image-inline-plugin-required\n\t\t\t\t */\n\t\t\t\tlogWarning( 'image-inline-plugin-required' );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\tthis.isEnabled = imageUtils.isImageAllowed();\n\t}\n\n\t/**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options Options for the executed command.\n\t * @param options.imageType The type of the image to insert. If not specified, the type will be determined automatically.\n\t * @param options.source The image source or an array of image sources to insert.\n\t * @param options.breakBlock If set to `true`, the block at the selection start will be broken before inserting the image.\n\t * See the documentation of the command to learn more about accepted formats.\n\t */\n\tpublic override execute(\n\t\toptions: {\n\t\t\tsource: ArrayOrItem<string | Record<string, unknown>>;\n\t\t\timageType?: 'imageBlock' | 'imageInline' | null;\n\t\t\tbreakBlock?: boolean;\n\t\t}\n\t): void {\n\t\tconst sourceDefinitions = toArray<string | Record<string, unknown>>( options.source );\n\t\tconst selection = this.editor.model.document.selection;\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\t// In case of multiple images, each image (starting from the 2nd) will be inserted at a position that\n\t\t// follows the previous one. That will move the selection and, to stay on the safe side and make sure\n\t\t// all images inherit the same selection attributes, they are collected beforehand.\n\t\t//\n\t\t// Applying these attributes ensures, for instance, that inserting an (inline) image into a link does\n\t\t// not split that link but preserves its continuity.\n\t\t//\n\t\t// Note: Selection attributes that do not make sense for images will be filtered out by insertImage() anyway.\n\t\tconst selectionAttributes = Object.fromEntries( selection.getAttributes() );\n\n\t\tsourceDefinitions.forEach( ( sourceDefinition, index ) => {\n\t\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\t\tif ( typeof sourceDefinition === 'string' ) {\n\t\t\t\tsourceDefinition = { src: sourceDefinition };\n\t\t\t}\n\n\t\t\t// Inserting of an inline image replace the selected element and make a selection on the inserted image.\n\t\t\t// Therefore inserting multiple inline images requires creating position after each element.\n\t\t\tif ( index && selectedElement && imageUtils.isImage( selectedElement ) ) {\n\t\t\t\tconst position = this.editor.model.createPositionAfter( selectedElement );\n\n\t\t\t\timageUtils.insertImage( { ...sourceDefinition, ...selectionAttributes }, position, options.imageType );\n\t\t\t} else if ( options.breakBlock ) {\n\t\t\t\timageUtils.insertImage( { ...sourceDefinition, ...selectionAttributes }, selection.getFirstPosition(), options.imageType );\n\t\t\t} else {\n\t\t\t\timageUtils.insertImage( { ...sourceDefinition, ...selectionAttributes }, null, options.imageType );\n\t\t\t}\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\nimport { Command, type Editor } from 'ckeditor5/src/core.js';\nimport { type ImageUtils } from '../imageutils.js';\nimport type { ModelWriter, ModelElement } from 'ckeditor5/src/engine.js';\n\n/**\n * @module image/image/replaceimagesourcecommand\n */\n\n/**\n * Replace image source command.\n *\n * Changes image source to the one provided. Can be executed as follows:\n *\n * ```ts\n * editor.execute( 'replaceImageSource', { source: 'http://url.to.the/image' } );\n * ```\n */\nexport class ReplaceImageSourceCommand extends Command {\n\tdeclare public value: string | null;\n\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tthis.decorate( 'cleanupImage' );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst element = this.editor.model.document.selection.getSelectedElement()!;\n\n\t\tthis.isEnabled = imageUtils.isImage( element );\n\t\tthis.value = this.isEnabled ? element.getAttribute( 'src' ) as string : null;\n\t}\n\n\t/**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options Options for the executed command.\n\t * @param options.source The image source to replace.\n\t */\n\tpublic override execute( options: { source: string } ): void {\n\t\tconst image = this.editor.model.document.selection.getSelectedElement()!;\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\tthis.editor.model.change( writer => {\n\t\t\twriter.setAttribute( 'src', options.source, image );\n\n\t\t\tthis.cleanupImage( writer, image );\n\n\t\t\timageUtils.setImageNaturalSizeAttributes( image );\n\t\t} );\n\t}\n\n\t/**\n\t * Cleanup image attributes that are not relevant to the new source.\n\t *\n\t * Removed attributes are: 'srcset', 'sizes', 'sources', 'width', 'height', 'alt'.\n\t *\n\t * This method is decorated, to allow custom cleanup logic.\n\t * For example, to remove 'myImageId' attribute after 'src' has changed:\n\t *\n\t * ```ts\n\t * replaceImageSourceCommand.on( 'cleanupImage', ( eventInfo, [ writer, image ] ) => {\n\t * \twriter.removeAttribute( 'myImageId', image );\n\t * } );\n\t * ```\n\t */\n\tpublic cleanupImage( writer: ModelWriter, image: ModelElement ): void {\n\t\twriter.removeAttribute( 'srcset', image );\n\t\twriter.removeAttribute( 'sizes', image );\n\n\t\t/**\n\t\t * In case responsive images some attributes should be cleaned up.\n\t\t * Check: https://github.com/ckeditor/ckeditor5/issues/15093\n\t\t */\n\t\twriter.removeAttribute( 'sources', image );\n\t\twriter.removeAttribute( 'width', image );\n\t\twriter.removeAttribute( 'height', image );\n\t\twriter.removeAttribute( 'alt', image );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/imageediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageLoadObserver } from './imageloadobserver.js';\nimport { InsertImageCommand } from './insertimagecommand.js';\nimport { ReplaceImageSourceCommand } from './replaceimagesourcecommand.js';\nimport { ImageUtils } from '../imageutils.js';\n\n/**\n * The image engine plugin. This module loads common code shared between\n * {@link module:image/image/imageinlineediting~ImageInlineEditing} and\n * {@link module:image/image/imageblockediting~ImageBlockEditing} plugins.\n *\n * This plugin registers the {@link module:image/image/insertimagecommand~InsertImageCommand 'insertImage'} command.\n */\nexport class ImageEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst conversion = editor.conversion;\n\n\t\t// See https://github.com/ckeditor/ckeditor5-image/issues/142.\n\t\teditor.editing.view.addObserver( ImageLoadObserver );\n\n\t\tconversion.for( 'upcast' )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: 'img',\n\t\t\t\t\tkey: 'alt'\n\t\t\t\t},\n\t\t\t\tmodel: 'alt'\n\t\t\t} )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: 'img',\n\t\t\t\t\tkey: 'srcset'\n\t\t\t\t},\n\t\t\t\tmodel: 'srcset'\n\t\t\t} );\n\n\t\tconst insertImageCommand = new InsertImageCommand( editor );\n\t\tconst replaceImageSourceCommand = new ReplaceImageSourceCommand( editor );\n\n\t\teditor.commands.add( 'insertImage', insertImageCommand );\n\t\teditor.commands.add( 'replaceImageSource', replaceImageSourceCommand );\n\n\t\t// `imageInsert` is an alias for backward compatibility.\n\t\teditor.commands.add( 'imageInsert', insertImageCommand );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagesizeattributes\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport type { DowncastDispatcher, DowncastAttributeEvent, ViewElement, ModelElement } from 'ckeditor5/src/engine.js';\nimport { ImageUtils } from './imageutils.js';\nimport { widthAndHeightStylesAreBothSet, getSizeValueIfInPx } from './image/utils.js';\n\n/**\n * This plugin enables `width` and `height` attributes in inline and block image elements.\n */\nexport class ImageSizeAttributes extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageSizeAttributes' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tthis._registerSchema();\n\t\tthis._registerConverters( 'imageBlock' );\n\t\tthis._registerConverters( 'imageInline' );\n\t}\n\n\t/**\n\t * Registers the `width` and `height` attributes for inline and block images.\n\t */\n\tprivate _registerSchema(): void {\n\t\tconst schema = this.editor.model.schema;\n\n\t\tif ( this.editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\tschema.extend( 'imageBlock', { allowAttributes: [ 'width', 'height' ] } );\n\t\t}\n\n\t\tif ( this.editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\tschema.extend( 'imageInline', { allowAttributes: [ 'width', 'height' ] } );\n\t\t}\n\t}\n\n\t/**\n\t * Registers converters for `width` and `height` attributes.\n\t */\n\tprivate _registerConverters( imageType: 'imageBlock' | 'imageInline' ): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst viewElementName = imageType === 'imageBlock' ? 'figure' : 'img';\n\n\t\teditor.conversion.for( 'upcast' )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: viewElementName,\n\t\t\t\t\tstyles: {\n\t\t\t\t\t\twidth: /.+/\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmodel: {\n\t\t\t\t\tkey: 'width',\n\t\t\t\t\tvalue: ( viewElement: ViewElement ) => {\n\t\t\t\t\t\tif ( widthAndHeightStylesAreBothSet( viewElement ) ) {\n\t\t\t\t\t\t\treturn getSizeValueIfInPx( viewElement.getStyle( 'width' ) );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: viewElementName,\n\t\t\t\t\tkey: 'width'\n\t\t\t\t},\n\t\t\t\tmodel: 'width'\n\t\t\t} )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: viewElementName,\n\t\t\t\t\tstyles: {\n\t\t\t\t\t\theight: /.+/\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmodel: {\n\t\t\t\t\tkey: 'height',\n\t\t\t\t\tvalue: ( viewElement: ViewElement ) => {\n\t\t\t\t\t\tif ( widthAndHeightStylesAreBothSet( viewElement ) ) {\n\t\t\t\t\t\t\treturn getSizeValueIfInPx( viewElement.getStyle( 'height' ) );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: viewElementName,\n\t\t\t\t\tkey: 'height'\n\t\t\t\t},\n\t\t\t\tmodel: 'height'\n\t\t\t} );\n\n\t\t// Dedicated converters to propagate attributes to the <img> element.\n\t\teditor.conversion.for( 'editingDowncast' ).add( dispatcher => {\n\t\t\tattachDowncastConverter( dispatcher, 'width', 'width', true, true );\n\t\t\tattachDowncastConverter( dispatcher, 'height', 'height', true, true );\n\t\t} );\n\n\t\teditor.conversion.for( 'dataDowncast' ).add( dispatcher => {\n\t\t\tattachDowncastConverter( dispatcher, 'width', 'width', false );\n\t\t\tattachDowncastConverter( dispatcher, 'height', 'height', false );\n\t\t} );\n\n\t\t// Consume `aspect-ratio` style if `width` and `height` attributes are set on the image.\n\t\teditor.conversion.for( 'upcast' ).add( dispatcher => {\n\t\t\tdispatcher.on( 'element:img', ( evt, data, conversionApi ) => {\n\t\t\t\tconst width = data.viewItem.getAttribute( 'width' );\n\t\t\t\tconst height = data.viewItem.getAttribute( 'height' );\n\n\t\t\t\tif ( width && height ) {\n\t\t\t\t\tconversionApi.consumable.consume( data.viewItem, { styles: [ 'aspect-ratio' ] } );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\n\t\tfunction attachDowncastConverter(\n\t\t\tdispatcher: DowncastDispatcher,\n\t\t\tmodelAttributeName: string,\n\t\t\tviewAttributeName: string,\n\t\t\tsetRatioForInlineImage: boolean,\n\t\t\tisEditingDowncast: boolean = false\n\t\t) {\n\t\t\tdispatcher.on<DowncastAttributeEvent>( `attribute:${ modelAttributeName }:${ imageType }`, ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst viewWriter = conversionApi.writer;\n\t\t\t\tconst viewElement = conversionApi.mapper.toViewElement( data.item as ModelElement )!;\n\t\t\t\tconst img = imageUtils.findViewImgElement( viewElement )!;\n\n\t\t\t\tif ( data.attributeNewValue !== null ) {\n\t\t\t\t\tviewWriter.setAttribute( viewAttributeName, data.attributeNewValue, img );\n\t\t\t\t} else {\n\t\t\t\t\tviewWriter.removeAttribute( viewAttributeName, img );\n\t\t\t\t}\n\n\t\t\t\tconst width = data.item.getAttribute( 'width' );\n\t\t\t\tconst height = data.item.getAttribute( 'height' );\n\t\t\t\tconst hasSizes = width && height;\n\n\t\t\t\tif ( hasSizes && isEditingDowncast ) {\n\t\t\t\t\tviewWriter.setAttribute( 'loading', 'lazy', img );\n\t\t\t\t}\n\n\t\t\t\t// Do not set aspect-ratio for pictures. See https://github.com/ckeditor/ckeditor5/issues/14579.\n\t\t\t\tif ( data.item.hasAttribute( 'sources' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isResized = data.item.hasAttribute( 'resizedWidth' );\n\n\t\t\t\t// Do not set aspect ratio for inline images which are not resized (data pipeline).\n\t\t\t\tif ( imageType === 'imageInline' && !isResized && !setRatioForInlineImage ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( hasSizes ) {\n\t\t\t\t\tviewWriter.setStyle( 'aspect-ratio', `${ width }/${ height }`, img );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/imagetypecommand\n */\n\nimport type { ModelElement } from 'ckeditor5/src/engine.js';\nimport { Command, type Editor } from 'ckeditor5/src/core.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * The image type command. It changes the type of a selected image, depending on the configuration.\n */\nexport class ImageTypeCommand extends Command {\n\t/**\n\t * Model element name the command converts to.\n\t */\n\tprivate readonly _modelElementName: 'imageBlock' | 'imageInline';\n\n\t/**\n\t * @inheritDoc\n\t *\n\t * @param modelElementName Model element name the command converts to.\n\t */\n\tconstructor( editor: Editor, modelElementName: 'imageBlock' | 'imageInline' ) {\n\t\tsuper( editor );\n\n\t\tthis._modelElementName = modelElementName;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst element = imageUtils.getClosestSelectedImageElement( this.editor.model.document.selection );\n\n\t\tif ( this._modelElementName === 'imageBlock' ) {\n\t\t\tthis.isEnabled = imageUtils.isInlineImage( element );\n\t\t} else {\n\t\t\tthis.isEnabled = imageUtils.isBlockImage( element );\n\t\t}\n\t}\n\n\t/**\n\t * Executes the command and changes the type of a selected image.\n\t *\n\t * @fires execute\n\t * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n\t * The default is `true`.\n\t * @returns An object containing references to old and new model image elements\n\t * (for before and after the change) so external integrations can hook into the decorated\n\t * `execute` event and handle this change. `null` if the type change failed.\n\t */\n\tpublic override execute( options: { setImageSizes?: boolean } = {} ): { oldElement: ModelElement; newElement: ModelElement } | null {\n\t\tconst editor = this.editor;\n\t\tconst model = this.editor.model;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst oldElement = imageUtils.getClosestSelectedImageElement( model.document.selection )!;\n\t\tconst attributes = Object.fromEntries( oldElement.getAttributes() );\n\n\t\t// Don't change image type if \"src\" is missing (a broken image), unless there's \"uploadId\" set.\n\t\t// This state may happen during image upload (before it finishes) and it should be possible to change type\n\t\t// of the image in the meantime.\n\t\tif ( !attributes.src && !attributes.uploadId ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn model.change( writer => {\n\t\t\tconst { setImageSizes = true } = options;\n\n\t\t\t// Get all markers that contain the old image element.\n\t\t\tconst markers = Array.from( model.markers )\n\t\t\t\t.filter( marker => marker.getRange().containsItem( oldElement ) );\n\n\t\t\tconst newElement = imageUtils.insertImage(\n\t\t\t\tattributes,\n\t\t\t\tmodel.createSelection( oldElement, 'on' ),\n\t\t\t\tthis._modelElementName,\n\t\t\t\t{ setImageSizes }\n\t\t\t);\n\n\t\t\tif ( !newElement ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst newElementRange = writer.createRangeOn( newElement );\n\n\t\t\t// Expand the previously intersecting markers' ranges to include the new image element.\n\t\t\tfor ( const marker of markers ) {\n\t\t\t\tconst markerRange = marker.getRange();\n\n\t\t\t\t// Join the survived part of the old marker range with the new element range\n\t\t\t\t// (loosely because there could be some new paragraph or the existing one might got split).\n\t\t\t\tconst range = markerRange.root.rootName != '$graveyard' ?\n\t\t\t\t\tmarkerRange.getJoined( newElementRange, true )! : newElementRange;\n\n\t\t\t\twriter.updateMarker( marker, { range } );\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\toldElement,\n\t\t\t\tnewElement\n\t\t\t};\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/imageplaceholder\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport type {\n\tDowncastAttributeEvent,\n\tModelElement,\n\tViewElement\n} from 'ckeditor5/src/engine.js';\n\nimport { ImageUtils } from '../imageutils.js';\nimport { ImageLoadObserver, type ImageLoadedEvent } from './imageloadobserver.js';\n\nimport '../../theme/imageplaceholder.css';\n\n/**\n * Adds support for image placeholder that is automatically removed when the image is loaded.\n */\nexport class ImagePlaceholder extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImagePlaceholder' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tthis._setupSchema();\n\t\tthis._setupConversion();\n\t\tthis._setupLoadListener();\n\t}\n\n\t/**\n\t * Extends model schema.\n\t */\n\tprivate _setupSchema(): void {\n\t\tconst schema = this.editor.model.schema;\n\n\t\t// Wait for ImageBlockEditing or ImageInlineEditing to register their elements first,\n\t\t// that's why doing this in afterInit() instead of init().\n\t\tif ( schema.isRegistered( 'imageBlock' ) ) {\n\t\t\tschema.extend( 'imageBlock', {\n\t\t\t\tallowAttributes: [ 'placeholder' ]\n\t\t\t} );\n\t\t}\n\n\t\tif ( schema.isRegistered( 'imageInline' ) ) {\n\t\t\tschema.extend( 'imageInline', {\n\t\t\t\tallowAttributes: [ 'placeholder' ]\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Registers converters.\n\t */\n\tprivate _setupConversion(): void {\n\t\tconst editor = this.editor;\n\t\tconst conversion = editor.conversion;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tconversion.for( 'editingDowncast' ).add( dispatcher => {\n\t\t\tdispatcher.on<DowncastAttributeEvent<ModelElement>>( 'attribute:placeholder', ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.test( data.item, evt.name ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( !data.item.is( 'element', 'imageBlock' ) && !data.item.is( 'element', 'imageInline' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconversionApi.consumable.consume( data.item, evt.name );\n\n\t\t\t\tconst viewWriter = conversionApi.writer;\n\t\t\t\tconst element = conversionApi.mapper.toViewElement( data.item )!;\n\t\t\t\tconst img = imageUtils.findViewImgElement( element )!;\n\n\t\t\t\tif ( data.attributeNewValue ) {\n\t\t\t\t\tviewWriter.addClass( 'image_placeholder', img );\n\t\t\t\t\tviewWriter.setStyle( 'background-image', `url(${ data.attributeNewValue })`, img );\n\t\t\t\t\tviewWriter.setCustomProperty( 'editingPipeline:doNotReuseOnce', true, img );\n\t\t\t\t} else {\n\t\t\t\t\tviewWriter.removeClass( 'image_placeholder', img );\n\t\t\t\t\tviewWriter.removeStyle( 'background-image', img );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\t/**\n\t * Prepares listener for image load.\n\t */\n\tprivate _setupLoadListener(): void {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst editing = editor.editing;\n\t\tconst editingView = editing.view;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\teditingView.addObserver( ImageLoadObserver );\n\n\t\tthis.listenTo<ImageLoadedEvent>( editingView.document, 'imageLoaded', ( evt, domEvent ) => {\n\t\t\tconst imgViewElement = editingView.domConverter.mapDomToView( domEvent.target as HTMLElement );\n\n\t\t\tif ( !imgViewElement ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst viewElement = imageUtils.getImageWidgetFromImageView( imgViewElement as ViewElement );\n\n\t\t\tif ( !viewElement ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst modelElement = editing.mapper.toModelElement( viewElement );\n\n\t\t\tif ( !modelElement || !modelElement.hasAttribute( 'placeholder' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmodel.enqueueChange( { isUndoable: false }, writer => {\n\t\t\t\twriter.removeAttribute( 'placeholder', modelElement );\n\t\t\t} );\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/imageblockediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ClipboardPipeline, type ClipboardInputTransformationEvent, type ClipboardContentInsertionEvent } from 'ckeditor5/src/clipboard.js';\nimport { ViewUpcastWriter, type ViewElement } from 'ckeditor5/src/engine.js';\n\nimport {\n\tdowncastImageAttribute,\n\tdowncastSrcsetAttribute,\n\tupcastImageFigure\n} from './converters.js';\n\nimport { ImageEditing } from './imageediting.js';\nimport { ImageSizeAttributes } from '../imagesizeattributes.js';\nimport { ImageTypeCommand } from './imagetypecommand.js';\nimport { ImageUtils } from '../imageutils.js';\nimport {\n\tgetImgViewElementMatcher,\n\tcreateBlockImageViewElement,\n\tdetermineImageTypeForInsertionAtSelection\n} from './utils.js';\nimport { ImagePlaceholder } from './imageplaceholder.js';\n\n/**\n * The image block plugin.\n *\n * It registers:\n *\n * * `<imageBlock>` as a block element in the document schema, and allows `alt`, `src` and `srcset` attributes.\n * * converters for editing and data pipelines.,\n * * {@link module:image/image/imagetypecommand~ImageTypeCommand `'imageTypeBlock'`} command that converts inline images into\n * block images.\n */\nexport class ImageBlockEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageEditing, ImageSizeAttributes, ImageUtils, ImagePlaceholder, ClipboardPipeline ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageBlockEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst schema = editor.model.schema;\n\n\t\t// Converters 'alt' and 'srcset' are added in 'ImageEditing' plugin.\n\t\tschema.register( 'imageBlock', {\n\t\t\tinheritAllFrom: '$blockObject',\n\t\t\tallowAttributes: [ 'alt', 'src', 'srcset' ]\n\t\t} );\n\n\t\tthis._setupConversion();\n\n\t\tif ( editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\teditor.commands.add( 'imageTypeBlock', new ImageTypeCommand( this.editor, 'imageBlock' ) );\n\n\t\t\tthis._setupClipboardIntegration();\n\t\t}\n\t}\n\n\t/**\n\t * Configures conversion pipelines to support upcasting and downcasting\n\t * block images (block image widgets) and their attributes.\n\t */\n\tprivate _setupConversion(): void {\n\t\tconst editor = this.editor;\n\t\tconst t = editor.t;\n\t\tconst conversion = editor.conversion;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tconversion.for( 'dataDowncast' )\n\t\t\t.elementToStructure( {\n\t\t\t\tmodel: 'imageBlock',\n\t\t\t\tview: ( modelElement, { writer } ) => createBlockImageViewElement( writer )\n\t\t\t} );\n\n\t\tconversion.for( 'editingDowncast' )\n\t\t\t.elementToStructure( {\n\t\t\t\tmodel: 'imageBlock',\n\t\t\t\tview: ( modelElement, { writer } ) => imageUtils.toImageWidget(\n\t\t\t\t\tcreateBlockImageViewElement( writer ), writer, t( 'image widget' )\n\t\t\t\t)\n\t\t\t} );\n\n\t\tconversion.for( 'downcast' )\n\t\t\t.add( downcastImageAttribute( imageUtils, 'imageBlock', 'src' ) )\n\t\t\t.add( downcastImageAttribute( imageUtils, 'imageBlock', 'alt' ) )\n\t\t\t.add( downcastSrcsetAttribute( imageUtils, 'imageBlock' ) );\n\n\t\t// More image related upcasts are in 'ImageEditing' plugin.\n\t\tconversion.for( 'upcast' )\n\t\t\t.elementToElement( {\n\t\t\t\tview: getImgViewElementMatcher( editor, 'imageBlock' ),\n\t\t\t\tmodel: ( viewImage, { writer } ) => writer.createElement(\n\t\t\t\t\t'imageBlock',\n\t\t\t\t\tviewImage.hasAttribute( 'src' ) ? { src: viewImage.getAttribute( 'src' ) } : undefined\n\t\t\t\t)\n\t\t\t} )\n\t\t\t.add( upcastImageFigure( imageUtils ) );\n\t}\n\n\t/**\n\t * Integrates the plugin with the clipboard pipeline.\n\t *\n\t * Idea is that the feature should recognize the user's intent when an **inline** image is\n\t * pasted or dropped. If such an image is pasted/dropped:\n\t *\n\t * * into an empty block (e.g. an empty paragraph),\n\t * * on another object (e.g. some block widget).\n\t *\n\t * it gets converted into a block image on the fly. We assume this is the user's intent\n\t * if they decided to put their image there.\n\t *\n\t * See the `ImageInlineEditing` for the similar integration that works in the opposite direction.\n\t *\n\t * The feature also sets image `width` and `height` attributes on paste.\n\t */\n\tprivate _setupClipboardIntegration(): void {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst editingView = editor.editing.view;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst clipboardPipeline: ClipboardPipeline = editor.plugins.get( 'ClipboardPipeline' );\n\n\t\tthis.listenTo<ClipboardInputTransformationEvent>(\n\t\t\tclipboardPipeline,\n\t\t\t'inputTransformation',\n\t\t\t( evt, data ) => {\n\t\t\t\tconst docFragmentChildren = Array.from( data.content.getChildren() as IterableIterator<ViewElement> );\n\t\t\t\tlet modelRange;\n\n\t\t\t\t// Make sure only <img> elements are dropped or pasted. Otherwise, if there some other HTML\n\t\t\t\t// mixed up, this should be handled as a regular paste.\n\t\t\t\tif ( !docFragmentChildren.every( imageUtils.isInlineImageView ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// When drag and dropping, data.targetRanges specifies where to drop because\n\t\t\t\t// this is usually a different place than the current model selection (the user\n\t\t\t\t// uses a drop marker to specify the drop location).\n\t\t\t\tif ( data.targetRanges ) {\n\t\t\t\t\tmodelRange = editor.editing.mapper.toModelRange( data.targetRanges[ 0 ] );\n\t\t\t\t}\n\t\t\t\t// Pasting, however, always occurs at the current model selection.\n\t\t\t\telse {\n\t\t\t\t\tmodelRange = model.document.selection.getFirstRange();\n\t\t\t\t}\n\n\t\t\t\tconst selection = model.createSelection( modelRange );\n\n\t\t\t\t// Convert inline images into block images only when the currently selected block is empty\n\t\t\t\t// (e.g. an empty paragraph) or some object is selected (to replace it).\n\t\t\t\tif ( determineImageTypeForInsertionAtSelection( model.schema, selection ) === 'imageBlock' ) {\n\t\t\t\t\tconst writer = new ViewUpcastWriter( editingView.document );\n\n\t\t\t\t\t// Wrap <img ... /> -> <figure class=\"image\"><img .../></figure>\n\t\t\t\t\tconst blockViewImages = docFragmentChildren.map(\n\t\t\t\t\t\tinlineViewImage => writer.createElement( 'figure', { class: 'image' }, inlineViewImage )\n\t\t\t\t\t);\n\n\t\t\t\t\tdata.content = writer.createDocumentFragment( blockViewImages );\n\t\t\t\t}\n\t\t\t} );\n\n\t\tthis.listenTo<ClipboardContentInsertionEvent>(\n\t\t\tclipboardPipeline,\n\t\t\t'contentInsertion',\n\t\t\t( evt, data ) => {\n\t\t\t\tif ( data.method !== 'paste' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmodel.change( writer => {\n\t\t\t\t\tconst range = writer.createRangeIn( data.content );\n\n\t\t\t\t\tfor ( const item of range.getItems() ) {\n\t\t\t\t\t\tif ( item.is( 'element', 'imageBlock' ) ) {\n\t\t\t\t\t\t\timageUtils.setImageNaturalSizeAttributes( item );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinsert/ui/imageinsertformview\n */\n\nimport {\n\tView,\n\tViewCollection,\n\tsubmitHandler,\n\tFocusCycler,\n\tCollapsibleView,\n\ttype FocusableView\n} from 'ckeditor5/src/ui.js';\nimport { FocusTracker, KeystrokeHandler, type Locale } from 'ckeditor5/src/utils.js';\n\nimport '../../../theme/imageinsert.css';\n\n/**\n * The view displayed in the insert image dropdown.\n *\n * See {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n *\n * @internal\n */\nexport class ImageInsertFormView extends View {\n\t/**\n\t * Tracks information about DOM focus in the form.\n\t */\n\tpublic readonly focusTracker: FocusTracker;\n\n\t/**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */\n\tpublic readonly keystrokes: KeystrokeHandler;\n\n\t/**\n\t * A collection of views that can be focused in the form.\n\t */\n\tprotected readonly _focusables: ViewCollection<FocusableView>;\n\n\t/**\n\t * Helps cycling over {@link #_focusables} in the form.\n\t */\n\tprotected readonly _focusCycler: FocusCycler;\n\n\t/**\n\t * A collection of the defined integrations for inserting the images.\n\t */\n\tprivate readonly children: ViewCollection<FocusableView>;\n\n\t/**\n\t * Creates a view for the dropdown panel of {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n\t *\n\t * @param locale The localization services instance.\n\t * @param integrations An integrations object that contains components (or tokens for components) to be shown in the panel view.\n\t */\n\tconstructor( locale: Locale, integrations: Array<FocusableView> = [] ) {\n\t\tsuper( locale );\n\n\t\tthis.focusTracker = new FocusTracker();\n\t\tthis.keystrokes = new KeystrokeHandler();\n\t\tthis._focusables = new ViewCollection();\n\t\tthis.children = this.createCollection();\n\n\t\tthis._focusCycler = new FocusCycler( {\n\t\t\tfocusables: this._focusables,\n\t\t\tfocusTracker: this.focusTracker,\n\t\t\tkeystrokeHandler: this.keystrokes,\n\t\t\tactions: {\n\t\t\t\t// Navigate form fields backwards using the Shift + Tab keystroke.\n\t\t\t\tfocusPrevious: 'shift + tab',\n\n\t\t\t\t// Navigate form fields forwards using the Tab key.\n\t\t\t\tfocusNext: 'tab'\n\t\t\t}\n\t\t} );\n\n\t\tfor ( const view of integrations ) {\n\t\t\tthis.children.add( view );\n\t\t\tthis._focusables.add( view );\n\n\t\t\tif ( view instanceof CollapsibleView ) {\n\t\t\t\tthis._focusables.addMany( view.children );\n\t\t\t}\n\t\t}\n\n\t\tthis.setTemplate( {\n\t\t\ttag: 'form',\n\n\t\t\tattributes: {\n\t\t\t\tclass: [\n\t\t\t\t\t'ck',\n\t\t\t\t\t'ck-image-insert-form'\n\t\t\t\t],\n\t\t\t\ttabindex: -1\n\t\t\t},\n\n\t\t\tchildren: this.children\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override render(): void {\n\t\tsuper.render();\n\n\t\tsubmitHandler( {\n\t\t\tview: this\n\t\t} );\n\n\t\tfor ( const view of this._focusables ) {\n\t\t\tthis.focusTracker.add( view.element! );\n\t\t}\n\n\t\t// Start listening for the keystrokes coming from #element.\n\t\tthis.keystrokes.listenTo( this.element! );\n\n\t\tconst stopPropagation = ( data: KeyboardEvent ) => data.stopPropagation();\n\n\t\t// Since the form is in the dropdown panel which is a child of the toolbar, the toolbar's\n\t\t// keystroke handler would take over the key management in the URL input. We need to prevent\n\t\t// this ASAP. Otherwise, the basic caret movement using the arrow keys will be impossible.\n\t\tthis.keystrokes.set( 'arrowright', stopPropagation );\n\t\tthis.keystrokes.set( 'arrowleft', stopPropagation );\n\t\tthis.keystrokes.set( 'arrowup', stopPropagation );\n\t\tthis.keystrokes.set( 'arrowdown', stopPropagation );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tsuper.destroy();\n\n\t\tthis.focusTracker.destroy();\n\t\tthis.keystrokes.destroy();\n\t}\n\n\t/**\n\t * Focuses the first {@link #_focusables focusable} in the form.\n\t */\n\tpublic focus(): void {\n\t\tthis._focusCycler.focusFirst();\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinsert/imageinsertui\n */\n\nimport { Plugin, type Editor } from 'ckeditor5/src/core.js';\nimport {\n\tlogWarning,\n\ttype Locale,\n\ttype Observable\n} from 'ckeditor5/src/utils.js';\nimport {\n\tcreateDropdown,\n\ttype ButtonView,\n\ttype DropdownButtonView,\n\ttype DropdownView,\n\ttype FocusableView,\n\ttype MenuBarMenuListItemButtonView,\n\tMenuBarMenuListItemView,\n\tMenuBarMenuListView,\n\tMenuBarMenuView,\n\tSplitButtonView,\n\ttype View\n} from 'ckeditor5/src/ui.js';\nimport { IconImage } from 'ckeditor5/src/icons.js';\n\nimport { ImageInsertFormView } from './ui/imageinsertformview.js';\nimport { ImageUtils } from '../imageutils.js';\n\n/**\n * The image insert dropdown plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature}\n * and {@glink features/images/images-inserting Insert images via source URL} documentation.\n *\n * Adds the `'insertImage'` dropdown to the {@link module:ui/componentfactory~ComponentFactory UI component factory}\n * and also the `imageInsert` dropdown as an alias for backward compatibility.\n *\n * Adds the `'menuBar:insertImage'` sub-menu to the {@link module:ui/componentfactory~ComponentFactory UI component factory}, which is\n * by default added to the `'Insert'` menu.\n */\nexport class ImageInsertUI extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageInsertUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * The dropdown view responsible for displaying the image insert UI.\n\t */\n\tpublic dropdownView?: DropdownView;\n\n\t/**\n\t * Observable property used to alter labels while some image is selected and when it is not.\n\t *\n\t * @observable\n\t */\n\tdeclare public isImageSelected: boolean;\n\n\t/**\n\t * Registered integrations map.\n\t */\n\tprivate _integrations = new Map<string, IntegrationData>();\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\teditor.config.define( 'image.insert.integrations', [\n\t\t\t'upload',\n\t\t\t'assetManager',\n\t\t\t'url'\n\t\t] );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst selection = editor.model.document.selection;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tthis.set( 'isImageSelected', false );\n\n\t\tthis.listenTo( editor.model.document, 'change', () => {\n\t\t\tthis.isImageSelected = imageUtils.isImage( selection.getSelectedElement() );\n\t\t} );\n\n\t\tconst componentCreator = ( locale: Locale ) => this._createToolbarComponent( locale );\n\t\tconst menuBarComponentCreator = ( locale: Locale ) => this._createMenuBarComponent( locale );\n\n\t\t// Register `insertImage` dropdown and add `imageInsert` dropdown as an alias for backward compatibility.\n\t\teditor.ui.componentFactory.add( 'insertImage', componentCreator );\n\t\teditor.ui.componentFactory.add( 'imageInsert', componentCreator );\n\n\t\teditor.ui.componentFactory.add( 'menuBar:insertImage', menuBarComponentCreator );\n\t}\n\n\t/**\n\t * Registers the insert image dropdown integration.\n\t */\n\tpublic registerIntegration( {\n\t\tname,\n\t\tobservable,\n\t\tbuttonViewCreator,\n\t\tformViewCreator,\n\t\tmenuBarButtonViewCreator,\n\t\trequiresForm = false,\n\t\toverride = false\n\t}: {\n\t\tname: string;\n\t\tobservable: Observable & { isEnabled: boolean } | ( () => Observable & { isEnabled: boolean } );\n\t\tbuttonViewCreator: ( isOnlyOne: boolean ) => ButtonView;\n\t\tformViewCreator: ( isOnlyOne: boolean ) => FocusableView | Array<FocusableView>;\n\t\tmenuBarButtonViewCreator: ( isOnlyOne: boolean ) => MenuBarMenuListItemButtonView | Array<MenuBarMenuListItemButtonView>;\n\t\trequiresForm?: boolean;\n\t\toverride?: boolean;\n\t} ): void {\n\t\tif ( this._integrations.has( name ) && !override ) {\n\t\t\t/**\n\t\t\t * There are two insert-image integrations registered with the same name.\n\t\t\t *\n\t\t\t * Make sure that you do not load multiple asset manager plugins.\n\t\t\t *\n\t\t\t * @error image-insert-integration-exists\n\t\t\t */\n\t\t\tlogWarning( 'image-insert-integration-exists', { name } );\n\t\t}\n\n\t\tthis._integrations.set( name, {\n\t\t\tobservable,\n\t\t\tbuttonViewCreator,\n\t\t\tmenuBarButtonViewCreator,\n\t\t\tformViewCreator,\n\t\t\trequiresForm\n\t\t} );\n\t}\n\n\t/**\n\t * Creates the toolbar component.\n\t */\n\tprivate _createToolbarComponent( locale: Locale ): DropdownView | FocusableView {\n\t\tconst editor = this.editor;\n\t\tconst t = locale.t;\n\n\t\tconst integrations = this._prepareIntegrations();\n\n\t\tif ( !integrations.length ) {\n\t\t\treturn null as any;\n\t\t}\n\n\t\tlet dropdownButton: SplitButtonView | DropdownButtonView | undefined;\n\t\tconst firstIntegration = integrations[ 0 ];\n\n\t\tif ( integrations.length == 1 ) {\n\t\t\t// Do not use dropdown for a single integration button (integration that does not require form view).\n\t\t\tif ( !firstIntegration.requiresForm ) {\n\t\t\t\treturn firstIntegration.buttonViewCreator( true );\n\t\t\t}\n\n\t\t\tdropdownButton = firstIntegration.buttonViewCreator( true ) as DropdownButtonView;\n\t\t} else {\n\t\t\tconst actionButton = firstIntegration.buttonViewCreator( false ) as ButtonView & FocusableView;\n\n\t\t\tdropdownButton = new SplitButtonView( locale, actionButton );\n\t\t\tdropdownButton.tooltip = true;\n\n\t\t\tdropdownButton.bind( 'label' ).to( this, 'isImageSelected', isImageSelected => isImageSelected ?\n\t\t\t\tt( 'Replace image' ) :\n\t\t\t\tt( 'Insert image' )\n\t\t\t);\n\t\t}\n\n\t\tconst dropdownView = this.dropdownView = createDropdown( locale, dropdownButton );\n\t\tconst observables = integrations.map( ( { observable } ) => typeof observable == 'function' ? observable() : observable );\n\n\t\tdropdownView.bind( 'isEnabled' ).toMany( observables, 'isEnabled', ( ...isEnabled ) => (\n\t\t\tisEnabled.some( isEnabled => isEnabled )\n\t\t) );\n\n\t\tdropdownView.once( 'change:isOpen', () => {\n\t\t\tconst integrationViews = integrations.flatMap( ( { formViewCreator } ) => formViewCreator( integrations.length == 1 ) );\n\t\t\tconst imageInsertFormView = new ImageInsertFormView( editor.locale, integrationViews );\n\n\t\t\tdropdownView.panelView.children.add( imageInsertFormView );\n\t\t} );\n\n\t\treturn dropdownView;\n\t}\n\n\t/**\n\t * Creates the menu bar component.\n\t */\n\tprivate _createMenuBarComponent( locale: Locale ): View {\n\t\tconst t = locale.t;\n\n\t\tconst integrations = this._prepareIntegrations();\n\n\t\tif ( !integrations.length ) {\n\t\t\treturn null as any;\n\t\t}\n\n\t\tconst integrationViews = integrations.flatMap( ( {\n\t\t\tmenuBarButtonViewCreator\n\t\t} ) => menuBarButtonViewCreator( integrations.length == 1 ) );\n\n\t\tconst resultView = new MenuBarMenuView( locale );\n\t\tconst listView = new MenuBarMenuListView( locale );\n\t\tresultView.panelView.children.add( listView );\n\n\t\tresultView.buttonView.set( {\n\t\t\ticon: IconImage,\n\t\t\tlabel: t( 'Image' )\n\t\t} );\n\n\t\tfor ( const integrationView of integrationViews ) {\n\t\t\tconst listItemView = new MenuBarMenuListItemView( locale, resultView );\n\n\t\t\tlistItemView.children.add( integrationView );\n\t\t\tlistView.items.add( listItemView );\n\n\t\t\tintegrationView.delegate( 'execute' ).to( resultView );\n\t\t}\n\n\t\treturn resultView;\n\t}\n\n\t/**\n\t * Validates the integrations list.\n\t */\n\tprivate _prepareIntegrations(): Array<IntegrationData> {\n\t\tconst editor = this.editor;\n\t\tconst items = editor.config.get( 'image.insert.integrations' )!;\n\t\tconst result: Array<IntegrationData> = [];\n\n\t\tif ( !items.length ) {\n\t\t\t/**\n\t\t\t * The insert image feature requires a list of integrations to be provided in the editor configuration.\n\t\t\t *\n\t\t\t * The default list of integrations is `upload`, `assetManager`, `url`. Those integrations are included\n\t\t\t * in the insert image dropdown if the given feature plugin is loaded. You should omit the `integrations`\n\t\t\t * configuration key to use the default set or provide a selected list of integrations that should be used.\n\t\t\t *\n\t\t\t * @error image-insert-integrations-not-specified\n\t\t\t */\n\t\t\tlogWarning( 'image-insert-integrations-not-specified' );\n\n\t\t\treturn result;\n\t\t}\n\n\t\tfor ( const item of items ) {\n\t\t\tif ( !this._integrations.has( item ) ) {\n\t\t\t\tif ( ![ 'upload', 'assetManager', 'url' ].includes( item ) ) {\n\t\t\t\t\t/**\n\t\t\t\t\t * The specified insert image integration name is unknown or the providing plugin is not loaded in the editor.\n\t\t\t\t\t *\n\t\t\t\t\t * @error image-insert-unknown-integration\n\t\t\t\t\t */\n\t\t\t\t\tlogWarning( 'image-insert-unknown-integration', { item } );\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tresult.push( this._integrations.get( item )! );\n\t\t}\n\n\t\tif ( !result.length ) {\n\t\t\t/**\n\t\t\t * The image insert feature requires integrations to be registered by separate features.\n\t\t\t *\n\t\t\t * The `insertImage` toolbar button requires integrations to be registered by other features.\n\t\t\t * For example {@link module:image/imageupload~ImageUpload ImageUpload},\n\t\t\t * {@link module:image/imageinsert~ImageInsert ImageInsert},\n\t\t\t * {@link module:image/imageinsertviaurl~ImageInsertViaUrl ImageInsertViaUrl},\n\t\t\t * {@link module:ckbox/ckbox~CKBox CKBox}\n\t\t\t *\n\t\t\t * @error image-insert-integrations-not-registered\n\t\t\t */\n\t\t\tlogWarning( 'image-insert-integrations-not-registered' );\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\ntype IntegrationData = {\n\tobservable: Observable & { isEnabled: boolean } | ( () => Observable & { isEnabled: boolean } );\n\tbuttonViewCreator: ( isOnlyOne: boolean ) => ButtonView;\n\tmenuBarButtonViewCreator: ( isOnlyOne: boolean ) => MenuBarMenuListItemButtonView | Array<MenuBarMenuListItemButtonView>;\n\tformViewCreator: ( isOnlyOne: boolean ) => FocusableView | Array<FocusableView>;\n\trequiresForm: boolean;\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageblock\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { Widget } from 'ckeditor5/src/widget.js';\n\nimport { ImageTextAlternative } from './imagetextalternative.js';\nimport { ImageBlockEditing } from './image/imageblockediting.js';\nimport { ImageInsertUI } from './imageinsert/imageinsertui.js';\n\nimport '../theme/image.css';\n\n/**\n * The image block plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/image/imageblockediting~ImageBlockEditing},\n * * {@link module:image/imagetextalternative~ImageTextAlternative}.\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */\nexport class ImageBlock extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageBlockEditing, Widget, ImageTextAlternative, ImageInsertUI ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageBlock' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image/imageinlineediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ClipboardPipeline, type ClipboardInputTransformationEvent, type ClipboardContentInsertionEvent } from 'ckeditor5/src/clipboard.js';\nimport { ViewUpcastWriter, type ViewElement } from 'ckeditor5/src/engine.js';\n\nimport {\n\tdowncastImageAttribute,\n\tdowncastSrcsetAttribute\n} from './converters.js';\n\nimport { ImageEditing } from './imageediting.js';\nimport { ImageSizeAttributes } from '../imagesizeattributes.js';\nimport { ImageTypeCommand } from './imagetypecommand.js';\nimport { ImageUtils } from '../imageutils.js';\nimport {\n\tgetImgViewElementMatcher,\n\tcreateInlineImageViewElement,\n\tdetermineImageTypeForInsertionAtSelection\n} from './utils.js';\nimport { ImagePlaceholder } from './imageplaceholder.js';\n\n/**\n * The image inline plugin.\n *\n * It registers:\n *\n * * `<imageInline>` as an inline element in the document schema, and allows `alt`, `src` and `srcset` attributes.\n * * converters for editing and data pipelines.\n * * {@link module:image/image/imagetypecommand~ImageTypeCommand `'imageTypeInline'`} command that converts block images into\n * inline images.\n */\nexport class ImageInlineEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageEditing, ImageSizeAttributes, ImageUtils, ImagePlaceholder, ClipboardPipeline ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageInlineEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst schema = editor.model.schema;\n\n\t\t// Converters 'alt' and 'srcset' are added in 'ImageEditing' plugin.\n\t\tschema.register( 'imageInline', {\n\t\t\tinheritAllFrom: '$inlineObject',\n\t\t\tallowAttributes: [ 'alt', 'src', 'srcset' ],\n\t\t\t// Disallow inline images in captions (at least for now).\n\t\t\t// This is the best spot to do that because independent packages can introduce captions (ImageCaption, TableCaption, etc.).\n\t\t\tdisallowIn: [ 'caption' ]\n\t\t} );\n\n\t\tthis._setupConversion();\n\n\t\tif ( editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\teditor.commands.add( 'imageTypeInline', new ImageTypeCommand( this.editor, 'imageInline' ) );\n\n\t\t\tthis._setupClipboardIntegration();\n\t\t}\n\t}\n\n\t/**\n\t * Configures conversion pipelines to support upcasting and downcasting\n\t * inline images (inline image widgets) and their attributes.\n\t */\n\tprivate _setupConversion(): void {\n\t\tconst editor = this.editor;\n\t\tconst t = editor.t;\n\t\tconst conversion = editor.conversion;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tconversion.for( 'dataDowncast' )\n\t\t\t.elementToElement( {\n\t\t\t\tmodel: 'imageInline',\n\t\t\t\tview: ( modelElement, { writer } ) => writer.createEmptyElement( 'img' )\n\t\t\t} );\n\n\t\tconversion.for( 'editingDowncast' )\n\t\t\t.elementToStructure( {\n\t\t\t\tmodel: 'imageInline',\n\t\t\t\tview: ( modelElement, { writer } ) => imageUtils.toImageWidget(\n\t\t\t\t\tcreateInlineImageViewElement( writer ), writer, t( 'image widget' )\n\t\t\t\t)\n\t\t\t} );\n\n\t\tconversion.for( 'downcast' )\n\t\t\t.add( downcastImageAttribute( imageUtils, 'imageInline', 'src' ) )\n\t\t\t.add( downcastImageAttribute( imageUtils, 'imageInline', 'alt' ) )\n\t\t\t.add( downcastSrcsetAttribute( imageUtils, 'imageInline' ) );\n\n\t\t// More image related upcasts are in 'ImageEditing' plugin.\n\t\tconversion.for( 'upcast' )\n\t\t\t.elementToElement( {\n\t\t\t\tview: getImgViewElementMatcher( editor, 'imageInline' ),\n\t\t\t\tmodel: ( viewImage, { writer } ) => writer.createElement(\n\t\t\t\t\t'imageInline',\n\t\t\t\t\tviewImage.hasAttribute( 'src' ) ? { src: viewImage.getAttribute( 'src' ) } : undefined\n\t\t\t\t)\n\t\t\t} );\n\t}\n\n\t/**\n\t * Integrates the plugin with the clipboard pipeline.\n\t *\n\t * Idea is that the feature should recognize the user's intent when an **block** image is\n\t * pasted or dropped. If such an image is pasted/dropped into a non-empty block\n\t * (e.g. a paragraph with some text) it gets converted into an inline image on the fly.\n\t *\n\t * We assume this is the user's intent if they decided to put their image there.\n\t *\n\t * **Note**: If a block image has a caption, it will not be converted to an inline image\n\t * to avoid the confusion. Captions are added on purpose and they should never be lost\n\t * in the clipboard pipeline.\n\t *\n\t * See the `ImageBlockEditing` for the similar integration that works in the opposite direction.\n\t *\n\t * The feature also sets image `width` and `height` attributes when pasting.\n\t */\n\tprivate _setupClipboardIntegration(): void {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst editingView = editor.editing.view;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst clipboardPipeline: ClipboardPipeline = editor.plugins.get( 'ClipboardPipeline' );\n\n\t\tthis.listenTo<ClipboardInputTransformationEvent>(\n\t\t\tclipboardPipeline,\n\t\t\t'inputTransformation',\n\t\t\t( evt, data ) => {\n\t\t\t\tconst docFragmentChildren = Array.from( data.content.getChildren() as IterableIterator<ViewElement> );\n\t\t\t\tlet modelRange;\n\n\t\t\t\t// Make sure only <figure class=\"image\"></figure> elements are dropped or pasted. Otherwise, if there some other HTML\n\t\t\t\t// mixed up, this should be handled as a regular paste.\n\t\t\t\tif ( !docFragmentChildren.every( imageUtils.isBlockImageView ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// When drag and dropping, data.targetRanges specifies where to drop because\n\t\t\t\t// this is usually a different place than the current model selection (the user\n\t\t\t\t// uses a drop marker to specify the drop location).\n\t\t\t\tif ( data.targetRanges ) {\n\t\t\t\t\tmodelRange = editor.editing.mapper.toModelRange( data.targetRanges[ 0 ] );\n\t\t\t\t}\n\t\t\t\t// Pasting, however, always occurs at the current model selection.\n\t\t\t\telse {\n\t\t\t\t\tmodelRange = model.document.selection.getFirstRange();\n\t\t\t\t}\n\n\t\t\t\tconst selection = model.createSelection( modelRange );\n\n\t\t\t\t// Convert block images into inline images only when pasting or dropping into non-empty blocks\n\t\t\t\t// and when the block is not an object (e.g. pasting to replace another widget).\n\t\t\t\tif ( determineImageTypeForInsertionAtSelection( model.schema, selection ) === 'imageInline' ) {\n\t\t\t\t\tconst writer = new ViewUpcastWriter( editingView.document );\n\n\t\t\t\t\t// Unwrap <figure class=\"image\"><img .../></figure> -> <img ... />\n\t\t\t\t\t// but <figure class=\"image\"><img .../><figcaption>...</figcaption></figure> -> stays the same\n\t\t\t\t\tconst inlineViewImages = docFragmentChildren.map( blockViewImage => {\n\t\t\t\t\t// If there's just one child, it can be either <img /> or <a><img></a>.\n\t\t\t\t\t// If there are other children than <img>, this means that the block image\n\t\t\t\t\t// has a caption or some other features and this kind of image should be\n\t\t\t\t\t// pasted/dropped without modifications.\n\t\t\t\t\t\tif ( blockViewImage.childCount === 1 ) {\n\t\t\t\t\t\t// Pass the attributes which are present only in the <figure> to the <img>\n\t\t\t\t\t\t// (e.g. the style=\"width:10%\" attribute applied by the ImageResize plugin).\n\t\t\t\t\t\t\tArray.from( blockViewImage.getAttributes() )\n\t\t\t\t\t\t\t\t.forEach( attribute => writer.setAttribute(\n\t\t\t\t\t\t\t\t\t...attribute,\n\t\t\t\t\t\t\t\t\timageUtils.findViewImgElement( blockViewImage )!\n\t\t\t\t\t\t\t\t) );\n\n\t\t\t\t\t\t\treturn blockViewImage.getChild( 0 )!;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn blockViewImage;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\tdata.content = writer.createDocumentFragment( inlineViewImages );\n\t\t\t\t}\n\t\t\t} );\n\n\t\tthis.listenTo<ClipboardContentInsertionEvent>(\n\t\t\tclipboardPipeline,\n\t\t\t'contentInsertion',\n\t\t\t( evt, data ) => {\n\t\t\t\tif ( data.method !== 'paste' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmodel.change( writer => {\n\t\t\t\t\tconst range = writer.createRangeIn( data.content );\n\n\t\t\t\t\tfor ( const item of range.getItems() ) {\n\t\t\t\t\t\tif ( item.is( 'element', 'imageInline' ) ) {\n\t\t\t\t\t\t\timageUtils.setImageNaturalSizeAttributes( item );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinline\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { Widget } from 'ckeditor5/src/widget.js';\n\nimport { ImageTextAlternative } from './imagetextalternative.js';\nimport { ImageInlineEditing } from './image/imageinlineediting.js';\nimport { ImageInsertUI } from './imageinsert/imageinsertui.js';\n\nimport '../theme/image.css';\n\n/**\n * The image inline plugin.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/image/imageinlineediting~ImageInlineEditing},\n * * {@link module:image/imagetextalternative~ImageTextAlternative}.\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */\nexport class ImageInline extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageInlineEditing, Widget, ImageTextAlternative, ImageInsertUI ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageInline' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/image\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageBlock } from './imageblock.js';\nimport { ImageInline } from './imageinline.js';\n\nimport '../theme/image.css';\n\n/**\n * The image plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-overview image feature} documentation.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n *\n * * {@link module:image/imageblock~ImageBlock},\n * * {@link module:image/imageinline~ImageInline},\n *\n * Usually, it is used in conjunction with other plugins from this package. See the {@glink api/image package page}\n * for more information.\n */\nexport class Image extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageBlock, ImageInline ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'Image' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagecaption/imagecaptionutils\n */\n\nimport type { ModelDocumentSelection, ModelElement, ModelSelection, ViewElement, Match } from 'ckeditor5/src/engine.js';\nimport { Plugin } from 'ckeditor5/src/core.js';\n\nimport { ImageUtils } from '../imageutils.js';\n\n/**\n * The image caption utilities plugin.\n */\nexport class ImageCaptionUtils extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageCaptionUtils' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * Returns the caption model element from a given image element. Returns `null` if no caption is found.\n\t */\n\tpublic getCaptionFromImageModelElement( imageModelElement: ModelElement ): ModelElement | null {\n\t\tfor ( const node of imageModelElement.getChildren() ) {\n\t\t\tif ( !!node && node.is( 'element', 'caption' ) ) {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the caption model element for a model selection. Returns `null` if the selection has no caption element ancestor.\n\t */\n\tpublic getCaptionFromModelSelection( selection: ModelSelection | ModelDocumentSelection ): ModelElement | null {\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\t\tconst captionElement = selection.getFirstPosition()!.findAncestor( 'caption' );\n\n\t\tif ( !captionElement ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( imageUtils.isBlockImage( captionElement.parent as ModelElement ) ) {\n\t\t\treturn captionElement;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * {@link module:engine/view/matcher~Matcher} pattern. Checks if a given element is a `<figcaption>` element that is placed\n\t * inside the image `<figure>` element.\n\t * @returns Returns the object accepted by {@link module:engine/view/matcher~Matcher} or `null` if the element\n\t * cannot be matched.\n\t */\n\tpublic matchImageCaptionViewElement( element: ViewElement ): Match | null {\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\t// Convert only captions for images.\n\t\tif ( element.name == 'figcaption' && imageUtils.isBlockImageView( element.parent as ViewElement ) ) {\n\t\t\treturn { name: true };\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagecaption/toggleimagecaptioncommand\n */\n\nimport type { ModelElement, ModelWriter } from 'ckeditor5/src/engine.js';\nimport { Command } from 'ckeditor5/src/core.js';\n\nimport { ImageBlockEditing } from '../image/imageblockediting.js';\nimport { type ImageCaptionUtils } from './imagecaptionutils.js';\nimport { type ImageUtils } from '../imageutils.js';\nimport { type ImageCaptionEditing } from './imagecaptionediting.js';\n\n/**\n * The toggle image caption command.\n *\n * This command is registered by {@link module:image/imagecaption/imagecaptionediting~ImageCaptionEditing} as the\n * `'toggleImageCaption'` editor command.\n *\n * Executing this command:\n *\n * * either adds or removes the image caption of a selected image (depending on whether the caption is present or not),\n * * removes the image caption if the selection is anchored in one.\n *\n * ```ts\n * // Toggle the presence of the caption.\n * editor.execute( 'toggleImageCaption' );\n * ```\n *\n * **Note**: Upon executing this command, the selection will be set on the image if previously anchored in the caption element.\n *\n * **Note**: You can move the selection to the caption right away as it shows up upon executing this command by using\n * the `focusCaptionOnShow` option:\n *\n * ```ts\n * editor.execute( 'toggleImageCaption', { focusCaptionOnShow: true } );\n * ```\n */\nexport class ToggleImageCaptionCommand extends Command {\n\tdeclare public value: boolean;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageCaptionUtils: ImageCaptionUtils = editor.plugins.get( 'ImageCaptionUtils' );\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\t// Only block images can get captions.\n\t\tif ( !editor.plugins.has( ImageBlockEditing ) ) {\n\t\t\tthis.isEnabled = false;\n\t\t\tthis.value = false;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst selection = editor.model.document.selection;\n\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\tif ( !selectedElement ) {\n\t\t\tconst ancestorCaptionElement = imageCaptionUtils.getCaptionFromModelSelection( selection );\n\n\t\t\tthis.isEnabled = !!ancestorCaptionElement;\n\t\t\tthis.value = !!ancestorCaptionElement;\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Block images support captions by default but the command should also be enabled for inline\n\t\t// images because toggling the caption when one is selected should convert it into a block image.\n\t\tthis.isEnabled = imageUtils.isImage( selectedElement );\n\n\t\tif ( !this.isEnabled ) {\n\t\t\tthis.value = false;\n\t\t} else {\n\t\t\tthis.value = !!imageCaptionUtils.getCaptionFromImageModelElement( selectedElement );\n\t\t}\n\t}\n\n\t/**\n\t * Executes the command.\n\t *\n\t * ```ts\n\t * editor.execute( 'toggleImageCaption' );\n\t * ```\n\t *\n\t * @param options Options for the executed command.\n\t * @param options.focusCaptionOnShow When true and the caption shows up, the selection will be moved into it straight away.\n\t * @fires execute\n\t */\n\tpublic override execute( options: { focusCaptionOnShow?: boolean } = {} ): void {\n\t\tconst { focusCaptionOnShow } = options;\n\n\t\tthis.editor.model.change( writer => {\n\t\t\tif ( this.value ) {\n\t\t\t\tthis._hideImageCaption( writer );\n\t\t\t} else {\n\t\t\t\tthis._showImageCaption( writer, focusCaptionOnShow );\n\t\t\t}\n\t\t} );\n\t}\n\n\t/**\n\t * Shows the caption of the `<imageBlock>` or `<imageInline>`. Also:\n\t *\n\t * * it converts `<imageInline>` to `<imageBlock>` to show the caption,\n\t * * it attempts to restore the caption content from the `ImageCaptionEditing` caption registry,\n\t * * it moves the selection to the caption right away, it the `focusCaptionOnShow` option was set.\n\t */\n\tprivate _showImageCaption( writer: ModelWriter, focusCaptionOnShow?: boolean ): void {\n\t\tconst model = this.editor.model;\n\t\tconst selection = model.document.selection;\n\t\tconst imageCaptionEditing: ImageCaptionEditing = this.editor.plugins.get( 'ImageCaptionEditing' );\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\tlet selectedImage = selection.getSelectedElement()!;\n\n\t\tconst savedCaption = imageCaptionEditing._getSavedCaption( selectedImage );\n\n\t\t// Convert imageInline -> image first.\n\t\tif ( imageUtils.isInlineImage( selectedImage ) ) {\n\t\t\tthis.editor.execute( 'imageTypeBlock' );\n\n\t\t\t// Executing the command created a new model element. Let's pick it again.\n\t\t\tselectedImage = selection.getSelectedElement()!;\n\t\t}\n\n\t\t// Try restoring the caption from the ImageCaptionEditing plugin storage.\n\t\tconst newCaptionElement = savedCaption || writer.createElement( 'caption' );\n\n\t\twriter.append( newCaptionElement, selectedImage );\n\n\t\tif ( focusCaptionOnShow ) {\n\t\t\twriter.setSelection( newCaptionElement, 'in' );\n\t\t}\n\t}\n\n\t/**\n\t * Hides the caption of a selected image (or an image caption the selection is anchored to).\n\t *\n\t * The content of the caption is stored in the `ImageCaptionEditing` caption registry to make this\n\t * a reversible action.\n\t */\n\tprivate _hideImageCaption( writer: ModelWriter ): void {\n\t\tconst editor = this.editor;\n\t\tconst selection = editor.model.document.selection;\n\t\tconst imageCaptionEditing: ImageCaptionEditing = editor.plugins.get( 'ImageCaptionEditing' );\n\t\tconst imageCaptionUtils: ImageCaptionUtils = editor.plugins.get( 'ImageCaptionUtils' );\n\t\tlet selectedImage = selection.getSelectedElement()!;\n\t\tlet captionElement: ModelElement;\n\n\t\tif ( selectedImage ) {\n\t\t\tcaptionElement = imageCaptionUtils.getCaptionFromImageModelElement( selectedImage )!;\n\t\t} else {\n\t\t\tcaptionElement = imageCaptionUtils.getCaptionFromModelSelection( selection )!;\n\t\t\tselectedImage = captionElement!.parent as ModelElement;\n\t\t}\n\n\t\t// Store the caption content so it can be restored quickly if the user changes their mind even if they toggle image<->imageInline.\n\t\timageCaptionEditing._saveCaption( selectedImage, captionElement );\n\n\t\twriter.setSelection( selectedImage, 'on' );\n\t\twriter.remove( captionElement );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagecaption/imagecaptionediting\n */\n\nimport { type Editor, Plugin, type CommandExecuteEvent } from 'ckeditor5/src/core.js';\nimport { ModelElement, enableViewPlaceholder, type ModelDocumentChangeEvent, type DifferItemAttribute } from 'ckeditor5/src/engine.js';\nimport { toWidgetEditable } from 'ckeditor5/src/widget.js';\nimport type { GetCallback } from 'ckeditor5/src/utils.js';\n\nimport { ToggleImageCaptionCommand } from './toggleimagecaptioncommand.js';\nimport { ImageUtils } from '../imageutils.js';\nimport { ImageCaptionUtils } from './imagecaptionutils.js';\n\n/**\n * The image caption engine plugin. It is responsible for:\n *\n * * registering converters for the caption element,\n * * registering converters for the caption model attribute,\n * * registering the {@link module:image/imagecaption/toggleimagecaptioncommand~ToggleImageCaptionCommand `toggleImageCaption`} command.\n */\nexport class ImageCaptionEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils, ImageCaptionUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageCaptionEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * A map that keeps saved JSONified image captions and image model elements they are\n\t * associated with.\n\t *\n\t * To learn more about this system, see {@link #_saveCaption}.\n\t */\n\tprivate _savedCaptionsMap: WeakMap<ModelElement, unknown>;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tthis._savedCaptionsMap = new WeakMap();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst schema = editor.model.schema;\n\n\t\t// Schema configuration.\n\t\tif ( !schema.isRegistered( 'caption' ) ) {\n\t\t\tschema.register( 'caption', {\n\t\t\t\tallowIn: 'imageBlock',\n\t\t\t\tallowContentOf: '$block',\n\t\t\t\tisLimit: true\n\t\t\t} );\n\t\t} else {\n\t\t\tschema.extend( 'caption', {\n\t\t\t\tallowIn: 'imageBlock'\n\t\t\t} );\n\t\t}\n\n\t\teditor.commands.add( 'toggleImageCaption', new ToggleImageCaptionCommand( this.editor ) );\n\n\t\tthis._setupConversion();\n\t\tthis._setupImageTypeCommandsIntegration();\n\t\tthis._registerCaptionReconversion();\n\t}\n\n\t/**\n\t * Configures conversion pipelines to support upcasting and downcasting\n\t * image captions.\n\t */\n\tprivate _setupConversion(): void {\n\t\tconst editor = this.editor;\n\t\tconst view = editor.editing.view;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst imageCaptionUtils: ImageCaptionUtils = editor.plugins.get( 'ImageCaptionUtils' );\n\t\tconst t = editor.t;\n\n\t\t// View -> model converter for the data pipeline.\n\t\teditor.conversion.for( 'upcast' ).elementToElement( {\n\t\t\tview: element => imageCaptionUtils.matchImageCaptionViewElement( element ),\n\t\t\tmodel: 'caption'\n\t\t} );\n\n\t\t// Model -> view converter for the data pipeline.\n\t\teditor.conversion.for( 'dataDowncast' ).elementToElement( {\n\t\t\tmodel: 'caption',\n\t\t\tview: ( modelElement, { writer } ) => {\n\t\t\t\tif ( !imageUtils.isBlockImage( modelElement.parent as ModelElement ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn writer.createContainerElement( 'figcaption' );\n\t\t\t}\n\t\t} );\n\n\t\t// Model -> view converter for the editing pipeline.\n\t\teditor.conversion.for( 'editingDowncast' ).elementToElement( {\n\t\t\tmodel: 'caption',\n\t\t\tview: ( modelElement, { writer } ) => {\n\t\t\t\tif ( !imageUtils.isBlockImage( modelElement.parent as ModelElement ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst figcaptionElement = writer.createEditableElement( 'figcaption' );\n\t\t\t\twriter.setCustomProperty( 'imageCaption', true, figcaptionElement );\n\n\t\t\t\tfigcaptionElement.placeholder = t( 'Enter image caption' );\n\t\t\t\tenableViewPlaceholder( {\n\t\t\t\t\tview,\n\t\t\t\t\telement: figcaptionElement,\n\t\t\t\t\tkeepOnFocus: true\n\t\t\t\t} );\n\n\t\t\t\tconst imageAlt = ( modelElement.parent as ModelElement ).getAttribute( 'alt' ) as string;\n\t\t\t\tconst label = imageAlt ? t( 'Caption for image: %0', [ imageAlt ] ) : t( 'Caption for the image' );\n\n\t\t\t\treturn toWidgetEditable( figcaptionElement, writer, { label } );\n\t\t\t}\n\t\t} );\n\t}\n\n\t/**\n\t * Integrates with {@link module:image/image/imagetypecommand~ImageTypeCommand image type commands}\n\t * to make sure the caption is preserved when the type of an image changes so it can be restored\n\t * in the future if the user decides they want their caption back.\n\t */\n\tprivate _setupImageTypeCommandsIntegration(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst imageCaptionUtils: ImageCaptionUtils = editor.plugins.get( 'ImageCaptionUtils' );\n\t\tconst imageTypeInlineCommand = editor.commands.get( 'imageTypeInline' );\n\t\tconst imageTypeBlockCommand = editor.commands.get( 'imageTypeBlock' );\n\n\t\tconst handleImageTypeChange: GetCallback<CommandExecuteEvent> = evt => {\n\t\t\t// The image type command execution can be unsuccessful.\n\t\t\tif ( !evt.return ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { oldElement, newElement } = evt.return as { oldElement: ModelElement; newElement: ModelElement };\n\n\t\t\t/* istanbul ignore if: paranoid check -- @preserve */\n\t\t\tif ( !oldElement ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( imageUtils.isBlockImage( oldElement ) ) {\n\t\t\t\tconst oldCaptionElement = imageCaptionUtils.getCaptionFromImageModelElement( oldElement );\n\n\t\t\t\t// If the old element was a captioned block image (the caption was visible),\n\t\t\t\t// simply save it so it can be restored.\n\t\t\t\tif ( oldCaptionElement ) {\n\t\t\t\t\tthis._saveCaption( newElement, oldCaptionElement );\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst savedOldElementCaption = this._getSavedCaption( oldElement );\n\n\t\t\t// If either:\n\t\t\t//\n\t\t\t// * the block image didn't have a visible caption,\n\t\t\t// * the block image caption was hidden (and already saved),\n\t\t\t// * the inline image was passed\n\t\t\t//\n\t\t\t// just try to \"pass\" the saved caption from the old image to the new image\n\t\t\t// so it can be retrieved in the future if the user wants it back.\n\t\t\tif ( savedOldElementCaption ) {\n\t\t\t\t// Note: Since we're writing to a WeakMap, we don't bother with removing the\n\t\t\t\t// [ oldElement, savedOldElementCaption ] pair from it.\n\t\t\t\tthis._saveCaption( newElement, savedOldElementCaption );\n\t\t\t}\n\t\t};\n\n\t\t// Presence of the commands depends on the Image(Inline|Block)Editing plugins loaded in the editor.\n\t\tif ( imageTypeInlineCommand ) {\n\t\t\tthis.listenTo<CommandExecuteEvent>( imageTypeInlineCommand, 'execute', handleImageTypeChange, { priority: 'low' } );\n\t\t}\n\n\t\tif ( imageTypeBlockCommand ) {\n\t\t\tthis.listenTo<CommandExecuteEvent>( imageTypeBlockCommand, 'execute', handleImageTypeChange, { priority: 'low' } );\n\t\t}\n\t}\n\n\t/**\n\t * Returns the saved {@link module:engine/model/element~ModelElement#toJSON JSONified} caption\n\t * of an image model element.\n\t *\n\t * See {@link #_saveCaption}.\n\t *\n\t * @internal\n\t * @param imageModelElement The model element the caption should be returned for.\n\t * @returns The model caption element or `null` if there is none.\n\t */\n\tpublic _getSavedCaption( imageModelElement: ModelElement ): ModelElement | null {\n\t\tconst jsonObject = this._savedCaptionsMap.get( imageModelElement );\n\n\t\treturn jsonObject ? ModelElement.fromJSON( jsonObject ) : null;\n\t}\n\n\t/**\n\t * Saves a {@link module:engine/model/element~ModelElement#toJSON JSONified} caption for\n\t * an image element to allow restoring it in the future.\n\t *\n\t * A caption is saved every time it gets hidden and/or the type of an image changes. The\n\t * user should be able to restore it on demand.\n\t *\n\t * **Note**: The caption cannot be stored in the image model element attribute because,\n\t * for instance, when the model state propagates to collaborators, the attribute would get\n\t * lost (mainly because it does not convert to anything when the caption is hidden) and\n\t * the states of collaborators' models would de-synchronize causing numerous issues.\n\t *\n\t * See {@link #_getSavedCaption}.\n\t *\n\t * @internal\n\t * @param imageModelElement The model element the caption is saved for.\n\t * @param caption The caption model element to be saved.\n\t */\n\tpublic _saveCaption( imageModelElement: ModelElement, caption: ModelElement ): void {\n\t\tthis._savedCaptionsMap.set( imageModelElement, caption.toJSON() );\n\t}\n\n\t/**\n\t * Reconverts image caption when image alt attribute changes.\n\t * The change of alt attribute is reflected in caption's aria-label attribute.\n\t */\n\tprivate _registerCaptionReconversion(): void {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst imageCaptionUtils: ImageCaptionUtils = editor.plugins.get( 'ImageCaptionUtils' );\n\n\t\tmodel.document.on<ModelDocumentChangeEvent>( 'change:data', () => {\n\t\t\tconst changes = model.document.differ.getChanges();\n\n\t\t\tfor ( const change of changes as Array<DifferItemAttribute> ) {\n\t\t\t\tif ( change.attributeKey !== 'alt' ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst image = change.range.start.nodeAfter as ModelElement;\n\n\t\t\t\tif ( imageUtils.isBlockImage( image ) ) {\n\t\t\t\t\tconst caption = imageCaptionUtils.getCaptionFromImageModelElement( image );\n\n\t\t\t\t\tif ( !caption ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.editing.reconvertItem( caption );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagecaption/imagecaptionui\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ButtonView } from 'ckeditor5/src/ui.js';\nimport { IconCaption } from 'ckeditor5/src/icons.js';\nimport { ImageCaptionUtils } from './imagecaptionutils.js';\nimport { type ToggleImageCaptionCommand } from './toggleimagecaptioncommand.js';\n\n/**\n * The image caption UI plugin. It introduces the `'toggleImageCaption'` UI button.\n */\nexport class ImageCaptionUI extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageCaptionUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageCaptionUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst editingView = editor.editing.view;\n\t\tconst imageCaptionUtils: ImageCaptionUtils = editor.plugins.get( 'ImageCaptionUtils' );\n\t\tconst t = editor.t;\n\n\t\teditor.ui.componentFactory.add( 'toggleImageCaption', locale => {\n\t\t\tconst command: ToggleImageCaptionCommand = editor.commands.get( 'toggleImageCaption' )!;\n\t\t\tconst view = new ButtonView( locale );\n\n\t\t\tview.set( {\n\t\t\t\ticon: IconCaption,\n\t\t\t\ttooltip: true,\n\t\t\t\tisToggleable: true\n\t\t\t} );\n\n\t\t\tview.bind( 'isOn', 'isEnabled' ).to( command, 'value', 'isEnabled' );\n\t\t\tview.bind( 'label' ).to( command, 'value', value => value ? t( 'Toggle caption off' ) : t( 'Toggle caption on' ) );\n\n\t\t\tthis.listenTo( view, 'execute', () => {\n\t\t\t\teditor.execute( 'toggleImageCaption', { focusCaptionOnShow: true } );\n\n\t\t\t\t// Scroll to the selection and highlight the caption if the caption showed up.\n\t\t\t\tconst modelCaptionElement = imageCaptionUtils.getCaptionFromModelSelection( editor.model.document.selection );\n\n\t\t\t\tif ( modelCaptionElement ) {\n\t\t\t\t\tconst figcaptionElement = editor.editing.mapper.toViewElement( modelCaptionElement );\n\n\t\t\t\t\teditingView.scrollToTheSelection();\n\n\t\t\t\t\teditingView.change( writer => {\n\t\t\t\t\t\twriter.addClass( 'image__caption_highlighted', figcaptionElement! );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\teditor.editing.view.focus();\n\t\t\t} );\n\n\t\t\treturn view;\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagecaption\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageCaptionEditing } from './imagecaption/imagecaptionediting.js';\nimport { ImageCaptionUI } from './imagecaption/imagecaptionui.js';\n\nimport '../theme/imagecaption.css';\n\n/**\n * The image caption plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-captions image caption} documentation.\n */\nexport class ImageCaption extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageCaptionEditing, ImageCaptionUI ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageCaption' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageupload/utils\n */\n\nimport type { ViewElement } from 'ckeditor5/src/engine.js';\nimport { global } from 'ckeditor5/src/utils.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * Creates a regular expression used to test for image files.\n *\n * ```ts\n * const imageType = createImageTypeRegExp( [ 'png', 'jpeg', 'svg+xml', 'vnd.microsoft.icon' ] );\n *\n * console.log( 'is supported image', imageType.test( file.type ) );\n * ```\n */\nexport function createImageTypeRegExp( types: Array<string> ): RegExp {\n\t// Sanitize the MIME type name which may include: \"+\", \"-\" or \".\".\n\tconst regExpSafeNames = types.map( type => type.replace( '+', '\\\\+' ) );\n\n\treturn new RegExp( `^image\\\\/(${ regExpSafeNames.join( '|' ) })$` );\n}\n\n/**\n * Creates a promise that fetches the image local source (Base64 or blob) and resolves with a `File` object.\n *\n * @internal\n * @param image Image whose source to fetch.\n * @returns A promise which resolves when an image source is fetched and converted to a `File` instance.\n * It resolves with a `File` object. If there were any errors during file processing, the promise will be rejected.\n */\nexport function fetchLocalImage( image: ViewElement ): Promise<File> {\n\treturn new Promise( ( resolve, reject ) => {\n\t\tconst imageSrc = image.getAttribute( 'src' )!;\n\n\t\t// Fetch works asynchronously and so does not block browser UI when processing data.\n\t\tfetch( imageSrc )\n\t\t\t.then( resource => resource.blob() )\n\t\t\t.then( blob => {\n\t\t\t\tconst mimeType = getImageMimeType( blob, imageSrc );\n\t\t\t\tconst ext = mimeType.replace( 'image/', '' );\n\t\t\t\tconst filename = `image.${ ext }`;\n\t\t\t\tconst file = new File( [ blob ], filename, { type: mimeType } );\n\n\t\t\t\tresolve( file );\n\t\t\t} )\n\t\t\t.catch( err => {\n\t\t\t\t// Fetch fails only, if it can't make a request due to a network failure or if anything prevented the request\n\t\t\t\t// from completing, i.e. the Content Security Policy rules. It is not possible to detect the exact cause of failure,\n\t\t\t\t// so we are just trying the fallback solution, if general TypeError is thrown.\n\t\t\t\treturn err && err.name === 'TypeError' ?\n\t\t\t\t\tconvertLocalImageOnCanvas( imageSrc ).then( resolve ).catch( reject ) :\n\t\t\t\t\treject( err );\n\t\t\t} );\n\t} );\n}\n\n/**\n * Checks whether a given node is an image element with a local source (Base64 or blob).\n *\n * @param node The node to check.\n * @internal\n */\nexport function isLocalImage( imageUtils: ImageUtils, node: ViewElement ): boolean {\n\tif ( !imageUtils.isInlineImageView( node ) || !node.getAttribute( 'src' ) ) {\n\t\treturn false;\n\t}\n\n\treturn !!node.getAttribute( 'src' )!.match( /^data:image\\/\\w+;base64,/g ) ||\n\t\t!!node.getAttribute( 'src' )!.match( /^blob:/g );\n}\n\n/**\n * Extracts an image type based on its blob representation or its source.\n * @param blob Image blob representation.\n * @param src Image `src` attribute value.\n */\nfunction getImageMimeType( blob: Blob, src: string ): string {\n\tif ( blob.type ) {\n\t\treturn blob.type;\n\t} else if ( src.match( /data:(image\\/\\w+);base64/ ) ) {\n\t\treturn src.match( /data:(image\\/\\w+);base64/ )![ 1 ].toLowerCase();\n\t} else {\n\t\t// Fallback to 'jpeg' as common extension.\n\t\treturn 'image/jpeg';\n\t}\n}\n\n/**\n * Creates a promise that converts the image local source (Base64 or blob) to a blob using canvas and resolves\n * with a `File` object.\n * @param imageSrc Image `src` attribute value.\n * @returns A promise which resolves when an image source is converted to a `File` instance.\n * It resolves with a `File` object. If there were any errors during file processing, the promise will be rejected.\n */\nfunction convertLocalImageOnCanvas( imageSrc: string ): Promise<File> {\n\treturn getBlobFromCanvas( imageSrc ).then( blob => {\n\t\tconst mimeType = getImageMimeType( blob, imageSrc );\n\t\tconst ext = mimeType.replace( 'image/', '' );\n\t\tconst filename = `image.${ ext }`;\n\n\t\treturn new File( [ blob ], filename, { type: mimeType } );\n\t} );\n}\n\n/**\n * Creates a promise that resolves with a `Blob` object converted from the image source (Base64 or blob).\n * @param imageSrc Image `src` attribute value.\n */\nfunction getBlobFromCanvas( imageSrc: string ): Promise<Blob> {\n\treturn new Promise( ( resolve, reject ) => {\n\t\tconst image = global.document.createElement( 'img' );\n\n\t\timage.addEventListener( 'load', () => {\n\t\t\tconst canvas = global.document.createElement( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst ctx = canvas.getContext( '2d' )!;\n\n\t\t\tctx.drawImage( image, 0, 0 );\n\n\t\t\tcanvas.toBlob( blob => blob ? resolve( blob ) : reject() );\n\t\t} );\n\n\t\timage.addEventListener( 'error', () => reject() );\n\n\t\timage.src = imageSrc;\n\t} );\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageupload/imageuploadui\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport {\n\tFileDialogButtonView,\n\tMenuBarMenuListItemFileDialogButtonView,\n\ttype ButtonView,\n\ttype MenuBarMenuListItemButtonView\n} from 'ckeditor5/src/ui.js';\nimport { IconImageUpload } from 'ckeditor5/src/icons.js';\nimport { createImageTypeRegExp } from './utils.js';\nimport { type ImageInsertUI } from '../imageinsert/imageinsertui.js';\n\n/**\n * The image upload button plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature} documentation.\n *\n * Adds the `'uploadImage'` button to the {@link module:ui/componentfactory~ComponentFactory UI component factory}\n * and also the `imageUpload` button as an alias for backward compatibility.\n *\n * Adds the `'menuBar:uploadImage'` menu button to the {@link module:ui/componentfactory~ComponentFactory UI component factory}.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component, which are the default components\n * through which image upload is available.\n */\nexport class ImageUploadUI extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageUploadUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\n\t\t// Setup `uploadImage` button and add `imageUpload` button as an alias for backward compatibility.\n\t\teditor.ui.componentFactory.add( 'uploadImage', () => this._createToolbarButton() );\n\t\teditor.ui.componentFactory.add( 'imageUpload', () => this._createToolbarButton() );\n\n\t\teditor.ui.componentFactory.add( 'menuBar:uploadImage', () => this._createMenuBarButton( 'standalone' ) );\n\n\t\tif ( editor.plugins.has( 'ImageInsertUI' ) ) {\n\t\t\teditor.plugins.get( 'ImageInsertUI' ).registerIntegration( {\n\t\t\t\tname: 'upload',\n\t\t\t\tobservable: () => editor.commands.get( 'uploadImage' )!,\n\t\t\t\tbuttonViewCreator: () => this._createToolbarButton(),\n\t\t\t\tformViewCreator: () => this._createDropdownButton(),\n\t\t\t\tmenuBarButtonViewCreator: isOnly => this._createMenuBarButton( isOnly ? 'insertOnly' : 'insertNested' )\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Creates the base for various kinds of the button component provided by this feature.\n\t */\n\tprivate _createButton<T extends typeof FileDialogButtonView | typeof MenuBarMenuListItemFileDialogButtonView>(\n\t\tButtonClass: T\n\t): InstanceType<T> {\n\t\tconst editor = this.editor;\n\t\tconst locale = editor.locale;\n\t\tconst command = editor.commands.get( 'uploadImage' )!;\n\t\tconst imageTypes = editor.config.get( 'image.upload.types' )!;\n\t\tconst imageTypesRegExp = createImageTypeRegExp( imageTypes );\n\n\t\tconst view = new ButtonClass( editor.locale ) as InstanceType<T>;\n\t\tconst t = locale.t;\n\n\t\tview.set( {\n\t\t\tacceptedType: imageTypes.map( type => `image/${ type }` ).join( ',' ),\n\t\t\tallowMultipleFiles: true,\n\t\t\tlabel: t( 'Upload from computer' ),\n\t\t\ticon: IconImageUpload\n\t\t} );\n\n\t\tview.bind( 'isEnabled' ).to( command );\n\n\t\tview.on( 'done', ( evt, files: FileList ) => {\n\t\t\tconst imagesToUpload = Array.from( files ).filter( file => imageTypesRegExp.test( file.type ) );\n\n\t\t\tif ( imagesToUpload.length ) {\n\t\t\t\teditor.execute( 'uploadImage', { file: imagesToUpload } );\n\n\t\t\t\teditor.editing.view.focus();\n\t\t\t}\n\t\t} );\n\n\t\treturn view;\n\t}\n\n\t/**\n\t * Creates a simple toolbar button, with an icon and a tooltip.\n\t */\n\tprivate _createToolbarButton(): ButtonView {\n\t\tconst t = this.editor.locale.t;\n\t\tconst imageInsertUI: ImageInsertUI = this.editor.plugins.get( 'ImageInsertUI' );\n\t\tconst uploadImageCommand = this.editor.commands.get( 'uploadImage' )!;\n\n\t\tconst button = this._createButton( FileDialogButtonView );\n\n\t\tbutton.tooltip = true;\n\t\tbutton.bind( 'label' ).to(\n\t\t\timageInsertUI,\n\t\t\t'isImageSelected',\n\t\t\tuploadImageCommand,\n\t\t\t'isAccessAllowed',\n\t\t\t( isImageSelected, isAccessAllowed ) => {\n\t\t\t\tif ( !isAccessAllowed ) {\n\t\t\t\t\treturn t( 'You have no image upload permissions.' );\n\t\t\t\t}\n\n\t\t\t\treturn isImageSelected ? t( 'Replace image from computer' ) : t( 'Upload image from computer' );\n\t\t\t}\n\t\t);\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Creates a button for the dropdown view, with an icon, text and no tooltip.\n\t */\n\tprivate _createDropdownButton(): ButtonView {\n\t\tconst t = this.editor.locale.t;\n\t\tconst imageInsertUI: ImageInsertUI = this.editor.plugins.get( 'ImageInsertUI' );\n\n\t\tconst button = this._createButton( FileDialogButtonView );\n\n\t\tbutton.withText = true;\n\n\t\tbutton.bind( 'label' ).to(\n\t\t\timageInsertUI,\n\t\t\t'isImageSelected',\n\t\t\tisImageSelected => isImageSelected ? t( 'Replace from computer' ) : t( 'Upload from computer' )\n\t\t);\n\n\t\tbutton.on( 'execute', () => {\n\t\t\timageInsertUI.dropdownView!.isOpen = false;\n\t\t} );\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Creates a button for the menu bar.\n\t */\n\tprivate _createMenuBarButton( type: 'standalone' | 'insertOnly' | 'insertNested' ): MenuBarMenuListItemButtonView {\n\t\tconst t = this.editor.locale.t;\n\t\tconst button = this._createButton( MenuBarMenuListItemFileDialogButtonView );\n\n\t\tbutton.withText = true;\n\n\t\tswitch ( type ) {\n\t\t\tcase 'standalone':\n\t\t\t\tbutton.label = t( 'Image from computer' );\n\t\t\t\tbreak;\n\t\t\tcase 'insertOnly':\n\t\t\t\tbutton.label = t( 'Image' );\n\t\t\t\tbreak;\n\t\t\tcase 'insertNested':\n\t\t\t\tbutton.label = t( 'From computer' );\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn button;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageupload/imageuploadprogress\n */\n\nimport { type Editor, Plugin } from 'ckeditor5/src/core.js';\nimport { FileRepository, type FileLoader } from 'ckeditor5/src/upload.js';\n\nimport '../../theme/imageuploadprogress.css';\nimport '../../theme/imageuploadicon.css';\nimport '../../theme/imageuploadloader.css';\nimport type { GetCallback } from 'ckeditor5/src/utils.js';\nimport type {\n\tViewDowncastWriter,\n\tEditingView,\n\tViewElement,\n\tViewContainerElement,\n\tViewUIElement,\n\tDowncastAttributeEvent,\n\tModelElement\n} from 'ckeditor5/src/engine.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * The image upload progress plugin.\n * It shows a placeholder when the image is read from the disk and a progress bar while the image is uploading.\n */\nexport class ImageUploadProgress extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageUploadProgress' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * The image placeholder that is displayed before real image data can be accessed.\n\t *\n\t * For the record, this image is a 1x1 px GIF with an aspect ratio set by CSS.\n\t */\n\tprivate placeholder: string;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tthis.placeholder = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\n\t\t// Upload status change - update image's view according to that status.\n\t\tif ( editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\teditor.editing.downcastDispatcher.on<DowncastAttributeEvent>(\n\t\t\t\t'attribute:uploadStatus:imageBlock',\n\t\t\t\tthis.uploadStatusChange\n\t\t\t);\n\t\t}\n\n\t\tif ( editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\teditor.editing.downcastDispatcher.on<DowncastAttributeEvent>(\n\t\t\t\t'attribute:uploadStatus:imageInline',\n\t\t\t\tthis.uploadStatusChange\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * This method is called each time the image `uploadStatus` attribute is changed.\n\t *\n\t * @param evt An object containing information about the fired event.\n\t * @param data Additional information about the change.\n\t */\n\tprivate uploadStatusChange: GetCallback<DowncastAttributeEvent> = ( evt, data, conversionApi ) => {\n\t\tconst editor = this.editor;\n\t\tconst modelImage = data.item as ModelElement;\n\t\tconst uploadId = modelImage.getAttribute( 'uploadId' ) as string | number;\n\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst fileRepository = editor.plugins.get( FileRepository );\n\t\tconst status = uploadId ? data.attributeNewValue : null;\n\t\tconst placeholder = this.placeholder;\n\t\tconst viewFigure = editor.editing.mapper.toViewElement( modelImage )! as ViewContainerElement;\n\t\tconst viewWriter = conversionApi.writer;\n\n\t\tif ( status == 'reading' ) {\n\t\t\t// Start \"appearing\" effect and show placeholder with infinite progress bar on the top\n\t\t\t// while image is read from disk.\n\t\t\t_startAppearEffect( viewFigure, viewWriter );\n\t\t\t_showPlaceholder( imageUtils, placeholder, viewFigure, viewWriter );\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Show progress bar on the top of the image when image is uploading.\n\t\tif ( status == 'uploading' ) {\n\t\t\tconst loader = fileRepository.loaders.get( uploadId );\n\n\t\t\t// Start appear effect if needed - see https://github.com/ckeditor/ckeditor5-image/issues/191.\n\t\t\t_startAppearEffect( viewFigure, viewWriter );\n\n\t\t\tif ( !loader ) {\n\t\t\t\t// There is no loader associated with uploadId - this means that image came from external changes.\n\t\t\t\t// In such cases we still want to show the placeholder until image is fully uploaded.\n\t\t\t\t// Show placeholder if needed - see https://github.com/ckeditor/ckeditor5-image/issues/191.\n\t\t\t\t_showPlaceholder( imageUtils, placeholder, viewFigure, viewWriter );\n\t\t\t} else {\n\t\t\t\t// Hide placeholder and initialize progress bar showing upload progress.\n\t\t\t\t_hidePlaceholder( viewFigure, viewWriter );\n\t\t\t\t_showProgressBar( viewFigure, viewWriter, loader, editor.editing.view );\n\t\t\t\t_displayLocalImage( imageUtils, viewFigure!, viewWriter, loader );\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( status == 'complete' && fileRepository.loaders.get( uploadId ) ) {\n\t\t\t_showCompleteIcon( viewFigure, viewWriter, editor.editing.view );\n\t\t}\n\n\t\t// Clean up.\n\t\t_hideProgressBar( viewFigure, viewWriter );\n\t\t_hidePlaceholder( viewFigure, viewWriter );\n\t\t_stopAppearEffect( viewFigure, viewWriter );\n\t};\n}\n\n/**\n * Adds ck-appear class to the image figure if one is not already applied.\n */\nfunction _startAppearEffect( viewFigure: ViewContainerElement, writer: ViewDowncastWriter ) {\n\tif ( !viewFigure.hasClass( 'ck-appear' ) ) {\n\t\twriter.addClass( 'ck-appear', viewFigure );\n\t}\n}\n\n/**\n * Removes ck-appear class to the image figure if one is not already removed.\n */\nfunction _stopAppearEffect( viewFigure: ViewContainerElement, writer: ViewDowncastWriter ) {\n\twriter.removeClass( 'ck-appear', viewFigure );\n}\n\n/**\n * Shows placeholder together with infinite progress bar on given image figure.\n */\nfunction _showPlaceholder( imageUtils: ImageUtils, placeholder: string, viewFigure: ViewContainerElement, writer: ViewDowncastWriter ) {\n\tif ( !viewFigure.hasClass( 'ck-image-upload-placeholder' ) ) {\n\t\twriter.addClass( 'ck-image-upload-placeholder', viewFigure );\n\t}\n\n\tconst viewImg = imageUtils.findViewImgElement( viewFigure )!;\n\n\tif ( viewImg.getAttribute( 'src' ) !== placeholder ) {\n\t\twriter.setAttribute( 'src', placeholder, viewImg );\n\t}\n\n\tif ( !_getUIElement( viewFigure, 'placeholder' ) ) {\n\t\twriter.insert( writer.createPositionAfter( viewImg ), _createPlaceholder( writer ) );\n\t}\n}\n\n/**\n * Removes placeholder together with infinite progress bar on given image figure.\n */\nfunction _hidePlaceholder( viewFigure: ViewContainerElement, writer: ViewDowncastWriter ) {\n\tif ( viewFigure.hasClass( 'ck-image-upload-placeholder' ) ) {\n\t\twriter.removeClass( 'ck-image-upload-placeholder', viewFigure );\n\t}\n\n\t_removeUIElement( viewFigure, writer, 'placeholder' );\n}\n\n/**\n * Shows progress bar displaying upload progress.\n * Attaches it to the file loader to update when upload percentace is changed.\n */\nfunction _showProgressBar( viewFigure: ViewContainerElement, writer: ViewDowncastWriter, loader: FileLoader, view: EditingView ) {\n\tconst progressBar = _createProgressBar( writer );\n\twriter.insert( writer.createPositionAt( viewFigure, 'end' ), progressBar );\n\n\t// Update progress bar width when uploadedPercent is changed.\n\tloader.on( 'change:uploadedPercent', ( evt, name, value ) => {\n\t\tview.change( writer => {\n\t\t\twriter.setStyle( 'width', value + '%', progressBar );\n\t\t} );\n\t} );\n}\n\n/**\n * Hides upload progress bar.\n */\nfunction _hideProgressBar( viewFigure: ViewContainerElement, writer: ViewDowncastWriter ) {\n\t_removeUIElement( viewFigure, writer, 'progressBar' );\n}\n\n/**\n * Shows complete icon and hides after a certain amount of time.\n */\nfunction _showCompleteIcon( viewFigure: ViewContainerElement, writer: ViewDowncastWriter, view: EditingView ) {\n\tconst completeIcon = writer.createUIElement( 'div', { class: 'ck-image-upload-complete-icon' } );\n\n\twriter.insert( writer.createPositionAt( viewFigure, 'end' ), completeIcon );\n\n\tsetTimeout( () => {\n\t\tview.change( writer => writer.remove( writer.createRangeOn( completeIcon ) ) );\n\t}, 3000 );\n}\n\n/**\n * Create progress bar element using {@link module:engine/view/uielement~ViewUIElement}.\n */\nfunction _createProgressBar( writer: ViewDowncastWriter ): ViewUIElement {\n\tconst progressBar = writer.createUIElement( 'div', { class: 'ck-progress-bar' } );\n\n\twriter.setCustomProperty( 'progressBar', true, progressBar );\n\n\treturn progressBar;\n}\n\n/**\n * Create placeholder element using {@link module:engine/view/uielement~ViewUIElement}.\n */\nfunction _createPlaceholder( writer: ViewDowncastWriter ): ViewUIElement {\n\tconst placeholder = writer.createUIElement( 'div', { class: 'ck-upload-placeholder-loader' } );\n\n\twriter.setCustomProperty( 'placeholder', true, placeholder );\n\n\treturn placeholder;\n}\n\n/**\n * Returns {@link module:engine/view/uielement~ViewUIElement} of given unique property from image figure element.\n * Returns `undefined` if element is not found.\n */\nfunction _getUIElement( imageFigure: ViewElement, uniqueProperty: string ): ViewUIElement | undefined {\n\tfor ( const child of imageFigure.getChildren() ) {\n\t\tif ( ( child as ViewElement ).getCustomProperty( uniqueProperty ) ) {\n\t\t\treturn child as ViewUIElement;\n\t\t}\n\t}\n}\n\n/**\n * Removes {@link module:engine/view/uielement~ViewUIElement} of given unique property from image figure element.\n */\nfunction _removeUIElement( viewFigure: ViewContainerElement, writer: ViewDowncastWriter, uniqueProperty: string ) {\n\tconst element = _getUIElement( viewFigure, uniqueProperty );\n\n\tif ( element ) {\n\t\twriter.remove( writer.createRangeOn( element ) );\n\t}\n}\n\n/**\n * Displays local data from file loader.\n */\nfunction _displayLocalImage( imageUtils: ImageUtils, viewFigure: ViewElement, writer: ViewDowncastWriter, loader: FileLoader ) {\n\tif ( loader.data ) {\n\t\tconst viewImg = imageUtils.findViewImgElement( viewFigure )!;\n\n\t\twriter.setAttribute( 'src', loader.data, viewImg );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\nimport { FileRepository } from 'ckeditor5/src/upload.js';\nimport { Command, type Editor } from 'ckeditor5/src/core.js';\nimport { toArray, type ArrayOrItem } from 'ckeditor5/src/utils.js';\nimport type { ModelPosition } from 'ckeditor5/src/engine.js';\n\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * @module image/imageupload/uploadimagecommand\n */\n\n/**\n * The upload image command.\n *\n * The command is registered by the {@link module:image/imageupload/imageuploadediting~ImageUploadEditing} plugin as `uploadImage`\n * and it is also available via aliased `imageUpload` name.\n *\n * In order to upload an image at the current selection position\n * (according to the {@link module:widget/utils~findOptimalInsertionRange} algorithm),\n * execute the command and pass the native image file instance:\n *\n * ```ts\n * this.listenTo( editor.editing.view.document, 'clipboardInput', ( evt, data ) => {\n * \t// Assuming that only images were pasted:\n * \tconst images = Array.from( data.dataTransfer.files );\n *\n * \t// Upload the first image:\n * \teditor.execute( 'uploadImage', { file: images[ 0 ] } );\n * } );\n * ```\n *\n * It is also possible to insert multiple images at once:\n *\n * ```ts\n * editor.execute( 'uploadImage', {\n * \tfile: [\n * \t\tfile1,\n * \t\tfile2\n * \t]\n * } );\n * ```\n */\nexport class UploadImageCommand extends Command {\n\t/**\n\t * The command property: `false` if there is no permission on image upload, otherwise `true`.\n\t *\n\t * @observable\n\t * @internal\n\t */\n\tdeclare public isAccessAllowed: boolean;\n\n\t/**\n\t * Creates an instance of the `imageUlpoad` command. When executed, the command upload one of\n\t * the currently selected image from computer.\n\t *\n\t * @param editor The editor instance.\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tthis.set( 'isAccessAllowed', true );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst selectedElement = editor.model.document.selection.getSelectedElement()!;\n\n\t\t// TODO: This needs refactoring.\n\t\tthis.isEnabled = imageUtils.isImageAllowed() || imageUtils.isImage( selectedElement );\n\t}\n\n\t/**\n\t * Executes the command.\n\t *\n\t * @fires execute\n\t * @param options Options for the executed command.\n\t * @param options.file The image file or an array of image files to upload.\n\t */\n\tpublic override execute( options: { file: ArrayOrItem<File> } ): void {\n\t\tconst files = toArray( options.file );\n\t\tconst selection = this.editor.model.document.selection;\n\t\tconst imageUtils: ImageUtils = this.editor.plugins.get( 'ImageUtils' );\n\n\t\t// In case of multiple files, each file (starting from the 2nd) will be inserted at a position that\n\t\t// follows the previous one. That will move the selection and, to stay on the safe side and make sure\n\t\t// all images inherit the same selection attributes, they are collected beforehand.\n\t\t//\n\t\t// Applying these attributes ensures, for instance, that inserting an (inline) image into a link does\n\t\t// not split that link but preserves its continuity.\n\t\t//\n\t\t// Note: Selection attributes that do not make sense for images will be filtered out by insertImage() anyway.\n\t\tconst selectionAttributes = Object.fromEntries( selection.getAttributes() );\n\n\t\tfiles.forEach( ( file, index ) => {\n\t\t\tconst selectedElement = selection.getSelectedElement();\n\n\t\t\t// Inserting of an inline image replace the selected element and make a selection on the inserted image.\n\t\t\t// Therefore inserting multiple inline images requires creating position after each element.\n\t\t\tif ( index && selectedElement && imageUtils.isImage( selectedElement ) ) {\n\t\t\t\tconst position = this.editor.model.createPositionAfter( selectedElement );\n\n\t\t\t\tthis._uploadImage( file, selectionAttributes, position );\n\t\t\t} else {\n\t\t\t\tthis._uploadImage( file, selectionAttributes );\n\t\t\t}\n\t\t} );\n\t}\n\n\t/**\n\t * Handles uploading single file.\n\t */\n\tprivate _uploadImage( file: File, attributes: object, position?: ModelPosition ): void {\n\t\tconst editor = this.editor;\n\t\tconst fileRepository = editor.plugins.get( FileRepository );\n\t\tconst loader = fileRepository.createLoader( file );\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\t// Do not throw when upload adapter is not set. FileRepository will log an error anyway.\n\t\tif ( !loader ) {\n\t\t\treturn;\n\t\t}\n\n\t\timageUtils.insertImage( { ...attributes, uploadId: loader.id }, position );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageupload/imageuploadediting\n */\n\nimport { Plugin, type Editor } from 'ckeditor5/src/core.js';\n\nimport {\n\tViewUpcastWriter,\n\ttype ModelElement,\n\ttype ModelItem,\n\ttype ModelWriter,\n\ttype ViewDataTransfer,\n\ttype ViewElement,\n\ttype ModelNodeAttributes,\n\ttype DowncastAttributeEvent,\n\ttype UpcastElementEvent\n} from 'ckeditor5/src/engine.js';\n\nimport { Notification } from 'ckeditor5/src/ui.js';\nimport { ClipboardPipeline, type ViewDocumentClipboardInputEvent } from 'ckeditor5/src/clipboard.js';\nimport { FileRepository, type UploadResponse, type FileLoader } from 'ckeditor5/src/upload.js';\nimport { env } from 'ckeditor5/src/utils.js';\n\nimport { ImageUtils } from '../imageutils.js';\nimport { UploadImageCommand } from './uploadimagecommand.js';\nimport { fetchLocalImage, isLocalImage } from '../../src/imageupload/utils.js';\nimport { createImageTypeRegExp } from './utils.js';\n\n/**\n * The editing part of the image upload feature. It registers the `'uploadImage'` command\n * and the `imageUpload` command as an aliased name.\n *\n * When an image is uploaded, it fires the {@link ~ImageUploadEditing#event:uploadComplete `uploadComplete`} event\n * that allows adding custom attributes to the {@link module:engine/model/element~ModelElement image element}.\n */\nexport class ImageUploadEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ FileRepository, Notification, ClipboardPipeline, ImageUtils ] as const;\n\t}\n\n\tpublic static get pluginName() {\n\t\treturn 'ImageUploadEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * An internal mapping of {@link module:upload/filerepository~FileLoader#id file loader UIDs} and\n\t * model elements during the upload.\n\t *\n\t * Model element of the uploaded image can change, for instance, when {@link module:image/image/imagetypecommand~ImageTypeCommand}\n\t * is executed as a result of adding caption or changing image style. As a result, the upload logic must keep track of the model\n\t * element (reference) and resolve the upload for the correct model element (instead of the one that landed in the `$graveyard`\n\t * after image type changed).\n\t */\n\tprivate readonly _uploadImageElements: Map<string, Set<ModelElement>>;\n\n\t/**\n\t * An internal mapping of {@link module:upload/filerepository~FileLoader#id file loader UIDs} and\n\t * upload responses for handling images dragged during their upload process. When such images are later\n\t * dropped, their original upload IDs no longer exist in the registry (as the original upload completed).\n\t * This map preserves the upload responses to properly handle such cases.\n\t */\n\tprivate readonly _uploadedImages = new Map<string, UploadResponse>();\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\teditor.config.define( 'image', {\n\t\t\tupload: {\n\t\t\t\ttypes: [ 'jpeg', 'png', 'gif', 'bmp', 'webp', 'tiff' ]\n\t\t\t}\n\t\t} );\n\n\t\tthis._uploadImageElements = new Map();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst doc = editor.model.document;\n\t\tconst conversion = editor.conversion;\n\t\tconst fileRepository = editor.plugins.get( FileRepository );\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst clipboardPipeline: ClipboardPipeline = editor.plugins.get( 'ClipboardPipeline' );\n\t\tconst imageTypes = createImageTypeRegExp( editor.config.get( 'image.upload.types' )! );\n\t\tconst uploadImageCommand = new UploadImageCommand( editor );\n\n\t\t// Register `uploadImage` command and add `imageUpload` command as an alias for backward compatibility.\n\t\teditor.commands.add( 'uploadImage', uploadImageCommand );\n\t\teditor.commands.add( 'imageUpload', uploadImageCommand );\n\n\t\t// Register upcast converter for uploadId.\n\t\tconversion.for( 'upcast' )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: 'img',\n\t\t\t\t\tkey: 'uploadId'\n\t\t\t\t},\n\t\t\t\tmodel: 'uploadId'\n\t\t\t} )\n\n\t\t\t// Handle the case when the image is not fully uploaded yet but it's being moved.\n\t\t\t// See more: https://github.com/ckeditor/ckeditor5/pull/17327\n\t\t\t.add( dispatcher => dispatcher.on<UpcastElementEvent>( 'element:img', ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.test( data.viewItem, { attributes: [ 'data-ck-upload-id' ] } ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst uploadId = data.viewItem.getAttribute( 'data-ck-upload-id' );\n\n\t\t\t\tif ( !uploadId ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst [ modelElement ] = Array.from( data.modelRange!.getItems( { shallow: true } ) );\n\t\t\t\tconst loader = fileRepository.loaders.get( uploadId as string );\n\n\t\t\t\tif ( modelElement ) {\n\t\t\t\t\t// Handle case when `uploadId` is set on the image element but the loader is not present in the registry.\n\t\t\t\t\t// It may happen when the image was successfully uploaded and the loader was removed from the registry.\n\t\t\t\t\t// It's still present in the `_uploadedImages` map though. It's why we do not place this line in the condition below.\n\t\t\t\t\tconversionApi.writer.setAttribute( 'uploadId', uploadId, modelElement );\n\t\t\t\t\tconversionApi.consumable.consume( data.viewItem, { attributes: [ 'data-ck-upload-id' ] } );\n\n\t\t\t\t\tif ( loader && loader.data ) {\n\t\t\t\t\t\tconversionApi.writer.setAttribute( 'uploadStatus', loader.status, modelElement );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, { priority: 'low' } ) );\n\n\t\t// Handle pasted images.\n\t\t// For every image file, a new file loader is created and a placeholder image is\n\t\t// inserted into the content. Then, those images are uploaded once they appear in the model\n\t\t// (see Document#change listener below).\n\t\tthis.listenTo<ViewDocumentClipboardInputEvent>( editor.editing.view.document, 'clipboardInput', ( evt, data ) => {\n\t\t\t// Skip if non empty HTML data is included.\n\t\t\t// https://github.com/ckeditor/ckeditor5-upload/issues/68\n\t\t\tif ( isHtmlInDataTransfer( data.dataTransfer ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst images = Array.from( data.dataTransfer.files ).filter( file => {\n\t\t\t\t// See https://github.com/ckeditor/ckeditor5-image/pull/254.\n\t\t\t\tif ( !file ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn imageTypes.test( file.type );\n\t\t\t} );\n\n\t\t\tif ( !images.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevt.stop();\n\n\t\t\teditor.model.change( writer => {\n\t\t\t\t// Set selection to paste target.\n\t\t\t\tif ( data.targetRanges ) {\n\t\t\t\t\twriter.setSelection( data.targetRanges.map( viewRange => editor.editing.mapper.toModelRange( viewRange ) ) );\n\t\t\t\t}\n\n\t\t\t\teditor.execute( 'uploadImage', { file: images } );\n\t\t\t} );\n\n\t\t\tconst uploadImageCommand = editor.commands.get( 'uploadImage' )!;\n\n\t\t\tif ( !uploadImageCommand.isAccessAllowed ) {\n\t\t\t\tconst notification: Notification = editor.plugins.get( 'Notification' );\n\t\t\t\tconst t = editor.locale.t;\n\n\t\t\t\tnotification.showWarning( t( 'You have no image upload permissions.' ), {\n\t\t\t\t\tnamespace: 'image'\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\t// Handle HTML pasted with images with base64 or blob sources.\n\t\t// For every image file, a new file loader is created and a placeholder image is\n\t\t// inserted into the content. Then, those images are uploaded once they appear in the model\n\t\t// (see Document#change listener below).\n\t\tthis.listenTo( clipboardPipeline, 'inputTransformation', ( evt, data ) => {\n\t\t\tconst fetchableImages = Array.from( editor.editing.view.createRangeIn( data.content ) )\n\t\t\t\t.map( value => value.item as ViewElement )\n\t\t\t\t.filter( viewElement =>\n\t\t\t\t\tisLocalImage( imageUtils, viewElement ) &&\n\t\t\t\t\t!viewElement.getAttribute( 'uploadProcessed' ) )\n\t\t\t\t.map( viewElement => { return { promise: fetchLocalImage( viewElement ), imageElement: viewElement }; } );\n\n\t\t\tif ( !fetchableImages.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst writer = new ViewUpcastWriter( editor.editing.view.document );\n\n\t\t\tfor ( const fetchableImage of fetchableImages ) {\n\t\t\t\t// Set attribute marking that the image was processed already.\n\t\t\t\twriter.setAttribute( 'uploadProcessed', true, fetchableImage.imageElement );\n\n\t\t\t\tconst loader = fileRepository.createLoader( fetchableImage.promise );\n\n\t\t\t\tif ( loader ) {\n\t\t\t\t\twriter.setAttribute( 'src', '', fetchableImage.imageElement );\n\t\t\t\t\twriter.setAttribute( 'uploadId', loader.id, fetchableImage.imageElement );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\t// Prevents from the browser redirecting to the dropped image.\n\t\teditor.editing.view.document.on( 'dragover', ( evt, data ) => {\n\t\t\tdata.preventDefault();\n\t\t} );\n\n\t\t// Upload placeholder images that appeared in the model.\n\t\tdoc.on( 'change', () => {\n\t\t\t// Note: Reversing changes to start with insertions and only then handle removals. If it was the other way around,\n\t\t\t// loaders for **all** images that land in the $graveyard would abort while in fact only those that were **not** replaced\n\t\t\t// by other images should be aborted.\n\t\t\tconst changes = doc.differ.getChanges( { includeChangesInGraveyard: true } ).reverse();\n\t\t\tconst insertedImagesIds = new Set();\n\n\t\t\tfor ( const entry of changes ) {\n\t\t\t\tif ( entry.type == 'insert' && entry.name != '$text' ) {\n\t\t\t\t\tconst item = entry.position.nodeAfter!;\n\t\t\t\t\tconst isInsertedInGraveyard = entry.position.root.rootName == '$graveyard';\n\n\t\t\t\t\tfor ( const imageElement of getImagesFromChangeItem( editor, item ) ) {\n\t\t\t\t\t\t// Check if the image element still has upload id.\n\t\t\t\t\t\tconst uploadId = imageElement.getAttribute( 'uploadId' ) as string;\n\n\t\t\t\t\t\tif ( !uploadId ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if the image is loaded on this client.\n\t\t\t\t\t\tconst loader = fileRepository.loaders.get( uploadId );\n\n\t\t\t\t\t\tif ( !loader ) {\n\t\t\t\t\t\t\t// If the loader does not exist, it means that the image was already uploaded\n\t\t\t\t\t\t\t// and the loader promise was removed from the registry. In that scenario we need\n\t\t\t\t\t\t\t// to restore response object from the internal map.\n\t\t\t\t\t\t\tif ( !isInsertedInGraveyard && this._uploadedImages.has( uploadId ) ) {\n\t\t\t\t\t\t\t\t// Fire `uploadComplete` to set proper attributes on the image element.\n\t\t\t\t\t\t\t\teditor.model.enqueueChange( { isUndoable: false }, writer => {\n\t\t\t\t\t\t\t\t\twriter.setAttribute( 'uploadStatus', 'complete', imageElement );\n\n\t\t\t\t\t\t\t\t\tthis.fire<ImageUploadCompleteEvent>( 'uploadComplete', {\n\t\t\t\t\t\t\t\t\t\tdata: this._uploadedImages.get( uploadId )!,\n\t\t\t\t\t\t\t\t\t\timageElement: imageElement as ModelElement\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t// While it makes sense to remove the image from the `_uploadedImages` map here,\n\t\t\t\t\t\t\t\t// it's counterintuitive for the user that pastes image in uploading several times.\n\t\t\t\t\t\t\t\t// It'll work the first time, but the next time the image will be empty because the\n\t\t\t\t\t\t\t\t// `_uploadedImages` no longer contain the response.\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( isInsertedInGraveyard ) {\n\t\t\t\t\t\t\t// If the image was inserted to the graveyard for good (**not** replaced by another image),\n\t\t\t\t\t\t\t// only then abort the loading process.\n\t\t\t\t\t\t\tif ( !insertedImagesIds.has( uploadId ) ) {\n\t\t\t\t\t\t\t\t// ... but abort it only if all remain images that share the same loader are in the graveyard too.\n\t\t\t\t\t\t\t\t// This is to prevent situation when we have two images in uploading state and one of them is being\n\t\t\t\t\t\t\t\t// placed in the graveyard (e.g. using undo). The other one should not be aborted.\n\t\t\t\t\t\t\t\tconst allImagesThatShareUploaderInGraveyard = Array\n\t\t\t\t\t\t\t\t\t.from( this._uploadImageElements.get( uploadId )! )\n\t\t\t\t\t\t\t\t\t.every( element => element.root.rootName == '$graveyard' );\n\n\t\t\t\t\t\t\t\tif ( allImagesThatShareUploaderInGraveyard ) {\n\t\t\t\t\t\t\t\t\tloader.abort();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Remember the upload id of the inserted image. If it acted as a replacement for another\n\t\t\t\t\t\t\t// image (which landed in the $graveyard), the related loader will not be aborted because\n\t\t\t\t\t\t\t// this is still the same image upload.\n\t\t\t\t\t\t\tinsertedImagesIds.add( uploadId );\n\n\t\t\t\t\t\t\t// Keep the mapping between the upload ID and the image model element so the upload\n\t\t\t\t\t\t\t// can later resolve in the context of the correct model element. The model element could\n\t\t\t\t\t\t\t// change for the same upload if one image was replaced by another (e.g. image type was changed),\n\t\t\t\t\t\t\t// so this may also replace an existing mapping.\n\t\t\t\t\t\t\tif ( !this._uploadImageElements.has( uploadId ) ) {\n\t\t\t\t\t\t\t\tthis._uploadImageElements.set( uploadId, new Set( [ imageElement as ModelElement ] ) );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._uploadImageElements.get( uploadId )!.add( imageElement as ModelElement );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( loader.status == 'idle' ) {\n\t\t\t\t\t\t\t\t// If the image was inserted into content and has not been loaded yet, start loading it.\n\t\t\t\t\t\t\t\tthis._readAndUpload( loader );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\t// Set the default handler for feeding the image element with `src` and `srcset` attributes.\n\t\t// Also set the natural `width` and `height` attributes (if not already set).\n\t\tthis.on<ImageUploadCompleteEvent>( 'uploadComplete', ( evt, { imageElement, data } ) => {\n\t\t\tconst urls = data.urls ? data.urls as Record<string, unknown> : data;\n\n\t\t\tthis.editor.model.change( writer => {\n\t\t\t\twriter.setAttribute( 'src', urls.default, imageElement );\n\t\t\t\tthis._parseAndSetSrcsetAttributeOnImage( urls, imageElement, writer );\n\t\t\t\timageUtils.setImageNaturalSizeAttributes( imageElement );\n\t\t\t} );\n\t\t}, { priority: 'low' } );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tconst schema = this.editor.model.schema;\n\n\t\t// Setup schema to allow uploadId and uploadStatus for images.\n\t\t// Wait for ImageBlockEditing or ImageInlineEditing to register their elements first,\n\t\t// that's why doing this in afterInit() instead of init().\n\t\tif ( this.editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\tschema.extend( 'imageBlock', {\n\t\t\t\tallowAttributes: [ 'uploadId', 'uploadStatus' ]\n\t\t\t} );\n\n\t\t\tthis._registerConverters( 'imageBlock' );\n\t\t}\n\n\t\tif ( this.editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\tschema.extend( 'imageInline', {\n\t\t\t\tallowAttributes: [ 'uploadId', 'uploadStatus' ]\n\t\t\t} );\n\n\t\t\tthis._registerConverters( 'imageInline' );\n\t\t}\n\t}\n\n\t/**\n\t * Reads and uploads an image.\n\t *\n\t * The image is read from the disk and as a Base64-encoded string it is set temporarily to\n\t * `image[src]`. When the image is successfully uploaded, the temporary data is replaced with the target\n\t * image's URL (the URL to the uploaded image on the server).\n\t */\n\tprotected _readAndUpload( loader: FileLoader ): Promise<void> {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst t = editor.locale.t;\n\t\tconst fileRepository = editor.plugins.get( FileRepository );\n\t\tconst notification = editor.plugins.get( Notification );\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst imageUploadElements = this._uploadImageElements;\n\n\t\tmodel.enqueueChange( { isUndoable: false }, writer => {\n\t\t\tconst elements = imageUploadElements.get( loader.id )!;\n\n\t\t\tfor ( const element of elements ) {\n\t\t\t\twriter.setAttribute( 'uploadStatus', 'reading', element );\n\t\t\t}\n\t\t} );\n\n\t\treturn loader.read()\n\t\t\t.then( () => {\n\t\t\t\tconst promise = loader.upload();\n\n\t\t\t\tif ( editor.ui ) {\n\t\t\t\t\teditor.ui.ariaLiveAnnouncer.announce( t( 'Uploading image' ) );\n\t\t\t\t}\n\n\t\t\t\tfor ( const imageElement of imageUploadElements.get( loader.id )! ) {\n\t\t\t\t\t// Force re–paint in Safari. Without it, the image will display with a wrong size.\n\t\t\t\t\t// https://github.com/ckeditor/ckeditor5/issues/1975\n\t\t\t\t\t/* istanbul ignore next -- @preserve */\n\t\t\t\t\tif ( env.isSafari ) {\n\t\t\t\t\t\tconst viewFigure = editor.editing.mapper.toViewElement( imageElement )!;\n\t\t\t\t\t\tconst viewImg = imageUtils.findViewImgElement( viewFigure )!;\n\n\t\t\t\t\t\teditor.editing.view.once( 'render', () => {\n\t\t\t\t\t\t\t// Early returns just to be safe. There might be some code ran\n\t\t\t\t\t\t\t// in between the outer scope and this callback.\n\t\t\t\t\t\t\tif ( !viewImg.parent ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst domFigure = editor.editing.view.domConverter.mapViewToDom( viewImg.parent ) as HTMLElement | undefined;\n\n\t\t\t\t\t\t\tif ( !domFigure ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst originalDisplay = domFigure.style.display;\n\n\t\t\t\t\t\t\tdomFigure.style.display = 'none';\n\n\t\t\t\t\t\t\t// Make sure this line will never be removed during minification for having \"no effect\".\n\t\t\t\t\t\t\t( domFigure as any )._ckHack = domFigure.offsetHeight;\n\n\t\t\t\t\t\t\tdomFigure.style.display = originalDisplay;\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel.enqueueChange( { isUndoable: false }, writer => {\n\t\t\t\t\t\twriter.setAttribute( 'uploadStatus', 'uploading', imageElement );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\treturn promise;\n\t\t\t} )\n\t\t\t.then( data => {\n\t\t\t\tmodel.enqueueChange( { isUndoable: false }, writer => {\n\t\t\t\t\tfor ( const imageElement of imageUploadElements.get( loader.id )! ) {\n\t\t\t\t\t\twriter.setAttribute( 'uploadStatus', 'complete', imageElement );\n\t\t\t\t\t\tthis.fire<ImageUploadCompleteEvent>( 'uploadComplete', { data, imageElement } );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( editor.ui ) {\n\t\t\t\t\t\teditor.ui.ariaLiveAnnouncer.announce( t( 'Image upload complete' ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._uploadedImages.set( loader.id, data );\n\t\t\t\t} );\n\n\t\t\t\tclean();\n\t\t\t} )\n\t\t\t.catch( error => {\n\t\t\t\tif ( editor.ui ) {\n\t\t\t\t\teditor.ui.ariaLiveAnnouncer.announce( t( 'Error during image upload' ) );\n\t\t\t\t}\n\n\t\t\t\t// If status is not 'error' nor 'aborted' - throw error because it means that something else went wrong,\n\t\t\t\t// it might be generic error and it would be real pain to find what is going on.\n\t\t\t\tif ( loader.status !== 'error' && loader.status !== 'aborted' ) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\n\t\t\t\t// Might be 'aborted'.\n\t\t\t\tif ( loader.status == 'error' && error ) {\n\t\t\t\t\tnotification.showWarning( error, {\n\t\t\t\t\t\ttitle: t( 'Upload failed' ),\n\t\t\t\t\t\tnamespace: 'upload'\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Permanently remove image from insertion batch.\n\t\t\t\tmodel.enqueueChange( { isUndoable: false }, writer => {\n\t\t\t\t\tfor ( const imageElement of imageUploadElements.get( loader.id )! ) {\n\t\t\t\t\t\t// Handle situation when the image has been removed and then `abort` exception was thrown.\n\t\t\t\t\t\t// See: https://github.com/ckeditor/ckeditor5-commercial/issues/6817\n\t\t\t\t\t\tif ( imageElement.root.rootName !== '$graveyard' ) {\n\t\t\t\t\t\t\twriter.remove( imageElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tclean();\n\t\t\t} );\n\n\t\tfunction clean() {\n\t\t\tmodel.enqueueChange( { isUndoable: false }, writer => {\n\t\t\t\tfor ( const imageElement of imageUploadElements.get( loader.id )! ) {\n\t\t\t\t\twriter.removeAttribute( 'uploadId', imageElement );\n\t\t\t\t\twriter.removeAttribute( 'uploadStatus', imageElement );\n\t\t\t\t}\n\n\t\t\t\timageUploadElements.delete( loader.id );\n\t\t\t} );\n\n\t\t\tfileRepository.destroyLoader( loader );\n\t\t}\n\t}\n\n\t/**\n\t * Creates the `srcset` attribute based on a given file upload response and sets it as an attribute to a specific image element.\n\t *\n\t * @param data Data object from which `srcset` will be created.\n\t * @param image The image element on which the `srcset` attribute will be set.\n\t */\n\tprotected _parseAndSetSrcsetAttributeOnImage( data: Record<string, unknown>, image: ModelElement, writer: ModelWriter ): void {\n\t\t// Srcset attribute for responsive images support.\n\t\tlet maxWidth = 0;\n\n\t\tconst srcsetAttribute = Object.keys( data )\n\t\t\t// Filter out keys that are not integers.\n\t\t\t.filter( key => {\n\t\t\t\tconst width = parseInt( key, 10 );\n\n\t\t\t\tif ( !isNaN( width ) ) {\n\t\t\t\t\tmaxWidth = Math.max( maxWidth, width );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} )\n\n\t\t\t// Convert each key to srcset entry.\n\t\t\t.map( key => `${ data[ key ] } ${ key }w` )\n\n\t\t\t// Join all entries.\n\t\t\t.join( ', ' );\n\n\t\tif ( srcsetAttribute != '' ) {\n\t\t\tconst attributes: ModelNodeAttributes = {\n\t\t\t\tsrcset: srcsetAttribute\n\t\t\t};\n\n\t\t\tif ( !image.hasAttribute( 'width' ) && !image.hasAttribute( 'height' ) ) {\n\t\t\t\tattributes.width = maxWidth;\n\t\t\t}\n\n\t\t\twriter.setAttributes( attributes, image );\n\t\t}\n\t}\n\n\t/**\n\t * Registers image upload converters.\n\t *\n\t * @param imageType The type of the image.\n\t */\n\tprivate _registerConverters( imageType: 'imageBlock' | 'imageInline' ) {\n\t\tconst { conversion, plugins } = this.editor;\n\n\t\tconst fileRepository = plugins.get( FileRepository );\n\t\tconst imageUtils = plugins.get( ImageUtils );\n\n\t\t// It sets `data-ck-upload-id` attribute on the view image elements that are not fully uploaded.\n\t\t// It avoids the situation when image disappears when it's being moved and upload is not finished yet.\n\t\t// See more: https://github.com/ckeditor/ckeditor5/issues/16967\n\t\tconversion.for( 'dataDowncast' ).add( dispatcher => {\n\t\t\tdispatcher.on<DowncastAttributeEvent>( `attribute:uploadId:${ imageType }`, ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.test( data.item, evt.name ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst loader = fileRepository.loaders.get( data.attributeNewValue as string );\n\n\t\t\t\tif ( !loader || !loader.data ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst viewElement = conversionApi.mapper.toViewElement( data.item as ModelElement )!;\n\t\t\t\tconst img = imageUtils.findViewImgElement( viewElement );\n\n\t\t\t\tif ( img ) {\n\t\t\t\t\tconversionApi.consumable.consume( data.item, evt.name );\n\t\t\t\t\tconversionApi.writer.setAttribute( 'data-ck-upload-id', loader.id, img );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n}\n\n/**\n * TODO move this to the clipboard package.\n *\n * Returns `true` if non-empty `text/html` is included in the data transfer.\n */\nexport function isHtmlInDataTransfer( dataTransfer: ViewDataTransfer ): boolean {\n\treturn Array.from( dataTransfer.types ).includes( 'text/html' ) && dataTransfer.getData( 'text/html' ) !== '';\n}\n\nfunction getImagesFromChangeItem( editor: Editor, item: ModelItem ): Array<ModelItem> {\n\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\treturn Array.from( editor.model.createRangeOn( item ) )\n\t\t.filter( value => imageUtils.isImage( value.item as ModelElement ) )\n\t\t.map( value => value.item );\n}\n\n/**\n * An event fired when an image is uploaded. You can hook into this event to provide\n * custom attributes to the {@link module:engine/model/element~ModelElement image element} based on the data from\n * the server.\n *\n * ```ts\n * const imageUploadEditing = editor.plugins.get( 'ImageUploadEditing' );\n *\n * imageUploadEditing.on( 'uploadComplete', ( evt, { data, imageElement } ) => {\n * \teditor.model.change( writer => {\n * \t\twriter.setAttribute( 'someAttribute', 'foo', imageElement );\n * \t} );\n * } );\n * ```\n *\n * You can also stop the default handler that sets the `src` and `srcset` attributes\n * if you want to provide custom values for these attributes.\n *\n * ```ts\n * imageUploadEditing.on( 'uploadComplete', ( evt, { data, imageElement } ) => {\n * \tevt.stop();\n * } );\n * ```\n *\n * **Note**: This event is fired by the {@link module:image/imageupload/imageuploadediting~ImageUploadEditing} plugin.\n *\n * @eventName ~ImageUploadEditing#uploadComplete\n * @param data The `uploadComplete` event data.\n */\nexport type ImageUploadCompleteEvent = {\n\tname: 'uploadComplete';\n\targs: [ data: ImageUploadCompleteData];\n};\n\nexport type ImageUploadCompleteData = {\n\n\t/**\n\t * The data coming from the upload adapter.\n\t */\n\tdata: UploadResponse;\n\n\t/**\n\t * The model {@link module:engine/model/element~ModelElement image element} that can be customized.\n\t */\n\timageElement: ModelElement;\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageupload\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageUploadUI } from './imageupload/imageuploadui.js';\nimport { ImageUploadProgress } from './imageupload/imageuploadprogress.js';\nimport { ImageUploadEditing } from './imageupload/imageuploadediting.js';\n\n/**\n * The image upload plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload image upload feature} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins to enable image uploading:\n *\n * * {@link module:image/imageupload/imageuploadediting~ImageUploadEditing},\n * * {@link module:image/imageupload/imageuploadui~ImageUploadUI},\n * * {@link module:image/imageupload/imageuploadprogress~ImageUploadProgress}.\n */\nexport class ImageUpload extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageUpload' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUploadEditing, ImageUploadUI, ImageUploadProgress ] as const;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinsert/ui/imageinserturlview\n */\n\nimport {\n\tView,\n\tLabeledFieldView,\n\tcreateLabeledInputText,\n\tsubmitHandler,\n\ttype InputTextView\n} from 'ckeditor5/src/ui.js';\nimport { KeystrokeHandler, type Locale } from 'ckeditor5/src/utils.js';\n\n/**\n * The insert an image via URL view.\n *\n * See {@link module:image/imageinsert/imageinsertviaurlui~ImageInsertViaUrlUI}.\n *\n * @internal\n */\nexport class ImageInsertUrlView extends View {\n\t/**\n\t * The URL input field view.\n\t */\n\tpublic urlInputView: LabeledFieldView<InputTextView>;\n\n\t/**\n\t * The value of the URL input.\n\t *\n\t * @observable\n\t */\n\tdeclare public imageURLInputValue: string;\n\n\t/**\n\t * Observable property used to alter labels while some image is selected and when it is not.\n\t *\n\t * @observable\n\t */\n\tdeclare public isImageSelected: boolean;\n\n\t/**\n\t * Observable property indicating whether the form interactive elements should be enabled.\n\t *\n\t * @observable\n\t */\n\tdeclare public isEnabled: boolean;\n\n\t/**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */\n\tpublic readonly keystrokes: KeystrokeHandler;\n\n\t/**\n\t * Creates a view for the dropdown panel of {@link module:image/imageinsert/imageinsertui~ImageInsertUI}.\n\t *\n\t * @param locale The localization services instance.\n\t */\n\tconstructor( locale: Locale ) {\n\t\tsuper( locale );\n\n\t\tthis.set( 'imageURLInputValue', '' );\n\t\tthis.set( 'isImageSelected', false );\n\t\tthis.set( 'isEnabled', true );\n\n\t\tthis.keystrokes = new KeystrokeHandler();\n\n\t\tthis.urlInputView = this._createUrlInputView();\n\n\t\tthis.setTemplate( {\n\t\t\ttag: 'form',\n\n\t\t\tattributes: {\n\t\t\t\tclass: [\n\t\t\t\t\t'ck',\n\t\t\t\t\t'ck-image-insert-url'\n\t\t\t\t],\n\t\t\t\ttabindex: '-1'\n\t\t\t},\n\n\t\t\tchildren: [\n\t\t\t\tthis.urlInputView,\n\t\t\t\t{\n\t\t\t\t\ttag: 'div',\n\t\t\t\t\tattributes: {\n\t\t\t\t\t\tclass: [\n\t\t\t\t\t\t\t'ck',\n\t\t\t\t\t\t\t'ck-image-insert-url__action-row'\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override render(): void {\n\t\tsuper.render();\n\n\t\tsubmitHandler( {\n\t\t\tview: this\n\t\t} );\n\n\t\t// Start listening for the keystrokes coming from #element.\n\t\tthis.keystrokes.listenTo( this.element! );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tsuper.destroy();\n\n\t\tthis.keystrokes.destroy();\n\t}\n\n\t/**\n\t * Creates the {@link #urlInputView}.\n\t */\n\tprivate _createUrlInputView() {\n\t\tconst locale = this.locale!;\n\t\tconst t = locale.t;\n\t\tconst urlInputView = new LabeledFieldView( locale, createLabeledInputText );\n\n\t\turlInputView.bind( 'label' ).to( this, 'isImageSelected',\n\t\t\tvalue => value ? t( 'Update image URL' ) : t( 'Insert image via URL' )\n\t\t);\n\n\t\turlInputView.bind( 'isEnabled' ).to( this );\n\n\t\turlInputView.fieldView.inputMode = 'url';\n\t\turlInputView.fieldView.placeholder = 'https://example.com/image.png';\n\n\t\turlInputView.fieldView.bind( 'value' ).to( this, 'imageURLInputValue', ( value: string ) => value || '' );\n\t\turlInputView.fieldView.on( 'input', () => {\n\t\t\tthis.imageURLInputValue = urlInputView.fieldView.element!.value.trim();\n\t\t} );\n\n\t\treturn urlInputView;\n\t}\n\n\t/**\n\t * Focuses the view.\n\t */\n\tpublic focus(): void {\n\t\tthis.urlInputView.focus();\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinsert/imageinsertviaurlui\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ButtonView, Dialog, MenuBarMenuListItemButtonView } from 'ckeditor5/src/ui.js';\nimport { IconImageUrl } from 'ckeditor5/src/icons.js';\n\nimport { ImageInsertUI } from './imageinsertui.js';\nimport { ImageInsertUrlView } from './ui/imageinserturlview.js';\n\n/**\n * The image insert via URL plugin (UI part).\n *\n * The plugin introduces two UI components to the {@link module:ui/componentfactory~ComponentFactory UI component factory}:\n *\n * * the `'insertImageViaUrl'` toolbar button,\n * * the `'menuBar:insertImageViaUrl'` menu bar component.\n *\n * It also integrates with the `insertImage` toolbar component and `menuBar:insertImage` menu component, which are default components\n * through which inserting image via URL is available.\n */\nexport class ImageInsertViaUrlUI extends Plugin {\n\tprivate _imageInsertUI!: ImageInsertUI;\n\tprivate _formView?: ImageInsertUrlView;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageInsertViaUrlUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageInsertUI, Dialog ] as const;\n\t}\n\n\tpublic init(): void {\n\t\tthis.editor.ui.componentFactory.add( 'insertImageViaUrl', () => this._createToolbarButton() );\n\t\tthis.editor.ui.componentFactory.add( 'menuBar:insertImageViaUrl', () => this._createMenuBarButton( 'standalone' ) );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tthis._imageInsertUI = this.editor.plugins.get( 'ImageInsertUI' );\n\n\t\tthis._imageInsertUI.registerIntegration( {\n\t\t\tname: 'url',\n\t\t\tobservable: () => this.editor.commands.get( 'insertImage' )!,\n\t\t\tbuttonViewCreator: () => this._createToolbarButton(),\n\t\t\tformViewCreator: () => this._createDropdownButton(),\n\t\t\tmenuBarButtonViewCreator: isOnly => this._createMenuBarButton( isOnly ? 'insertOnly' : 'insertNested' )\n\t\t} );\n\t}\n\n\t/**\n\t * Creates the base for various kinds of the button component provided by this feature.\n\t */\n\tprivate _createInsertUrlButton<T extends typeof ButtonView | typeof MenuBarMenuListItemButtonView>(\n\t\tButtonClass: T\n\t): InstanceType<T> {\n\t\tconst button = new ButtonClass( this.editor.locale ) as InstanceType<T>;\n\n\t\tbutton.icon = IconImageUrl;\n\t\tbutton.on( 'execute', () => {\n\t\t\tthis._showModal();\n\t\t} );\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Creates a simple toolbar button, with an icon and a tooltip.\n\t */\n\tprivate _createToolbarButton(): ButtonView {\n\t\tconst t = this.editor.locale.t;\n\t\tconst button = this._createInsertUrlButton( ButtonView );\n\n\t\tbutton.tooltip = true;\n\t\tbutton.bind( 'label' ).to(\n\t\t\tthis._imageInsertUI,\n\t\t\t'isImageSelected',\n\t\t\tisImageSelected => isImageSelected ? t( 'Update image URL' ) : t( 'Insert image via URL' )\n\t\t);\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Creates a button for the dropdown view, with an icon, text and no tooltip.\n\t */\n\tprivate _createDropdownButton(): ButtonView {\n\t\tconst t = this.editor.locale.t;\n\t\tconst button = this._createInsertUrlButton( ButtonView );\n\n\t\tbutton.withText = true;\n\t\tbutton.bind( 'label' ).to(\n\t\t\tthis._imageInsertUI,\n\t\t\t'isImageSelected',\n\t\t\tisImageSelected => isImageSelected ? t( 'Update image URL' ) : t( 'Insert via URL' )\n\t\t);\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Creates a button for the menu bar.\n\t */\n\tprivate _createMenuBarButton( type: 'standalone' | 'insertOnly' | 'insertNested' ): MenuBarMenuListItemButtonView {\n\t\tconst t = this.editor.locale.t;\n\t\tconst button = this._createInsertUrlButton( MenuBarMenuListItemButtonView );\n\n\t\tbutton.withText = true;\n\n\t\tswitch ( type ) {\n\t\t\tcase 'standalone':\n\t\t\t\tbutton.label = t( 'Image via URL' );\n\t\t\t\tbreak;\n\t\t\tcase 'insertOnly':\n\t\t\t\tbutton.label = t( 'Image' );\n\t\t\t\tbreak;\n\t\t\tcase 'insertNested':\n\t\t\t\tbutton.label = t( 'Via URL' );\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Creates the form view used to submit the image URL.\n\t */\n\tprivate _createInsertUrlView(): ImageInsertUrlView {\n\t\tconst editor = this.editor;\n\t\tconst locale = editor.locale;\n\n\t\tconst replaceImageSourceCommand = editor.commands.get( 'replaceImageSource' )!;\n\t\tconst insertImageCommand = editor.commands.get( 'insertImage' )!;\n\n\t\tconst imageInsertUrlView = new ImageInsertUrlView( locale );\n\n\t\timageInsertUrlView.bind( 'isImageSelected' ).to( this._imageInsertUI );\n\t\timageInsertUrlView.bind( 'isEnabled' ).toMany( [ insertImageCommand, replaceImageSourceCommand ], 'isEnabled', ( ...isEnabled ) => (\n\t\t\tisEnabled.some( isCommandEnabled => isCommandEnabled )\n\t\t) );\n\n\t\treturn imageInsertUrlView;\n\t}\n\n\t/**\n\t * Shows the insert image via URL form view in a modal.\n\t */\n\tprivate _showModal() {\n\t\tconst editor = this.editor;\n\t\tconst locale = editor.locale;\n\t\tconst t = locale.t;\n\t\tconst dialog = editor.plugins.get( 'Dialog' );\n\n\t\tif ( !this._formView ) {\n\t\t\tthis._formView = this._createInsertUrlView();\n\t\t\tthis._formView.on( 'submit', () => this._handleSave() );\n\t\t}\n\n\t\tconst replaceImageSourceCommand = editor.commands.get( 'replaceImageSource' )!;\n\t\tthis._formView.imageURLInputValue = replaceImageSourceCommand.value || '';\n\n\t\tdialog.show( {\n\t\t\tid: 'insertImageViaUrl',\n\t\t\ttitle: t( 'Image via URL' ),\n\t\t\tisModal: true,\n\t\t\tcontent: this._formView,\n\t\t\tactionButtons: [\n\t\t\t\t{\n\t\t\t\t\tlabel: t( 'Cancel' ),\n\t\t\t\t\twithText: true,\n\t\t\t\t\tonExecute: () => dialog.hide()\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: this._imageInsertUI.isImageSelected ? t( 'Save' ) : t( 'Insert' ),\n\t\t\t\t\tclass: 'ck-button-action',\n\t\t\t\t\twithText: true,\n\t\t\t\t\tonExecute: () => this._handleSave()\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\t}\n\n\t/**\n\t * Executes appropriate command depending on selection and form value.\n\t */\n\tprivate _handleSave() {\n\t\tconst replaceImageSourceCommand = this.editor.commands.get( 'replaceImageSource' )!;\n\n\t\t// If an image element is currently selected, we want to replace its source attribute (instead of inserting a new image).\n\t\t// We detect if an image is selected by checking `replaceImageSource` command state.\n\t\tif ( replaceImageSourceCommand.isEnabled ) {\n\t\t\tthis.editor.execute( 'replaceImageSource', { source: this._formView!.imageURLInputValue } );\n\t\t} else {\n\t\t\tthis.editor.execute( 'insertImage', { source: this._formView!.imageURLInputValue } );\n\t\t}\n\n\t\tthis.editor.plugins.get( 'Dialog' ).hide();\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinsertviaurl\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageInsertUI } from './imageinsert/imageinsertui.js';\nimport { ImageInsertViaUrlUI } from './imageinsert/imageinsertviaurlui.js';\n\n/**\n * The image insert via URL plugin.\n *\n * For a detailed overview, check the {@glink features/images/images-inserting\n * Insert images via source URL} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins\n * to enable image inserting via implemented integrations:\n *\n * * {@link module:image/imageinsert/imageinsertui~ImageInsertUI},\n */\nexport class ImageInsertViaUrl extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageInsertViaUrl' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageInsertViaUrlUI, ImageInsertUI ] as const;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageinsert\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageUpload } from './imageupload.js';\nimport { ImageInsertViaUrl } from './imageinsertviaurl.js';\nimport { ImageInsertUI } from './imageinsert/imageinsertui.js';\n\n/**\n * The image insert plugin.\n *\n * For a detailed overview, check the {@glink features/images/image-upload/image-upload Image upload feature}\n * and {@glink features/images/images-inserting Insert images via source URL} documentation.\n *\n * This plugin does not do anything directly, but it loads a set of specific plugins\n * to enable image uploading or inserting via implemented integrations:\n *\n * * {@link module:image/imageupload~ImageUpload}\n * * {@link module:image/imageinsert/imageinsertui~ImageInsertUI}\n */\nexport class ImageInsert extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageInsert' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUpload, ImageInsertViaUrl, ImageInsertUI ] as const;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/resizeimagecommand\n */\n\nimport { Command } from 'ckeditor5/src/core.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * The resize image command. Currently, it only supports the width attribute.\n */\nexport class ResizeImageCommand extends Command {\n\t/**\n\t * Desired image width and height.\n\t */\n\tdeclare public value: undefined | null | {\n\t\twidth: string | null;\n\t\theight: string | null;\n\t};\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst element = imageUtils.getClosestSelectedImageElement( editor.model.document.selection );\n\n\t\tthis.isEnabled = !!element;\n\n\t\tif ( !element || !element.hasAttribute( 'resizedWidth' ) ) {\n\t\t\tthis.value = null;\n\t\t} else {\n\t\t\tthis.value = {\n\t\t\t\twidth: element.getAttribute( 'resizedWidth' ) as string,\n\t\t\t\theight: null\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * Executes the command.\n\t *\n\t * ```ts\n\t * // Sets the width to 50%:\n\t * editor.execute( 'resizeImage', { width: '50%' } );\n\t *\n\t * // Removes the width attribute:\n\t * editor.execute( 'resizeImage', { width: null } );\n\t * ```\n\t *\n\t * @param options\n\t * @param options.width The new width of the image.\n\t * @fires execute\n\t */\n\tpublic override execute( options: { width: string | null } ): void {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst imageElement = imageUtils.getClosestSelectedImageElement( model.document.selection );\n\n\t\tthis.value = {\n\t\t\twidth: options.width,\n\t\t\theight: null\n\t\t};\n\n\t\tif ( imageElement ) {\n\t\t\tmodel.change( writer => {\n\t\t\t\twriter.setAttribute( 'resizedWidth', options.width, imageElement );\n\t\t\t\twriter.removeAttribute( 'resizedHeight', imageElement );\n\t\t\t\timageUtils.setImageNaturalSizeAttributes( imageElement );\n\t\t\t} );\n\t\t}\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/imageresizeediting\n */\n\nimport type { ViewElement } from 'ckeditor5/src/engine.js';\nimport { type Editor, Plugin } from 'ckeditor5/src/core.js';\nimport { ImageUtils } from '../imageutils.js';\nimport { ResizeImageCommand } from './resizeimagecommand.js';\nimport { widthAndHeightStylesAreBothSet } from '../image/utils.js';\n\n/**\n * The image resize editing feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n */\nexport class ImageResizeEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageResizeEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\teditor.config.define( 'image', {\n\t\t\tresizeUnit: '%',\n\t\t\tresizeOptions: [\n\t\t\t\t{\n\t\t\t\t\tname: 'resizeImage:original',\n\t\t\t\t\tvalue: null,\n\t\t\t\t\ticon: 'original'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'resizeImage:custom',\n\t\t\t\t\tvalue: 'custom',\n\t\t\t\t\ticon: 'custom'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'resizeImage:25',\n\t\t\t\t\tvalue: '25',\n\t\t\t\t\ticon: 'small'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'resizeImage:50',\n\t\t\t\t\tvalue: '50',\n\t\t\t\t\ticon: 'medium'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'resizeImage:75',\n\t\t\t\t\tvalue: '75',\n\t\t\t\t\ticon: 'large'\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst resizeImageCommand = new ResizeImageCommand( editor );\n\n\t\tthis._registerConverters( 'imageBlock' );\n\t\tthis._registerConverters( 'imageInline' );\n\n\t\t// Register `resizeImage` command and add `imageResize` command as an alias for backward compatibility.\n\t\teditor.commands.add( 'resizeImage', resizeImageCommand );\n\t\teditor.commands.add( 'imageResize', resizeImageCommand );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tthis._registerSchema();\n\t}\n\n\tprivate _registerSchema(): void {\n\t\tconst schema = this.editor.model.schema;\n\n\t\tif ( this.editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\tschema.extend( 'imageBlock', { allowAttributes: [ 'resizedWidth', 'resizedHeight' ] } );\n\t\t\tschema.setAttributeProperties( 'resizedWidth', { isFormatting: true } );\n\t\t\tschema.setAttributeProperties( 'resizedHeight', { isFormatting: true } );\n\t\t}\n\n\t\tif ( this.editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\tschema.extend( 'imageInline', { allowAttributes: [ 'resizedWidth', 'resizedHeight' ] } );\n\t\t\tschema.setAttributeProperties( 'resizedWidth', { isFormatting: true } );\n\t\t\tschema.setAttributeProperties( 'resizedHeight', { isFormatting: true } );\n\t\t}\n\t}\n\n\t/**\n\t * Registers image resize converters.\n\t *\n\t * @param imageType The type of the image.\n\t */\n\tprivate _registerConverters( imageType: 'imageBlock' | 'imageInline' ) {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\t// Dedicated converter to propagate image's attribute to the img tag.\n\t\teditor.conversion.for( 'downcast' ).add( dispatcher =>\n\t\t\tdispatcher.on( `attribute:resizedWidth:${ imageType }`, ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst viewWriter = conversionApi.writer;\n\t\t\t\tconst viewImg = conversionApi.mapper.toViewElement( data.item );\n\n\t\t\t\tif ( data.attributeNewValue !== null ) {\n\t\t\t\t\tviewWriter.setStyle( 'width', data.attributeNewValue, viewImg );\n\t\t\t\t\tviewWriter.addClass( 'image_resized', viewImg );\n\t\t\t\t} else {\n\t\t\t\t\tviewWriter.removeStyle( 'width', viewImg );\n\t\t\t\t\tviewWriter.removeClass( 'image_resized', viewImg );\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\n\t\teditor.conversion.for( 'dataDowncast' ).attributeToAttribute( {\n\t\t\tmodel: {\n\t\t\t\tname: imageType,\n\t\t\t\tkey: 'resizedHeight'\n\t\t\t},\n\t\t\tview: modelAttributeValue => ( {\n\t\t\t\tkey: 'style',\n\t\t\t\tvalue: {\n\t\t\t\t\t'height': modelAttributeValue\n\t\t\t\t}\n\t\t\t} )\n\t\t} );\n\n\t\teditor.conversion.for( 'editingDowncast' ).add( dispatcher =>\n\t\t\tdispatcher.on( `attribute:resizedHeight:${ imageType }`, ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst viewWriter = conversionApi.writer;\n\t\t\t\tconst viewImg = conversionApi.mapper.toViewElement( data.item );\n\t\t\t\tconst target = imageType === 'imageInline' ? imageUtils.findViewImgElement( viewImg ) : viewImg;\n\n\t\t\t\tif ( data.attributeNewValue !== null ) {\n\t\t\t\t\tviewWriter.setStyle( 'height', data.attributeNewValue, target );\n\t\t\t\t} else {\n\t\t\t\t\tviewWriter.removeStyle( 'height', target );\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\n\t\teditor.conversion.for( 'upcast' )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: imageType === 'imageBlock' ? 'figure' : 'img',\n\t\t\t\t\tstyles: {\n\t\t\t\t\t\twidth: /.+/\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmodel: {\n\t\t\t\t\tkey: 'resizedWidth',\n\t\t\t\t\tvalue: ( viewElement: ViewElement ) => {\n\t\t\t\t\t\tif ( widthAndHeightStylesAreBothSet( viewElement ) ) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn viewElement.getStyle( 'width' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\teditor.conversion.for( 'upcast' )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: imageType === 'imageBlock' ? 'figure' : 'img',\n\t\t\t\t\tstyles: {\n\t\t\t\t\t\theight: /.+/\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmodel: {\n\t\t\t\t\tkey: 'resizedHeight',\n\t\t\t\t\tvalue: ( viewElement: ViewElement ) => {\n\t\t\t\t\t\tif ( widthAndHeightStylesAreBothSet( viewElement ) ) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn viewElement.getStyle( 'height' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\teditor.conversion.for( 'upcast' ).add( dispatcher => {\n\t\t\tdispatcher.on( `element:${ imageType === 'imageBlock' ? 'figure' : 'img' }`, ( evt, data, conversionApi ) => {\n\t\t\t\tconversionApi.consumable.consume( data.viewItem, { classes: [ 'image_resized' ] } );\n\t\t\t} );\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/imageresizebuttons\n */\n\nimport { Plugin, type Editor } from 'ckeditor5/src/core.js';\nimport {\n\tButtonView,\n\tDropdownButtonView,\n\tUIModel,\n\tcreateDropdown,\n\taddListToDropdown,\n\ttype ListDropdownItemDefinition\n} from 'ckeditor5/src/ui.js';\nimport { CKEditorError, Collection, type Locale } from 'ckeditor5/src/utils.js';\nimport {\n\tIconObjectSizeCustom,\n\tIconObjectSizeFull,\n\tIconObjectSizeLarge,\n\tIconObjectSizeMedium,\n\tIconObjectSizeSmall\n} from 'ckeditor5/src/icons.js';\n\nimport { ImageResizeEditing } from './imageresizeediting.js';\n\nimport { type ResizeImageCommand } from './resizeimagecommand.js';\nimport type { ImageResizeOption } from '../imageconfig.js';\n\nconst RESIZE_ICONS = /* #__PURE__ */ ( () => ( {\n\tsmall: IconObjectSizeSmall,\n\tmedium: IconObjectSizeMedium,\n\tlarge: IconObjectSizeLarge,\n\tcustom: IconObjectSizeCustom,\n\toriginal: IconObjectSizeFull\n} ) )();\n\n/**\n * The image resize buttons plugin.\n *\n * It adds a possibility to resize images using the toolbar dropdown or individual buttons, depending on the plugin configuration.\n */\nexport class ImageResizeButtons extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageResizeEditing ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageResizeButtons' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * The resize unit.\n\t * @default '%'\n\t */\n\tprivate readonly _resizeUnit: 'px' | '%';\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor: Editor ) {\n\t\tsuper( editor );\n\n\t\tthis._resizeUnit = editor.config.get( 'image.resizeUnit' )!;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst options = editor.config.get( 'image.resizeOptions' )!;\n\t\tconst command: ResizeImageCommand = editor.commands.get( 'resizeImage' )!;\n\n\t\tthis.bind( 'isEnabled' ).to( command );\n\n\t\tfor ( const option of options ) {\n\t\t\tthis._registerImageResizeButton( option );\n\t\t}\n\n\t\tthis._registerImageResizeDropdown( options );\n\t}\n\n\t/**\n\t * A helper function that creates a standalone button component for the plugin.\n\t *\n\t * @param option A model of the resize option.\n\t */\n\tprivate _registerImageResizeButton( option: ImageResizeOption ): void {\n\t\tconst editor = this.editor;\n\t\tconst { name, value, icon } = option;\n\n\t\teditor.ui.componentFactory.add( name, locale => {\n\t\t\tconst button = new ButtonView( locale );\n\t\t\tconst command: ResizeImageCommand = editor.commands.get( 'resizeImage' )!;\n\t\t\tconst labelText = this._getOptionLabelValue( option, true );\n\n\t\t\tif ( !RESIZE_ICONS[ icon as keyof typeof RESIZE_ICONS ] ) {\n\t\t\t\t/**\n\t\t\t\t * When configuring {@link module:image/imageconfig~ImageConfig#resizeOptions `config.image.resizeOptions`} for standalone\n\t\t\t\t * buttons, a valid `icon` token must be set for each option.\n\t\t\t\t *\n\t\t\t\t * See all valid options described in the\n\t\t\t\t * {@link module:image/imageconfig~ImageResizeOption plugin configuration}.\n\t\t\t\t *\n\t\t\t\t * @error imageresizebuttons-missing-icon\n\t\t\t\t * @param {module:image/imageconfig~ImageResizeOption} option Invalid image resize option.\n\t\t\t\t*/\n\t\t\t\tthrow new CKEditorError(\n\t\t\t\t\t'imageresizebuttons-missing-icon',\n\t\t\t\t\teditor,\n\t\t\t\t\toption\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tbutton.set( {\n\t\t\t\t// Use the `label` property for a verbose description (because of ARIA).\n\t\t\t\tlabel: labelText,\n\t\t\t\ticon: RESIZE_ICONS[ icon as keyof typeof RESIZE_ICONS ],\n\t\t\t\ttooltip: labelText,\n\t\t\t\tisToggleable: true\n\t\t\t} );\n\n\t\t\t// Bind button to the command.\n\t\t\tbutton.bind( 'isEnabled' ).to( this );\n\n\t\t\tif ( editor.plugins.has( 'ImageCustomResizeUI' ) && isCustomImageResizeOption( option ) ) {\n\t\t\t\tconst customResizeUI = editor.plugins.get( 'ImageCustomResizeUI' );\n\n\t\t\t\tthis.listenTo( button, 'execute', () => {\n\t\t\t\t\tcustomResizeUI._showForm( this._resizeUnit );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tconst optionValueWithUnit = value ? value + this._resizeUnit : null;\n\n\t\t\t\tbutton.bind( 'isOn' ).to(\n\t\t\t\t\tcommand, 'value',\n\t\t\t\t\tcommand, 'isEnabled',\n\t\t\t\t\tgetIsOnButtonCallback( optionValueWithUnit )\n\t\t\t\t);\n\n\t\t\t\tthis.listenTo( button, 'execute', () => {\n\t\t\t\t\teditor.execute( 'resizeImage', { width: optionValueWithUnit } );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn button;\n\t\t} );\n\t}\n\n\t/**\n\t * A helper function that creates a dropdown component for the plugin containing all the resize options defined in\n\t * the editor configuration.\n\t *\n\t * @param options An array of configured options.\n\t */\n\tprivate _registerImageResizeDropdown( options: Array<ImageResizeOption> ): void {\n\t\tconst editor = this.editor;\n\t\tconst t = editor.t;\n\t\tconst originalSizeOption = options.find( option => !option.value )!;\n\n\t\tconst componentCreator = ( locale: Locale ) => {\n\t\t\tconst command: ResizeImageCommand = editor.commands.get( 'resizeImage' )!;\n\t\t\tconst dropdownView = createDropdown( locale, DropdownButtonView );\n\t\t\tconst dropdownButton: typeof dropdownView.buttonView & { commandValue?: string | null } = dropdownView.buttonView;\n\t\t\tconst accessibleLabel = t( 'Resize image' );\n\n\t\t\tdropdownButton.set( {\n\t\t\t\ttooltip: accessibleLabel,\n\t\t\t\tcommandValue: originalSizeOption.value,\n\t\t\t\ticon: RESIZE_ICONS.medium,\n\t\t\t\tisToggleable: true,\n\t\t\t\tlabel: this._getOptionLabelValue( originalSizeOption ),\n\t\t\t\twithText: true,\n\t\t\t\tclass: 'ck-resize-image-button',\n\t\t\t\tariaLabel: accessibleLabel,\n\t\t\t\tariaLabelledBy: undefined\n\t\t\t} );\n\n\t\t\tdropdownButton.bind( 'label' ).to( command, 'value', commandValue => {\n\t\t\t\tif ( commandValue && commandValue.width ) {\n\t\t\t\t\treturn commandValue.width;\n\t\t\t\t} else {\n\t\t\t\t\treturn this._getOptionLabelValue( originalSizeOption );\n\t\t\t\t}\n\t\t\t} );\n\t\t\tdropdownView.bind( 'isEnabled' ).to( this );\n\n\t\t\taddListToDropdown( dropdownView, () => this._getResizeDropdownListItemDefinitions( options, command ), {\n\t\t\t\tariaLabel: t( 'Image resize list' ),\n\t\t\t\trole: 'menu'\n\t\t\t} );\n\n\t\t\t// Execute command when an item from the dropdown is selected.\n\t\t\tthis.listenTo( dropdownView, 'execute', evt => {\n\t\t\t\tif ( 'onClick' in evt.source ) {\n\t\t\t\t\t( evt.source as any ).onClick();\n\t\t\t\t} else {\n\t\t\t\t\teditor.execute( ( evt.source as any ).commandName, { width: ( evt.source as any ).commandValue } );\n\t\t\t\t\teditor.editing.view.focus();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn dropdownView;\n\t\t};\n\n\t\t// Register `resizeImage` dropdown and add `imageResize` dropdown as an alias for backward compatibility.\n\t\teditor.ui.componentFactory.add( 'resizeImage', componentCreator );\n\t\teditor.ui.componentFactory.add( 'imageResize', componentCreator );\n\t}\n\n\t/**\n\t * A helper function for creating an option label value string.\n\t *\n\t * @param option A resize option object.\n\t * @param forTooltip An optional flag for creating a tooltip label.\n\t * @returns A user-defined label combined from the numeric value and the resize unit or the default label\n\t * for reset options (`Original`).\n\t */\n\tprivate _getOptionLabelValue( option: ImageResizeOption, forTooltip: boolean = false ): string {\n\t\tconst t = this.editor.t;\n\n\t\tif ( option.label ) {\n\t\t\treturn option.label;\n\t\t} else if ( forTooltip ) {\n\t\t\tif ( isCustomImageResizeOption( option ) ) {\n\t\t\t\treturn t( 'Custom image size' );\n\t\t\t} else if ( option.value ) {\n\t\t\t\treturn t( 'Resize image to %0', option.value + this._resizeUnit );\n\t\t\t} else {\n\t\t\t\treturn t( 'Resize image to the original size' );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( isCustomImageResizeOption( option ) ) {\n\t\t\t\treturn t( 'Custom' );\n\t\t\t} else if ( option.value ) {\n\t\t\t\treturn option.value + this._resizeUnit;\n\t\t\t} else {\n\t\t\t\treturn t( 'Original' );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * A helper function that parses the resize options and returns list item definitions ready for use in the dropdown.\n\t *\n\t * @param options The resize options.\n\t * @param command The resize image command.\n\t * @returns Dropdown item definitions.\n\t */\n\tprivate _getResizeDropdownListItemDefinitions(\n\t\toptions: Array<ImageResizeOption>,\n\t\tcommand: ResizeImageCommand\n\t): Collection<ListDropdownItemDefinition> {\n\t\tconst { editor } = this;\n\t\tconst itemDefinitions = new Collection<ListDropdownItemDefinition>();\n\n\t\tconst optionsWithSerializedValues = options.map( option => {\n\t\t\tif ( isCustomImageResizeOption( option ) ) {\n\t\t\t\treturn {\n\t\t\t\t\t...option,\n\t\t\t\t\tvalueWithUnits: 'custom'\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif ( !option.value ) {\n\t\t\t\treturn {\n\t\t\t\t\t...option,\n\t\t\t\t\tvalueWithUnits: null\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...option,\n\t\t\t\tvalueWithUnits: `${ option.value }${ this._resizeUnit }`\n\t\t\t};\n\t\t} );\n\n\t\tfor ( const option of optionsWithSerializedValues ) {\n\t\t\tlet definition: ListDropdownItemDefinition | null = null;\n\n\t\t\tif ( editor.plugins.has( 'ImageCustomResizeUI' ) && isCustomImageResizeOption( option ) ) {\n\t\t\t\tconst customResizeUI = editor.plugins.get( 'ImageCustomResizeUI' );\n\n\t\t\t\tdefinition = {\n\t\t\t\t\ttype: 'button',\n\t\t\t\t\tmodel: new UIModel( {\n\t\t\t\t\t\tlabel: this._getOptionLabelValue( option ),\n\t\t\t\t\t\trole: 'menuitemradio',\n\t\t\t\t\t\twithText: true,\n\t\t\t\t\t\ticon: null,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tcustomResizeUI._showForm( this._resizeUnit );\n\t\t\t\t\t\t}\n\t\t\t\t\t} )\n\t\t\t\t};\n\n\t\t\t\tconst allDropdownValues = Object.values( optionsWithSerializedValues ).map( option => option.valueWithUnits );\n\n\t\t\t\tdefinition.model.bind( 'isOn' ).to(\n\t\t\t\t\tcommand, 'value',\n\t\t\t\t\tcommand, 'isEnabled',\n\t\t\t\t\tgetIsOnCustomButtonCallback( allDropdownValues )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdefinition = {\n\t\t\t\t\ttype: 'button',\n\t\t\t\t\tmodel: new UIModel( {\n\t\t\t\t\t\tcommandName: 'resizeImage',\n\t\t\t\t\t\tcommandValue: option.valueWithUnits,\n\t\t\t\t\t\tlabel: this._getOptionLabelValue( option ),\n\t\t\t\t\t\trole: 'menuitemradio',\n\t\t\t\t\t\twithText: true,\n\t\t\t\t\t\ticon: null\n\t\t\t\t\t} )\n\t\t\t\t};\n\n\t\t\t\tdefinition.model.bind( 'isOn' ).to(\n\t\t\t\t\tcommand, 'value',\n\t\t\t\t\tcommand, 'isEnabled',\n\t\t\t\t\tgetIsOnButtonCallback( option.valueWithUnits )\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tdefinition.model.bind( 'isEnabled' ).to( command, 'isEnabled' );\n\t\t\titemDefinitions.add( definition );\n\t\t}\n\n\t\treturn itemDefinitions;\n\t}\n}\n\n/**\n * A helper that checks if provided option triggers custom resize balloon.\n */\nfunction isCustomImageResizeOption( option: ImageResizeOption ) {\n\treturn option.value === 'custom';\n}\n\n/**\n * A helper function for setting the `isOn` state of buttons in value bindings.\n */\nfunction getIsOnButtonCallback( value: string | null ) {\n\treturn ( commandValue: ResizeImageCommand['value'], isEnabled: boolean ): boolean => {\n\t\tconst objectCommandValue = commandValue as null | undefined | { width: string | null };\n\n\t\tif ( objectCommandValue === undefined || !isEnabled ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( value === null && objectCommandValue === value ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn objectCommandValue !== null && objectCommandValue.width === value;\n\t};\n}\n\n/**\n * A helper function for setting the `isOn` state of custom size button in value bindings.\n */\nfunction getIsOnCustomButtonCallback( allDropdownValues: Array<string | null> ) {\n\treturn ( commandValue: ResizeImageCommand['value'], isEnabled: boolean ): boolean => !allDropdownValues.some(\n\t\tdropdownValue => getIsOnButtonCallback( dropdownValue )( commandValue, isEnabled )\n\t);\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/imageresizehandles\n */\n\nimport type { ModelElement, ViewElement } from 'ckeditor5/src/engine.js';\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { WidgetResize } from 'ckeditor5/src/widget.js';\nimport { ImageUtils } from '../imageutils.js';\n\nimport { ImageLoadObserver, type ImageLoadedEvent } from '../image/imageloadobserver.js';\nimport { type ResizeImageCommand } from './resizeimagecommand.js';\n\nconst RESIZABLE_IMAGES_CSS_SELECTOR =\n\t'figure.image.ck-widget > img,' +\n\t'figure.image.ck-widget > picture > img,' +\n\t'figure.image.ck-widget > a > img,' +\n\t'figure.image.ck-widget > a > picture > img,' +\n\t'span.image-inline.ck-widget > img,' +\n\t'span.image-inline.ck-widget > picture > img';\n\nconst RESIZED_IMAGE_CLASS = 'image_resized';\n\n/**\n * The image resize by handles feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n */\nexport class ImageResizeHandles extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ WidgetResize, ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageResizeHandles' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst command: ResizeImageCommand = this.editor.commands.get( 'resizeImage' )!;\n\t\tthis.bind( 'isEnabled' ).to( command );\n\n\t\tthis._setupResizerCreator();\n\t}\n\n\t/**\n\t * Attaches the listeners responsible for creating a resizer for each image, except for images inside the HTML embed preview.\n\t */\n\tprivate _setupResizerCreator(): void {\n\t\tconst editor = this.editor;\n\t\tconst editingView = editor.editing.view;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\teditingView.addObserver( ImageLoadObserver );\n\n\t\tthis.listenTo<ImageLoadedEvent>( editingView.document, 'imageLoaded', ( evt, domEvent ) => {\n\t\t\t// The resizer must be attached only to images loaded by the `ImageInsert`, `ImageUpload` or `LinkImage` plugins.\n\t\t\tif ( !( domEvent.target as HTMLElement ).matches( RESIZABLE_IMAGES_CSS_SELECTOR ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst domConverter = editor.editing.view.domConverter;\n\t\t\tconst imageView = domConverter.domToView( domEvent.target as HTMLElement ) as ViewElement;\n\t\t\tconst widgetView = imageUtils.getImageWidgetFromImageView( imageView )!;\n\t\t\tlet resizer = this.editor.plugins.get( WidgetResize ).getResizerByViewElement( widgetView );\n\n\t\t\tif ( resizer ) {\n\t\t\t\t// There are rare cases when the image will be triggered multiple times for the same widget, e.g. when\n\t\t\t\t// the image's source was changed after upload (https://github.com/ckeditor/ckeditor5/pull/8108#issuecomment-708302992).\n\t\t\t\tresizer.redraw();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst mapper = editor.editing.mapper;\n\t\t\tconst imageModel = mapper.toModelElement( widgetView )!;\n\n\t\t\tresizer = editor.plugins\n\t\t\t\t.get( WidgetResize )\n\t\t\t\t.attachTo( {\n\t\t\t\t\tunit: editor.config.get( 'image.resizeUnit' )!,\n\n\t\t\t\t\tmodelElement: imageModel,\n\t\t\t\t\tviewElement: widgetView,\n\t\t\t\t\teditor,\n\n\t\t\t\t\tgetHandleHost( domWidgetElement ) {\n\t\t\t\t\t\treturn domWidgetElement.querySelector( 'img' )!;\n\t\t\t\t\t},\n\t\t\t\t\tgetResizeHost() {\n\t\t\t\t\t\treturn domConverter.mapViewToDom( mapper.toViewElement( imageModel as ModelElement )! ) as HTMLElement;\n\t\t\t\t\t},\n\n\t\t\t\t\tisCentered() {\n\t\t\t\t\t\tconst imageStyle = imageModel.getAttribute( 'imageStyle' );\n\n\t\t\t\t\t\treturn imageStyle == 'alignCenter';\n\t\t\t\t\t},\n\n\t\t\t\t\tonCommit( newValue ) {\n\t\t\t\t\t\t// Get rid of the CSS class in case the command execution that follows is unsuccessful\n\t\t\t\t\t\t// (e.g. Track Changes can override it and the new dimensions will not apply). Otherwise,\n\t\t\t\t\t\t// the presence of the class and the absence of the width style will cause it to take 100%\n\t\t\t\t\t\t// of the horizontal space.\n\t\t\t\t\t\teditingView.change( writer => {\n\t\t\t\t\t\t\twriter.removeClass( RESIZED_IMAGE_CLASS, widgetView );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\teditor.execute( 'resizeImage', { width: newValue } );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\tresizer.on( 'updateSize', () => {\n\t\t\t\tif ( !widgetView.hasClass( RESIZED_IMAGE_CLASS ) ) {\n\t\t\t\t\teditingView.change( writer => {\n\t\t\t\t\t\twriter.addClass( RESIZED_IMAGE_CLASS, widgetView );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tconst target = imageModel.name === 'imageInline' ? imageView : widgetView;\n\n\t\t\t\tif ( target.getStyle( 'height' ) ) {\n\t\t\t\t\teditingView.change( writer => {\n\t\t\t\t\t\twriter.removeStyle( 'height', target );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tresizer.bind( 'isEnabled' ).to( this );\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/utils/tryparsedimensionwithunit\n */\n\n/**\n * Parses provided string with dimension value and returns extracted numeric value and unit.\n *\n * \t* If non-string dimension is passed then `null` value is returned.\n * \t* If unit is missing then `null` is returned.\n * \t* If numeric value part of string is not a number then `null` is returned.\n *\n * Example:\n * \t`\"222px\"` => `{ value: 222, unit: \"px\" }`\n *\t`\"99%\"` => `{ value: 99, unit: \"%\" }`\n\n * @param dimension Unsafe string with dimension.\n * @returns Parsed dimension with extracted numeric value and units.\n * @internal\n */\nexport function tryParseDimensionWithUnit( dimension: string | null | undefined ): DimensionWithUnit | null {\n\tif ( !dimension ) {\n\t\treturn null;\n\t}\n\n\tconst [ , rawValue, unit ] = dimension.trim().match( /([.,\\d]+)(%|px)$/ ) || [];\n\tconst parsedValue = Number.parseFloat( rawValue );\n\n\tif ( Number.isNaN( parsedValue ) ) {\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tvalue: parsedValue,\n\t\tunit\n\t};\n}\n\n/**\n * Converts dimension between `px` -> `%` and `%` -> `px`.\n *\n * @param parentDimensionPx\tDimension of parent element that contains measured element.\n * @param dimension Measured element dimension.\n * @returns Casted dimension.\n * @internal\n */\nexport function tryCastDimensionsToUnit( parentDimensionPx: number, dimension: DimensionWithUnit, targetUnit: string ): DimensionWithUnit {\n\t// \"%\" -> \"px\" conversion\n\tif ( targetUnit === 'px' ) {\n\t\treturn {\n\t\t\tvalue: dimension.value,\n\t\t\tunit: 'px'\n\t\t};\n\t}\n\n\t// \"px\" -> \"%\" conversion\n\treturn {\n\t\tvalue: dimension.value / parentDimensionPx * 100,\n\t\tunit: '%'\n\t};\n}\n\n/**\n * @internal\n */\nexport type DimensionWithUnit = {\n\tvalue: number;\n\tunit: string;\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/utils/getselectedimageeditornodes\n */\n\nimport type { ViewElement, ModelElement } from 'ckeditor5/src/engine.js';\nimport type { Editor } from 'ckeditor5/src/core.js';\n\n/**\n * Finds model, view and DOM element for selected image element. Returns `null` if there is no image selected.\n *\n * @param editor Editor instance.\n * @internal\n */\nexport function getSelectedImageEditorNodes( editor: Editor ): ImageEditorNodes | null {\n\tconst { editing } = editor;\n\n\tconst imageUtils = editor.plugins.get( 'ImageUtils' );\n\tconst imageModelElement = imageUtils.getClosestSelectedImageElement( editor.model.document.selection );\n\n\tif ( !imageModelElement ) {\n\t\treturn null;\n\t}\n\n\tconst imageViewElement = editing.mapper.toViewElement( imageModelElement )!;\n\tconst imageDOMElement = editing.view.domConverter.mapViewToDom( imageViewElement )!;\n\n\treturn {\n\t\tmodel: imageModelElement,\n\t\tview: imageViewElement,\n\t\tdom: imageDOMElement\n\t};\n}\n\n/**\n * @internal;\n */\ntype ImageEditorNodes = {\n\tmodel: ModelElement;\n\tview: ViewElement;\n\tdom: HTMLElement;\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/utils/getselectedimagewidthinunits\n */\n\nimport { Rect } from 'ckeditor5/src/utils.js';\n\nimport { calculateResizeHostAncestorWidth } from 'ckeditor5/src/widget.js';\nimport type { Editor } from 'ckeditor5/src/core.js';\n\nimport { tryCastDimensionsToUnit, tryParseDimensionWithUnit, type DimensionWithUnit } from './tryparsedimensionwithunit.js';\nimport { getSelectedImageEditorNodes } from './getselectedimageeditornodes.js';\n\n/**\n * Returns image width in specified units. It is width of image after resize.\n *\n * \t* If image is not selected or command is disabled then `null` will be returned.\n * \t* If image is not fully loaded (and it is impossible to determine its natural size) then `null` will be returned.\n *\t* If `targetUnit` percentage is passed then it will return width percentage of image related to its accessors.\n *\n * @param editor Editor instance.\n * @param targetUnit Unit in which dimension will be returned.\n * @returns Parsed image width after resize (with unit).\n * @internal\n */\nexport function getSelectedImageWidthInUnits( editor: Editor, targetUnit: string ): DimensionWithUnit | null {\n\tconst imageNodes = getSelectedImageEditorNodes( editor );\n\n\tif ( !imageNodes ) {\n\t\treturn null;\n\t}\n\n\tconst parsedResizedWidth = tryParseDimensionWithUnit(\n\t\timageNodes.model.getAttribute( 'resizedWidth' ) as string || null\n\t);\n\n\tif ( !parsedResizedWidth ) {\n\t\treturn null;\n\t}\n\n\tif ( parsedResizedWidth.unit === targetUnit ) {\n\t\treturn parsedResizedWidth;\n\t}\n\n\tconst imageParentWidthPx = calculateResizeHostAncestorWidth( imageNodes.dom );\n\tconst imageHolderDimension = {\n\t\tunit: 'px',\n\t\tvalue: new Rect( imageNodes.dom ).width\n\t};\n\n\treturn tryCastDimensionsToUnit( imageParentWidthPx, imageHolderDimension, targetUnit );\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/ui/imagecustomresizeformview\n */\n\nimport {\n\tButtonView,\n\tFocusCycler,\n\tFormHeaderView,\n\tFormRowView,\n\tLabeledFieldView,\n\tView,\n\tViewCollection,\n\tcreateLabeledInputNumber,\n\tsubmitHandler,\n\ttype FocusableView,\n\ttype InputNumberView\n} from 'ckeditor5/src/ui.js';\n\nimport { FocusTracker, KeystrokeHandler, type Locale } from 'ckeditor5/src/utils.js';\nimport { IconPreviousArrow } from 'ckeditor5/src/icons.js';\n\nimport '../../../theme/imagecustomresizeform.css';\n\n// See: #8833.\n// eslint-disable-next-line ckeditor5-rules/ckeditor-imports\nimport '@ckeditor/ckeditor5-ui/theme/components/responsive-form/responsiveform.css';\n// eslint-disable-next-line ckeditor5-rules/ckeditor-imports\nimport '@ckeditor/ckeditor5-ui/theme/components/form/form.css';\n\n/**\n * The ImageCustomResizeFormView class.\n *\n * @internal\n */\nexport class ImageCustomResizeFormView extends View {\n\t/**\n\t * Tracks information about the DOM focus in the form.\n\t */\n\tpublic readonly focusTracker: FocusTracker;\n\n\t/**\n\t * An instance of the {@link module:utils/keystrokehandler~KeystrokeHandler}.\n\t */\n\tpublic readonly keystrokes: KeystrokeHandler;\n\n\t/**\n\t * Resize unit shortcut.\n\t */\n\tpublic readonly unit: string;\n\n\t/**\n\t * The Back button view displayed in the header.\n\t */\n\tpublic backButtonView: ButtonView;\n\n\t/**\n\t * A button used to submit the form.\n\t */\n\tpublic saveButtonView: ButtonView;\n\n\t/**\n\t * An input with a label.\n\t */\n\tpublic labeledInput: LabeledFieldView<InputNumberView>;\n\n\t/**\n\t * A collection of child views.\n\t */\n\tpublic readonly children: ViewCollection;\n\n\t/**\n\t * A collection of views which can be focused in the form.\n\t */\n\tprotected readonly _focusables: ViewCollection<FocusableView>;\n\n\t/**\n\t * Helps cycling over {@link #_focusables} in the form.\n\t */\n\tprotected readonly _focusCycler: FocusCycler;\n\n\t/**\n\t * An array of form validators used by {@link #isValid}.\n\t */\n\tprivate readonly _validators: Array<ImageCustomResizeFormValidatorCallback>;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( locale: Locale, unit: string, validators: Array<ImageCustomResizeFormValidatorCallback> ) {\n\t\tsuper( locale );\n\n\t\tthis.focusTracker = new FocusTracker();\n\t\tthis.keystrokes = new KeystrokeHandler();\n\t\tthis.unit = unit;\n\n\t\t// Create buttons.\n\t\tthis.backButtonView = this._createBackButton();\n\t\tthis.saveButtonView = this._createSaveButton();\n\n\t\t// Create input fields.\n\t\tthis.labeledInput = this._createLabeledInputView();\n\n\t\tthis.children = this.createCollection( [ this._createHeaderView() ] );\n\t\tthis.children.add( new FormRowView( locale, {\n\t\t\tchildren: [\n\t\t\t\tthis.labeledInput,\n\t\t\t\tthis.saveButtonView\n\t\t\t],\n\t\t\tclass: [\n\t\t\t\t'ck-form__row_with-submit',\n\t\t\t\t'ck-form__row_large-top-padding'\n\t\t\t]\n\t\t} ) );\n\n\t\tthis._focusables = new ViewCollection();\n\t\tthis._validators = validators;\n\n\t\t// Close the panel on esc key press when the **form has focus**.\n\t\tthis.keystrokes.set( 'Esc', ( data, cancel ) => {\n\t\t\tthis.fire<ImageCustomResizeFormViewCancelEvent>( 'cancel' );\n\t\t\tcancel();\n\t\t} );\n\n\t\tthis._focusCycler = new FocusCycler( {\n\t\t\tfocusables: this._focusables,\n\t\t\tfocusTracker: this.focusTracker,\n\t\t\tkeystrokeHandler: this.keystrokes,\n\t\t\tactions: {\n\t\t\t\t// Navigate form fields backwards using the Shift + Tab keystroke.\n\t\t\t\tfocusPrevious: 'shift + tab',\n\n\t\t\t\t// Navigate form fields forwards using the Tab key.\n\t\t\t\tfocusNext: 'tab'\n\t\t\t}\n\t\t} );\n\n\t\tthis.setTemplate( {\n\t\t\ttag: 'form',\n\n\t\t\tattributes: {\n\t\t\t\tclass: [\n\t\t\t\t\t'ck',\n\t\t\t\t\t'ck-form',\n\t\t\t\t\t'ck-image-custom-resize-form',\n\t\t\t\t\t'ck-responsive-form'\n\t\t\t\t],\n\n\t\t\t\t// https://github.com/ckeditor/ckeditor5-image/issues/40\n\t\t\t\ttabindex: '-1'\n\t\t\t},\n\n\t\t\tchildren: this.children\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override render(): void {\n\t\tsuper.render();\n\n\t\tsubmitHandler( {\n\t\t\tview: this\n\t\t} );\n\n\t\tconst childViews = [\n\t\t\tthis.backButtonView,\n\t\t\tthis.labeledInput,\n\t\t\tthis.saveButtonView\n\t\t];\n\n\t\tchildViews.forEach( v => {\n\t\t\t// Register the view as focusable.\n\t\t\tthis._focusables.add( v );\n\n\t\t\t// Register the view in the focus tracker.\n\t\t\tthis.focusTracker.add( v.element! );\n\t\t} );\n\n\t\tthis.keystrokes.listenTo( this.element! );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tsuper.destroy();\n\n\t\tthis.focusTracker.destroy();\n\t\tthis.keystrokes.destroy();\n\t}\n\n\t/**\n\t * Creates a back button view that cancels the form.\n\t */\n\tprivate _createBackButton(): ButtonView {\n\t\tconst t = this.locale!.t;\n\t\tconst backButton = new ButtonView( this.locale );\n\n\t\tbackButton.set( {\n\t\t\tclass: 'ck-button-back',\n\t\t\tlabel: t( 'Back' ),\n\t\t\ticon: IconPreviousArrow,\n\t\t\ttooltip: true\n\t\t} );\n\n\t\tbackButton.delegate( 'execute' ).to( this, 'cancel' );\n\n\t\treturn backButton;\n\t}\n\n\t/**\n\t * Creates a save button view that resize the image.\n\t */\n\tprivate _createSaveButton(): ButtonView {\n\t\tconst t = this.locale!.t;\n\t\tconst saveButton = new ButtonView( this.locale );\n\n\t\tsaveButton.set( {\n\t\t\tlabel: t( 'Save' ),\n\t\t\twithText: true,\n\t\t\ttype: 'submit',\n\t\t\tclass: 'ck-button-action ck-button-bold'\n\t\t} );\n\n\t\treturn saveButton;\n\t}\n\n\t/**\n\t * Creates a header view for the form.\n\t */\n\tprivate _createHeaderView(): FormHeaderView {\n\t\tconst t = this.locale!.t;\n\n\t\tconst header = new FormHeaderView( this.locale, {\n\t\t\tlabel: t( 'Image Resize' )\n\t\t} );\n\n\t\theader.children.add( this.backButtonView, 0 );\n\n\t\treturn header;\n\t}\n\n\t/**\n\t * Creates an input with a label.\n\t *\n\t * @returns Labeled field view instance.\n\t */\n\tprivate _createLabeledInputView(): LabeledFieldView<InputNumberView> {\n\t\tconst t = this.locale!.t;\n\t\tconst labeledInput = new LabeledFieldView<InputNumberView>( this.locale, createLabeledInputNumber );\n\n\t\tlabeledInput.label = t( 'Resize image (in %0)', this.unit );\n\t\tlabeledInput.class = 'ck-labeled-field-view_full-width';\n\t\tlabeledInput.fieldView.set( {\n\t\t\tstep: 0.1\n\t\t} );\n\n\t\treturn labeledInput;\n\t}\n\n\t/**\n\t * Validates the form and returns `false` when some fields are invalid.\n\t */\n\tpublic isValid(): boolean {\n\t\tthis.resetFormStatus();\n\n\t\tfor ( const validator of this._validators ) {\n\t\t\tconst errorText = validator( this );\n\n\t\t\t// One error per field is enough.\n\t\t\tif ( errorText ) {\n\t\t\t\t// Apply updated error.\n\t\t\t\tthis.labeledInput.errorText = errorText;\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Cleans up the supplementary error and information text of the {@link #labeledInput}\n\t * bringing them back to the state when the form has been displayed for the first time.\n\t *\n\t * See {@link #isValid}.\n\t */\n\tpublic resetFormStatus(): void {\n\t\tthis.labeledInput.errorText = null;\n\t}\n\n\t/**\n\t * The native DOM `value` of the input element of {@link #labeledInput}.\n\t */\n\tpublic get rawSize(): string | null {\n\t\tconst { element } = this.labeledInput.fieldView;\n\n\t\tif ( !element ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn element.value;\n\t}\n\n\t/**\n\t * Get numeric value of size. Returns `null` if value of size input element in {@link #labeledInput}.is not a number.\n\t */\n\tpublic get parsedSize(): number | null {\n\t\tconst { rawSize } = this;\n\n\t\tif ( rawSize === null ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parsed = Number.parseFloat( rawSize );\n\n\t\tif ( Number.isNaN( parsed ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn parsed;\n\t}\n\n\t/**\n\t * Returns serialized image input size with unit.\n\t * Returns `null` if value of size input element in {@link #labeledInput}.is not a number.\n\t */\n\tpublic get sizeWithUnits(): string | null {\n\t\tconst { parsedSize, unit } = this;\n\n\t\tif ( parsedSize === null ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn `${ parsedSize }${ unit }`;\n\t}\n}\n\n/**\n * Callback used by {@link ~ImageCustomResizeFormView} to check if passed form value is valid.\n *\n * \t* If `undefined` is returned, it is assumed that the form value is correct and there is no error.\n * \t* If string is returned, it is assumed that the form value is incorrect and the returned string is displayed in the error label\n *\n * @internal\n */\nexport type ImageCustomResizeFormValidatorCallback = ( form: ImageCustomResizeFormView ) => string | undefined;\n\n/**\n * Fired when the form view is submitted.\n *\n * @eventName ~ImageCustomResizeFormView#submit\n */\nexport type ImageCustomResizeFormViewSubmitEvent = {\n\tname: 'submit';\n\targs: [];\n};\n\n/**\n * Fired when the form view is canceled.\n *\n * @eventName ~ImageCustomResizeFormView#cancel\n */\nexport type ImageCustomResizeFormViewCancelEvent = {\n\tname: 'cancel';\n\targs: [];\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/utils/getselectedimagepossibleresizerange\n */\n\nimport type { Editor } from 'ckeditor5/src/core.js';\n\nimport { calculateResizeHostAncestorWidth } from 'ckeditor5/src/widget.js';\nimport { getSelectedImageEditorNodes } from './getselectedimageeditornodes.js';\nimport { tryCastDimensionsToUnit, tryParseDimensionWithUnit } from './tryparsedimensionwithunit.js';\n\n/**\n * Returns min and max value of resize image in specified unit.\n *\n * @param editor Editor instance.\n * @param targetUnit Unit in which dimension will be returned.\n * @returns Possible resize range in numeric form.\n * @internal\n */\nexport function getSelectedImagePossibleResizeRange( editor: Editor, targetUnit: string ): PossibleResizeImageRange | null {\n\tconst imageNodes = getSelectedImageEditorNodes( editor );\n\n\tif ( !imageNodes ) {\n\t\treturn null;\n\t}\n\n\tconst imageParentWidthPx = calculateResizeHostAncestorWidth( imageNodes.dom );\n\tconst minimumImageWidth = tryParseDimensionWithUnit( window.getComputedStyle( imageNodes.dom ).minWidth ) || {\n\t\tvalue: 1,\n\t\tunit: 'px'\n\t};\n\n\tconst lower = Math.max( 0.1, tryCastDimensionsToUnit( imageParentWidthPx, minimumImageWidth, targetUnit ).value );\n\tconst upper = targetUnit === 'px' ? imageParentWidthPx : 100;\n\n\treturn {\n\t\tunit: targetUnit,\n\t\tlower,\n\t\tupper\n\t};\n}\n\n/**\n * @internal\n */\nexport type PossibleResizeImageRange = {\n\tunit: string;\n\tlower: number;\n\tupper: number;\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize/imagecustomresizeui\n */\n\nimport { Plugin, type Editor } from 'ckeditor5/src/core.js';\nimport {\n\tContextualBalloon,\n\tclickOutsideHandler,\n\tCssTransitionDisablerMixin,\n\ttype ViewWithCssTransitionDisabler\n} from 'ckeditor5/src/ui.js';\n\nimport { getBalloonPositionData } from '../image/ui/utils.js';\nimport { getSelectedImageWidthInUnits } from './utils/getselectedimagewidthinunits.js';\n\nimport {\n\tImageCustomResizeFormView,\n\ttype ImageCustomResizeFormValidatorCallback,\n\ttype ImageCustomResizeFormViewCancelEvent,\n\ttype ImageCustomResizeFormViewSubmitEvent\n} from './ui/imagecustomresizeformview.js';\nimport { getSelectedImagePossibleResizeRange } from './utils/getselectedimagepossibleresizerange.js';\n\n/**\n * The custom resize image UI plugin.\n *\n * The plugin uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */\nexport class ImageCustomResizeUI extends Plugin {\n\t/**\n\t * The contextual balloon plugin instance.\n\t */\n\tprivate _balloon?: ContextualBalloon;\n\n\t/**\n\t * A form containing a textarea and buttons, used to change the `alt` text value.\n\t */\n\tprivate _form?: ImageCustomResizeFormView & ViewWithCssTransitionDisabler;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ContextualBalloon ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageCustomResizeUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override destroy(): void {\n\t\tsuper.destroy();\n\n\t\t// Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n\t\tif ( this._form ) {\n\t\t\tthis._form.destroy();\n\t\t}\n\t}\n\n\t/**\n\t * Creates the {@link module:image/imageresize/ui/imagecustomresizeformview~ImageCustomResizeFormView}\n\t * form.\n\t */\n\tprivate _createForm( unit: string ): void {\n\t\tconst editor = this.editor;\n\n\t\tthis._balloon = this.editor.plugins.get( 'ContextualBalloon' );\n\n\t\tthis._form = new ( CssTransitionDisablerMixin( ImageCustomResizeFormView ) )( editor.locale, unit, getFormValidators( editor ) );\n\n\t\t// Render the form so its #element is available for clickOutsideHandler.\n\t\tthis._form.render();\n\n\t\tthis.listenTo<ImageCustomResizeFormViewSubmitEvent>( this._form, 'submit', () => {\n\t\t\tif ( this._form!.isValid() ) {\n\t\t\t\teditor.execute( 'resizeImage', {\n\t\t\t\t\twidth: this._form!.sizeWithUnits\n\t\t\t\t} );\n\n\t\t\t\tthis._hideForm( true );\n\t\t\t}\n\t\t} );\n\n\t\t// Update balloon position when form error label is added .\n\t\tthis.listenTo( this._form.labeledInput, 'change:errorText', () => {\n\t\t\teditor.ui.update();\n\t\t} );\n\n\t\tthis.listenTo<ImageCustomResizeFormViewCancelEvent>( this._form, 'cancel', () => {\n\t\t\tthis._hideForm( true );\n\t\t} );\n\n\t\t// Close on click outside of balloon panel element.\n\t\tclickOutsideHandler( {\n\t\t\temitter: this._form,\n\t\t\tactivator: () => this._isVisible,\n\t\t\tcontextElements: () => [ this._balloon!.view.element! ],\n\t\t\tcallback: () => this._hideForm()\n\t\t} );\n\t}\n\n\t/**\n\t * Shows the {@link #_form} in the {@link #_balloon}.\n\t *\n\t * @internal\n\t */\n\tpublic _showForm( unit: string ): void {\n\t\tif ( this._isVisible ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this._form ) {\n\t\t\tthis._createForm( unit );\n\t\t}\n\n\t\tconst editor = this.editor;\n\t\tconst labeledInput = this._form!.labeledInput;\n\n\t\tthis._form!.disableCssTransitions();\n\t\tthis._form!.resetFormStatus();\n\n\t\tif ( !this._isInBalloon ) {\n\t\t\tthis._balloon!.add( {\n\t\t\t\tview: this._form!,\n\t\t\t\tposition: getBalloonPositionData( editor )\n\t\t\t} );\n\t\t}\n\n\t\t// Make sure that each time the panel shows up, the field remains in sync with the value of\n\t\t// the command. If the user typed in the input, then canceled the balloon (`labeledInput#value`\n\t\t// stays unaltered) and re-opened it without changing the value of the command, they would see the\n\t\t// old value instead of the actual value of the command.\n\t\tconst currentParsedWidth = getSelectedImageWidthInUnits( editor, unit );\n\t\tconst initialInputValue = currentParsedWidth ? currentParsedWidth.value.toFixed( 1 ) : '';\n\t\tconst possibleRange = getSelectedImagePossibleResizeRange( editor, unit );\n\n\t\tlabeledInput.fieldView.value = labeledInput.fieldView.element!.value = initialInputValue;\n\n\t\tif ( possibleRange ) {\n\t\t\tObject.assign( labeledInput.fieldView, {\n\t\t\t\tmin: possibleRange.lower.toFixed( 1 ),\n\t\t\t\tmax: Math.ceil( possibleRange.upper ).toFixed( 1 )\n\t\t\t} );\n\t\t}\n\n\t\tthis._form!.labeledInput.fieldView.select();\n\t\tthis._form!.enableCssTransitions();\n\t}\n\n\t/**\n\t * Removes the {@link #_form} from the {@link #_balloon}.\n\t *\n\t * @param focusEditable Controls whether the editing view is focused afterwards.\n\t */\n\tprivate _hideForm( focusEditable: boolean = false ): void {\n\t\tif ( !this._isInBalloon ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Blur the input element before removing it from DOM to prevent issues in some browsers.\n\t\t// See https://github.com/ckeditor/ckeditor5/issues/1501.\n\t\tif ( this._form!.focusTracker.isFocused ) {\n\t\t\tthis._form!.saveButtonView.focus();\n\t\t}\n\n\t\tthis._balloon!.remove( this._form! );\n\n\t\tif ( focusEditable ) {\n\t\t\tthis.editor.editing.view.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` when the {@link #_form} is the visible view in the {@link #_balloon}.\n\t */\n\tprivate get _isVisible(): boolean {\n\t\treturn !!this._balloon && this._balloon.visibleView === this._form;\n\t}\n\n\t/**\n\t * Returns `true` when the {@link #_form} is in the {@link #_balloon}.\n\t */\n\tprivate get _isInBalloon(): boolean {\n\t\treturn !!this._balloon && this._balloon.hasView( this._form! );\n\t}\n}\n\n/**\n * Returns image resize form validation callbacks.\n *\n * @param editor Editor instance.\n */\nfunction getFormValidators( editor: Editor ): Array<ImageCustomResizeFormValidatorCallback> {\n\tconst t = editor.t;\n\n\treturn [\n\t\tform => {\n\t\t\tif ( form.rawSize!.trim() === '' ) {\n\t\t\t\treturn t( 'The value must not be empty.' );\n\t\t\t}\n\n\t\t\tif ( form.parsedSize === null ) {\n\t\t\t\treturn t( 'The value should be a plain number.' );\n\t\t\t}\n\t\t}\n\t];\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imageresize\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageResizeButtons } from './imageresize/imageresizebuttons.js';\nimport { ImageResizeEditing } from './imageresize/imageresizeediting.js';\nimport { ImageResizeHandles } from './imageresize/imageresizehandles.js';\nimport { ImageCustomResizeUI } from './imageresize/imagecustomresizeui.js';\n\nimport '../theme/imageresize.css';\n\n/**\n * The image resize plugin.\n *\n * It adds a possibility to resize each image using handles.\n */\nexport class ImageResize extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageResizeEditing, ImageResizeHandles, ImageCustomResizeUI, ImageResizeButtons ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageResize' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagestyle/imagestylecommand\n */\n\nimport type { ModelElement } from 'ckeditor5/src/engine.js';\nimport { Command, type Editor } from 'ckeditor5/src/core.js';\nimport type { ImageStyleOptionDefinition } from '../imageconfig.js';\nimport { type ImageUtils } from '../imageutils.js';\n\n/**\n * The image style command. It is used to apply {@link module:image/imageconfig~ImageStyleConfig#options image style option}\n * to a selected image.\n *\n * **Note**: Executing this command may change the image model element if the desired style requires an image of a different\n * type. See {@link module:image/imagestyle/imagestylecommand~ImageStyleCommand#execute} to learn more.\n */\nexport class ImageStyleCommand extends Command {\n\t/**\n\t * An object containing names of default style options for the inline and block images.\n\t * If there is no default style option for the given image type in the configuration,\n\t * the name will be `false`.\n\t */\n\tprivate _defaultStyles: Record<string, string | false>;\n\n\t/**\n\t * The styles handled by this command.\n\t */\n\tprivate _styles: Map<string, ImageStyleOptionDefinition>;\n\n\t/**\n\t * Creates an instance of the image style command. When executed, the command applies one of\n\t * {@link module:image/imageconfig~ImageStyleConfig#options style options} to the currently selected image.\n\t *\n\t * @param editor The editor instance.\n\t * @param styles The style options that this command supports.\n\t */\n\tconstructor( editor: Editor, styles: Array<ImageStyleOptionDefinition> ) {\n\t\tsuper( editor );\n\n\t\tthis._defaultStyles = {\n\t\t\timageBlock: false,\n\t\t\timageInline: false\n\t\t};\n\n\t\tthis._styles = new Map( styles.map( style => {\n\t\t\tif ( style.isDefault ) {\n\t\t\t\tfor ( const modelElementName of style.modelElements ) {\n\t\t\t\t\tthis._defaultStyles[ modelElementName ] = style.name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn [ style.name, style ];\n\t\t} ) );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override refresh(): void {\n\t\tconst editor = this.editor;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\t\tconst element = imageUtils.getClosestSelectedImageElement( this.editor.model.document.selection )!;\n\n\t\tthis.isEnabled = !!element;\n\n\t\tif ( !this.isEnabled ) {\n\t\t\tthis.value = false;\n\t\t} else if ( element.hasAttribute( 'imageStyle' ) ) {\n\t\t\tthis.value = element.getAttribute( 'imageStyle' );\n\t\t} else {\n\t\t\tthis.value = this._defaultStyles[ element.name ];\n\t\t}\n\t}\n\n\t/**\n\t * Executes the command and applies the style to the currently selected image:\n\t *\n\t * ```ts\n\t * editor.execute( 'imageStyle', { value: 'side' } );\n\t * ```\n\t *\n\t * **Note**: Executing this command may change the image model element if the desired style requires an image\n\t * of a different type. Learn more about {@link module:image/imageconfig~ImageStyleOptionDefinition#modelElements model element}\n\t * configuration for the style option.\n\t *\n\t * @param options.value The name of the style (as configured in {@link module:image/imageconfig~ImageStyleConfig#options}).\n\t * @param options.setImageSizes Specifies whether the image `width` and `height` attributes should be set automatically.\n\t * The default is `true`.\n\t * @fires execute\n\t */\n\tpublic override execute( options: { value?: string; setImageSizes?: boolean } = {} ): void {\n\t\tconst editor = this.editor;\n\t\tconst model = editor.model;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tmodel.change( writer => {\n\t\t\tconst requestedStyle = options.value;\n\t\t\tconst { setImageSizes = true } = options;\n\n\t\t\tlet imageElement = imageUtils.getClosestSelectedImageElement( model.document.selection )!;\n\n\t\t\t// Change the image type if a style requires it.\n\t\t\tif ( requestedStyle && this.shouldConvertImageType( requestedStyle, imageElement ) ) {\n\t\t\t\tthis.editor.execute( imageUtils.isBlockImage( imageElement ) ? 'imageTypeInline' : 'imageTypeBlock', { setImageSizes } );\n\n\t\t\t\t// Update the imageElement to the newly created image.\n\t\t\t\timageElement = imageUtils.getClosestSelectedImageElement( model.document.selection )!;\n\t\t\t}\n\n\t\t\t// Default style means that there is no `imageStyle` attribute in the model.\n\t\t\t// https://github.com/ckeditor/ckeditor5-image/issues/147\n\t\t\tif ( !requestedStyle || this._styles.get( requestedStyle )!.isDefault ) {\n\t\t\t\twriter.removeAttribute( 'imageStyle', imageElement );\n\t\t\t} else {\n\t\t\t\twriter.setAttribute( 'imageStyle', requestedStyle, imageElement );\n\t\t\t}\n\n\t\t\tif ( setImageSizes ) {\n\t\t\t\timageUtils.setImageNaturalSizeAttributes( imageElement );\n\t\t\t}\n\t\t} );\n\t}\n\n\t/**\n\t * Returns `true` if requested style change would trigger the image type change.\n\t *\n\t * @param requestedStyle The name of the style (as configured in {@link module:image/imageconfig~ImageStyleConfig#options}).\n\t * @param imageElement The image model element.\n\t */\n\tpublic shouldConvertImageType( requestedStyle: string, imageElement: ModelElement ): boolean {\n\t\tconst supportedTypes = this._styles.get( requestedStyle )!.modelElements;\n\n\t\treturn !supportedTypes.includes( imageElement.name );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagestyle/utils\n */\n\nimport { logWarning } from 'ckeditor5/src/utils.js';\nimport {\n\tIconObjectCenter,\n\tIconObjectFullWidth,\n\tIconObjectInline,\n\tIconObjectInlineLeft,\n\tIconObjectInlineRight,\n\tIconObjectLeft,\n\tIconObjectRight\n} from 'ckeditor5/src/icons.js';\nimport type { Editor, PluginCollection } from 'ckeditor5/src/core.js';\nimport type { ImageStyleConfig, ImageStyleDropdownDefinition, ImageStyleOptionDefinition } from '../imageconfig.js';\n\n/**\n * Default image style options provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#styles}\n * configuration.\n *\n * There are available 5 styles focused on formatting:\n *\n * * **`'alignLeft'`** aligns the inline or block image to the left and wraps it with the text using the `image-style-align-left` class,\n * * **`'alignRight'`** aligns the inline or block image to the right and wraps it with the text using the `image-style-align-right` class,\n * * **`'alignCenter'`** centers the block image using the `image-style-align-center` class,\n * * **`'alignBlockLeft'`** aligns the block image to the left using the `image-style-block-align-left` class,\n * * **`'alignBlockRight'`** aligns the block image to the right using the `image-style-block-align-right` class,\n *\n * and 3 semantic styles:\n *\n * * **`'inline'`** is an inline image without any CSS class,\n * * **`'block'`** is a block image without any CSS class,\n * * **`'side'`** is a block image styled with the `image-style-side` CSS class.\n *\n * @internal\n */\nexport const DEFAULT_OPTIONS: Record<string, ImageStyleOptionDefinition> = {\n\t// This style represents an image placed in the line of text.\n\tget inline() {\n\t\treturn {\n\t\t\tname: 'inline',\n\t\t\ttitle: 'In line',\n\t\t\ticon: IconObjectInline,\n\t\t\tmodelElements: [ 'imageInline' ],\n\t\t\tisDefault: true\n\t\t};\n\t},\n\n\t// This style represents an image aligned to the left and wrapped with text.\n\tget alignLeft() {\n\t\treturn {\n\t\t\tname: 'alignLeft',\n\t\t\ttitle: 'Left aligned image',\n\t\t\ticon: IconObjectInlineLeft,\n\t\t\tmodelElements: [ 'imageBlock', 'imageInline' ],\n\t\t\tclassName: 'image-style-align-left'\n\t\t};\n\t},\n\n\t// This style represents an image aligned to the left.\n\tget alignBlockLeft() {\n\t\treturn {\n\t\t\tname: 'alignBlockLeft',\n\t\t\ttitle: 'Left aligned image',\n\t\t\ticon: IconObjectLeft,\n\t\t\tmodelElements: [ 'imageBlock' ],\n\t\t\tclassName: 'image-style-block-align-left'\n\t\t};\n\t},\n\n\t// This style represents a centered image.\n\tget alignCenter() {\n\t\treturn {\n\t\t\tname: 'alignCenter',\n\t\t\ttitle: 'Centered image',\n\t\t\ticon: IconObjectCenter,\n\t\t\tmodelElements: [ 'imageBlock' ],\n\t\t\tclassName: 'image-style-align-center'\n\t\t};\n\t},\n\n\t// This style represents an image aligned to the right and wrapped with text.\n\tget alignRight() {\n\t\treturn {\n\t\t\tname: 'alignRight',\n\t\t\ttitle: 'Right aligned image',\n\t\t\ticon: IconObjectInlineRight,\n\t\t\tmodelElements: [ 'imageBlock', 'imageInline' ],\n\t\t\tclassName: 'image-style-align-right'\n\t\t};\n\t},\n\n\t// This style represents an image aligned to the right.\n\tget alignBlockRight() {\n\t\treturn {\n\t\t\tname: 'alignBlockRight',\n\t\t\ttitle: 'Right aligned image',\n\t\t\ticon: IconObjectRight,\n\t\t\tmodelElements: [ 'imageBlock' ],\n\t\t\tclassName: 'image-style-block-align-right'\n\t\t};\n\t},\n\n\t// This option is equal to the situation when no style is applied.\n\tget block() {\n\t\treturn {\n\t\t\tname: 'block',\n\t\t\ttitle: 'Centered image',\n\t\t\ticon: IconObjectCenter,\n\t\t\tmodelElements: [ 'imageBlock' ],\n\t\t\tisDefault: true\n\t\t};\n\t},\n\n\t// This represents a side image.\n\tget side() {\n\t\treturn {\n\t\t\tname: 'side',\n\t\t\ttitle: 'Side image',\n\t\t\ticon: IconObjectInlineRight,\n\t\t\tmodelElements: [ 'imageBlock' ],\n\t\t\tclassName: 'image-style-side'\n\t\t};\n\t}\n};\n\n/**\n * Default image style icons provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#styles}\n * configuration.\n *\n * See {@link module:image/imageconfig~ImageStyleOptionDefinition#icon} to learn more.\n *\n * There are 7 default icons available: `'full'`, `'left'`, `'inlineLeft'`, `'center'`, `'right'`, `'inlineRight'`, and `'inline'`.\n *\n * @internal\n */\nexport const DEFAULT_ICONS: Record<string, string> = /* #__PURE__ */ ( () => ( {\n\tfull: IconObjectFullWidth,\n\tleft: IconObjectLeft,\n\tright: IconObjectRight,\n\tcenter: IconObjectCenter,\n\tinlineLeft: IconObjectInlineLeft,\n\tinlineRight: IconObjectInlineRight,\n\tinline: IconObjectInline\n} ) )();\n\n/**\n * Default drop-downs provided by the plugin that can be referred in the {@link module:image/imageconfig~ImageConfig#toolbar}\n * configuration. The drop-downs are containers for the {@link module:image/imageconfig~ImageStyleConfig#options image style options}.\n *\n * If both of the `ImageEditing` plugins are loaded, there are 2 predefined drop-downs available:\n *\n * * **`'imageStyle:wrapText'`**, which contains the `alignLeft` and `alignRight` options, that is,\n * those that wraps the text around the image,\n * * **`'imageStyle:breakText'`**, which contains the `alignBlockLeft`, `alignCenter` and `alignBlockRight` options, that is,\n * those that breaks the text around the image.\n *\n * @internal\n */\nexport const DEFAULT_DROPDOWN_DEFINITIONS: Array<ImageStyleDropdownDefinition> = [ {\n\tname: 'imageStyle:wrapText',\n\ttitle: 'Wrap text',\n\tdefaultItem: 'imageStyle:alignLeft',\n\titems: [ 'imageStyle:alignLeft', 'imageStyle:alignRight' ]\n}, {\n\tname: 'imageStyle:breakText',\n\ttitle: 'Break text',\n\tdefaultItem: 'imageStyle:block',\n\titems: [ 'imageStyle:alignBlockLeft', 'imageStyle:block', 'imageStyle:alignBlockRight' ]\n} ];\n\n/**\n * Returns a list of the normalized and validated image style options.\n *\n * @param config\n * @param config.isInlinePluginLoaded\n * Determines whether the {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugin has been loaded.\n * @param config.isBlockPluginLoaded\n * Determines whether the {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} plugin has been loaded.\n * @param config.configuredStyles\n * The image styles configuration provided in the image styles {@link module:image/imageconfig~ImageConfig#styles configuration}\n * as a default or custom value.\n * @returns\n * * Each of options contains a complete icon markup.\n * * The image style options not supported by any of the loaded plugins are filtered out.\n */\nfunction normalizeStyles( config: {\n\tisInlinePluginLoaded: boolean;\n\tisBlockPluginLoaded: boolean;\n\tconfiguredStyles: ImageStyleConfig;\n}\n): Array<ImageStyleOptionDefinition> {\n\tconst configuredStyles = config.configuredStyles.options || [];\n\n\tconst styles = configuredStyles\n\t\t.map( arrangement => normalizeDefinition( arrangement ) )\n\t\t.filter( arrangement => isValidOption( arrangement, config ) );\n\n\treturn styles;\n}\n\n/**\n * Returns the default image styles configuration depending on the loaded image editing plugins.\n *\n * @param isInlinePluginLoaded\n * Determines whether the {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugin has been loaded.\n *\n * @param isBlockPluginLoaded\n * Determines whether the {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} plugin has been loaded.\n *\n * @returns\n * It returns an object with the lists of the image style options and groups defined as strings related to the\n * {@link module:image/imagestyle/utils#DEFAULT_OPTIONS default options}\n */\nfunction getDefaultStylesConfiguration( isBlockPluginLoaded: boolean, isInlinePluginLoaded: boolean ): ImageStyleConfig {\n\tif ( isBlockPluginLoaded && isInlinePluginLoaded ) {\n\t\treturn {\n\t\t\toptions: [\n\t\t\t\t'inline', 'alignLeft', 'alignRight',\n\t\t\t\t'alignCenter', 'alignBlockLeft', 'alignBlockRight',\n\t\t\t\t'block', 'side'\n\t\t\t]\n\t\t};\n\t} else if ( isBlockPluginLoaded ) {\n\t\treturn {\n\t\t\toptions: [ 'block', 'side' ]\n\t\t};\n\t} else if ( isInlinePluginLoaded ) {\n\t\treturn {\n\t\t\toptions: [ 'inline', 'alignLeft', 'alignRight' ]\n\t\t};\n\t}\n\n\treturn {};\n}\n\n/**\n * Returns a list of the available predefined drop-downs' definitions depending on the loaded image editing plugins.\n */\nfunction getDefaultDropdownDefinitions( pluginCollection: PluginCollection<Editor> ): Array<ImageStyleDropdownDefinition> {\n\tif ( pluginCollection.has( 'ImageBlockEditing' ) && pluginCollection.has( 'ImageInlineEditing' ) ) {\n\t\treturn [ ...DEFAULT_DROPDOWN_DEFINITIONS ];\n\t} else {\n\t\treturn [];\n\t}\n}\n\n/**\n * Normalizes an image style option or group provided in the {@link module:image/imageconfig~ImageConfig#styles}\n * and returns it in a {@link module:image/imageconfig~ImageStyleOptionDefinition}/\n */\nfunction normalizeDefinition( definition: string | Partial<ImageStyleOptionDefinition> & { name: string } ): ImageStyleOptionDefinition {\n\tif ( typeof definition === 'string' ) {\n\t\t// Just the name of the style has been passed, but none of the defaults.\n\t\tif ( !DEFAULT_OPTIONS[ definition ] ) {\n\t\t\t// Normalize the style anyway to prevent errors.\n\t\t\tdefinition = { name: definition };\n\t\t}\n\t\t// Just the name of the style has been passed and it's one of the defaults, just use it.\n\t\t// Clone the style to avoid overriding defaults.\n\t\telse {\n\t\t\tdefinition = { ...DEFAULT_OPTIONS[ definition ] };\n\t\t}\n\t} else {\n\t\t// If an object style has been passed and if the name matches one of the defaults,\n\t\t// extend it with defaults – the user wants to customize a default style.\n\t\t// Note: Don't override the user–defined style object, clone it instead.\n\t\tdefinition = extendStyle( DEFAULT_OPTIONS[ definition.name ], definition );\n\t}\n\n\t// If an icon is defined as a string and correspond with a name\n\t// in default icons, use the default icon provided by the plugin.\n\tif ( typeof definition.icon === 'string' ) {\n\t\tdefinition.icon = DEFAULT_ICONS[ definition.icon ] || definition.icon;\n\t}\n\n\treturn definition as ImageStyleOptionDefinition;\n}\n\n/**\n * Checks if the image style option is valid:\n * * if it has the modelElements fields defined and filled,\n * * if the defined modelElements are supported by any of the loaded image editing plugins.\n * It also displays a console warning these conditions are not met.\n *\n * @param option image style option\n */\nfunction isValidOption(\n\toption: ImageStyleOptionDefinition,\n\t{ isBlockPluginLoaded, isInlinePluginLoaded }: { isBlockPluginLoaded: boolean; isInlinePluginLoaded: boolean }\n): boolean {\n\tconst { modelElements, name } = option;\n\n\tif ( !modelElements || !modelElements.length || !name ) {\n\t\twarnInvalidStyle( { style: option } );\n\n\t\treturn false;\n\t} else {\n\t\tconst supportedElements = [ isBlockPluginLoaded ? 'imageBlock' : null, isInlinePluginLoaded ? 'imageInline' : null ];\n\n\t\t// Check if the option is supported by any of the loaded plugins.\n\t\tif ( !modelElements.some( elementName => supportedElements.includes( elementName ) ) ) {\n\t\t\t/**\n\t\t\t * In order to work correctly, each image style {@link module:image/imageconfig~ImageStyleOptionDefinition option}\n\t\t\t * requires specific model elements (also: types of images) to be supported by the editor.\n\t\t\t *\n\t\t\t * Model element names to which the image style option can be applied are defined in the\n\t\t\t * {@link module:image/imageconfig~ImageStyleOptionDefinition#modelElements} property of the style option\n\t\t\t * definition.\n\t\t\t *\n\t\t\t * Explore the warning in the console to find out precisely which option is not supported and which editor plugins\n\t\t\t * are missing. Make sure these plugins are loaded in your editor to get this image style option working.\n\t\t\t *\n\t\t\t * @error image-style-missing-dependency\n\t\t\t * @param {string} style The name of the unsupported option.\n\t\t\t * @param {Array.<string>} missingPlugins The names of the plugins one of which has to be loaded for the particular option.\n\t\t\t */\n\t\t\tlogWarning( 'image-style-missing-dependency', {\n\t\t\t\tstyle: option,\n\t\t\t\tmissingPlugins: modelElements.map( name => name === 'imageBlock' ? 'ImageBlockEditing' : 'ImageInlineEditing' )\n\t\t\t} );\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\n/**\n * Extends the default style with a style provided by the developer.\n * Note: Don't override the custom–defined style object, clone it instead.\n */\nfunction extendStyle( source: ImageStyleOptionDefinition, style: Partial<ImageStyleOptionDefinition> ): ImageStyleOptionDefinition {\n\tconst extendedStyle: Record<string, any> = { ...style };\n\n\tfor ( const prop in source ) {\n\t\tif ( !Object.prototype.hasOwnProperty.call( style, prop ) ) {\n\t\t\textendedStyle[ prop ] = source[ prop as keyof typeof source ];\n\t\t}\n\t}\n\n\treturn extendedStyle as ImageStyleOptionDefinition;\n}\n\n/**\n * Displays a console warning with the 'image-style-configuration-definition-invalid' error.\n */\nfunction warnInvalidStyle( info: object ): void {\n\t/**\n\t * The image style definition provided in the configuration is invalid.\n\t *\n\t * Please make sure the definition implements properly one of the following:\n\t *\n\t * * {@link module:image/imageconfig~ImageStyleOptionDefinition image style option definition},\n\t * * {@link module:image/imageconfig~ImageStyleDropdownDefinition image style dropdown definition}\n\t *\n\t * @error image-style-configuration-definition-invalid\n\t * @param {object} info The information about the invalid definition.\n\t */\n\tlogWarning( 'image-style-configuration-definition-invalid', info );\n}\n\n/**\n * @internal\n */\nexport const utils = {\n\tnormalizeStyles,\n\tgetDefaultStylesConfiguration,\n\tgetDefaultDropdownDefinitions,\n\twarnInvalidStyle\n};\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\nimport type { DowncastAttributeEvent, ModelElement, UpcastElementEvent } from 'ckeditor5/src/engine.js';\nimport { first, type GetCallback } from 'ckeditor5/src/utils.js';\nimport type { ImageStyleOptionDefinition } from '../imageconfig.js';\n\n/**\n * @module image/imagestyle/converters\n */\n\n/**\n * Returns a converter for the `imageStyle` attribute. It can be used for adding, changing and removing the attribute.\n *\n * @param styles An array containing available image style options.\n * @returns A model-to-view attribute converter.\n * @internal\n */\nexport function modelToViewStyleAttribute( styles: Array<ImageStyleOptionDefinition> ): GetCallback<DowncastAttributeEvent> {\n\treturn ( evt, data, conversionApi ) => {\n\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Check if there is class name associated with given value.\n\t\tconst newStyle = getStyleDefinitionByName( data.attributeNewValue as string, styles );\n\t\tconst oldStyle = getStyleDefinitionByName( data.attributeOldValue as string, styles );\n\n\t\tconst viewElement = conversionApi.mapper.toViewElement( data.item as ModelElement )!;\n\t\tconst viewWriter = conversionApi.writer;\n\n\t\tif ( oldStyle ) {\n\t\t\tviewWriter.removeClass( oldStyle.className!, viewElement );\n\t\t}\n\n\t\tif ( newStyle ) {\n\t\t\tviewWriter.addClass( newStyle.className!, viewElement );\n\t\t}\n\t};\n}\n\n/**\n * Returns a view-to-model converter converting image CSS classes to a proper value in the model.\n *\n * @param styles Image style options for which the converter is created.\n * @returns A view-to-model converter.\n * @internal\n */\nexport function viewToModelStyleAttribute( styles: Array<ImageStyleOptionDefinition> ): GetCallback<UpcastElementEvent> {\n\t// Convert only non–default styles.\n\tconst nonDefaultStyles: Record<string, Array<ImageStyleOptionDefinition>> = {\n\t\timageInline: styles.filter( style => !style.isDefault && style.modelElements.includes( 'imageInline' ) ),\n\t\timageBlock: styles.filter( style => !style.isDefault && style.modelElements.includes( 'imageBlock' ) )\n\t};\n\n\treturn ( evt, data, conversionApi ) => {\n\t\tif ( !data.modelRange ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst viewElement = data.viewItem;\n\t\tconst modelImageElement = first( data.modelRange.getItems() );\n\n\t\t// Run this converter only if an image has been found in the model.\n\t\t// In some cases it may not be found (for example if we run this on a figure with different type than image).\n\t\tif ( !modelImageElement ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// ...and the `imageStyle` attribute is allowed for that element, otherwise stop conversion early.\n\t\tif ( !conversionApi.schema.checkAttribute( modelImageElement, 'imageStyle' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Convert styles one by one.\n\t\tfor ( const style of nonDefaultStyles[ ( modelImageElement as ModelElement ).name ] ) {\n\t\t\t// Try to consume class corresponding with the style.\n\t\t\tif ( conversionApi.consumable.consume( viewElement, { classes: style.className } ) ) {\n\t\t\t\t// And convert this style to model attribute.\n\t\t\t\tconversionApi.writer.setAttribute( 'imageStyle', style.name, modelImageElement );\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * Returns the style with a given `name` from an array of styles.\n */\nfunction getStyleDefinitionByName( name: string, styles: Array<ImageStyleOptionDefinition> ): ImageStyleOptionDefinition | undefined {\n\tfor ( const style of styles ) {\n\t\tif ( style.name === name ) {\n\t\t\treturn style;\n\t\t}\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagestyle/imagestyleediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport type { ModelElement, UpcastElementEvent } from 'ckeditor5/src/engine.js';\n\nimport { ImageStyleCommand } from './imagestylecommand.js';\nimport { ImageUtils } from '../imageutils.js';\nimport { utils } from './utils.js';\nimport { viewToModelStyleAttribute, modelToViewStyleAttribute } from './converters.js';\nimport type { ImageStyleOptionDefinition } from '../imageconfig.js';\n\n/**\n * The image style engine plugin. It sets the default configuration, creates converters and registers\n * {@link module:image/imagestyle/imagestylecommand~ImageStyleCommand ImageStyleCommand}.\n */\nexport class ImageStyleEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageStyleEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageUtils ] as const;\n\t}\n\n\t/**\n\t * It contains a list of the normalized and validated style options.\n\t *\n\t * * Each option contains a complete icon markup.\n\t * * The style options not supported by any of the loaded image editing plugins (\n\t * {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`} or\n\t * {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`}) are filtered out.\n\t *\n\t * @internal\n\t * @readonly\n\t */\n\tpublic normalizedStyles?: Array<ImageStyleOptionDefinition>;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst editor = this.editor;\n\t\tconst isBlockPluginLoaded = editor.plugins.has( 'ImageBlockEditing' );\n\t\tconst isInlinePluginLoaded = editor.plugins.has( 'ImageInlineEditing' );\n\n\t\teditor.config.define( 'image.styles', utils.getDefaultStylesConfiguration( isBlockPluginLoaded, isInlinePluginLoaded ) );\n\n\t\tthis.normalizedStyles = utils.normalizeStyles( {\n\t\t\tconfiguredStyles: editor.config.get( 'image.styles' )!,\n\t\t\tisBlockPluginLoaded,\n\t\t\tisInlinePluginLoaded\n\t\t} );\n\n\t\tthis._setupConversion( isBlockPluginLoaded, isInlinePluginLoaded );\n\t\tthis._setupPostFixer();\n\n\t\t// Register imageStyle command.\n\t\teditor.commands.add( 'imageStyle', new ImageStyleCommand( editor, this.normalizedStyles ) );\n\t}\n\n\t/**\n\t * Sets the editor conversion taking the presence of\n\t * {@link module:image/image/imageinlineediting~ImageInlineEditing `ImageInlineEditing`}\n\t * and {@link module:image/image/imageblockediting~ImageBlockEditing `ImageBlockEditing`} plugins into consideration.\n\t */\n\tprivate _setupConversion( isBlockPluginLoaded: boolean, isInlinePluginLoaded: boolean ): void {\n\t\tconst editor = this.editor;\n\t\tconst schema = editor.model.schema;\n\n\t\tconst modelToViewConverter = modelToViewStyleAttribute( this.normalizedStyles! );\n\t\tconst viewToModelConverter = viewToModelStyleAttribute( this.normalizedStyles! );\n\n\t\teditor.editing.downcastDispatcher.on( 'attribute:imageStyle', modelToViewConverter );\n\t\teditor.data.downcastDispatcher.on( 'attribute:imageStyle', modelToViewConverter );\n\n\t\t// Allow imageStyle attribute in image and imageInline.\n\t\t// We could call it 'style' but https://github.com/ckeditor/ckeditor5-engine/issues/559.\n\t\tif ( isBlockPluginLoaded ) {\n\t\t\tschema.extend( 'imageBlock', { allowAttributes: 'imageStyle' } );\n\t\t\tschema.setAttributeProperties( 'imageStyle', { isFormatting: true } );\n\n\t\t\t// Converter for figure element from view to model.\n\t\t\teditor.data.upcastDispatcher.on<UpcastElementEvent>( 'element:figure', viewToModelConverter, { priority: 'low' } );\n\t\t}\n\n\t\tif ( isInlinePluginLoaded ) {\n\t\t\tschema.extend( 'imageInline', { allowAttributes: 'imageStyle' } );\n\t\t\tschema.setAttributeProperties( 'imageStyle', { isFormatting: true } );\n\n\t\t\t// Converter for the img element from view to model.\n\t\t\teditor.data.upcastDispatcher.on( 'element:img', viewToModelConverter, { priority: 'low' } );\n\t\t}\n\t}\n\n\t/**\n\t * Registers a post-fixer that will make sure that the style attribute value is correct for a specific image type (block vs inline).\n\t */\n\tprivate _setupPostFixer(): void {\n\t\tconst editor = this.editor;\n\t\tconst document = editor.model.document;\n\n\t\tconst imageUtils = editor.plugins.get( ImageUtils );\n\t\tconst stylesMap = new Map( this.normalizedStyles!.map( style => [ style.name, style ] ) );\n\n\t\t// Make sure that style attribute is valid for the image type.\n\t\tdocument.registerPostFixer( writer => {\n\t\t\tlet changed = false;\n\n\t\t\tfor ( const change of document.differ.getChanges() ) {\n\t\t\t\tif ( change.type == 'insert' || change.type == 'attribute' && change.attributeKey == 'imageStyle' ) {\n\t\t\t\t\tlet element = change.type == 'insert' ? change.position.nodeAfter! : change.range.start.nodeAfter!;\n\n\t\t\t\t\tif ( element && element.is( 'element', 'paragraph' ) && element.childCount > 0 ) {\n\t\t\t\t\t\telement = element.getChild( 0 )!;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !imageUtils.isImage( element as ModelElement ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst imageStyle = element.getAttribute( 'imageStyle' ) as string | undefined;\n\n\t\t\t\t\tif ( !imageStyle ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst imageStyleDefinition = stylesMap.get( imageStyle );\n\n\t\t\t\t\tif ( !imageStyleDefinition || !imageStyleDefinition.modelElements.includes( ( element as ModelElement ).name ) ) {\n\t\t\t\t\t\twriter.removeAttribute( 'imageStyle', element );\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn changed;\n\t\t} );\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagestyle/imagestyleui\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ButtonView, createDropdown, addToolbarToDropdown, SplitButtonView } from 'ckeditor5/src/ui.js';\nimport { isObject, identity } from 'es-toolkit/compat';\nimport { ImageStyleEditing } from './imagestyleediting.js';\nimport { utils } from './utils.js';\nimport type { ImageStyleDropdownDefinition, ImageStyleOptionDefinition } from '../imageconfig.js';\nimport { type ImageStyleCommand } from './imagestylecommand.js';\n\nimport '../../theme/imagestyle.css';\n\n/**\n * The image style UI plugin.\n *\n * It registers buttons corresponding to the {@link module:image/imageconfig~ImageConfig#styles} configuration.\n * It also registers the {@link module:image/imagestyle/utils#DEFAULT_DROPDOWN_DEFINITIONS default drop-downs} and the\n * custom drop-downs defined by the developer in the {@link module:image/imageconfig~ImageConfig#toolbar} configuration.\n */\nexport class ImageStyleUI extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageStyleEditing ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageStyleUI' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns the default localized style titles provided by the plugin.\n\t *\n\t * The following localized titles corresponding with\n\t * {@link module:image/imagestyle/utils#DEFAULT_OPTIONS} are available:\n\t *\n\t * * `'Wrap text'`,\n\t * * `'Break text'`,\n\t * * `'In line'`,\n\t * * `'Full size image'`,\n\t * * `'Side image'`,\n\t * * `'Left aligned image'`,\n\t * * `'Centered image'`,\n\t * * `'Right aligned image'`\n\t */\n\tpublic get localizedDefaultStylesTitles(): Record<string, string> {\n\t\tconst t = this.editor.t;\n\n\t\treturn {\n\t\t\t'Wrap text': t( 'Wrap text' ),\n\t\t\t'Break text': t( 'Break text' ),\n\t\t\t'In line': t( 'In line' ),\n\t\t\t'Full size image': t( 'Full size image' ),\n\t\t\t'Side image': t( 'Side image' ),\n\t\t\t'Left aligned image': t( 'Left aligned image' ),\n\t\t\t'Centered image': t( 'Centered image' ),\n\t\t\t'Right aligned image': t( 'Right aligned image' )\n\t\t};\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic init(): void {\n\t\tconst plugins = this.editor.plugins;\n\t\tconst toolbarConfig = this.editor.config.get( 'image.toolbar' ) || [];\n\t\tconst imageStyleEditing: ImageStyleEditing = plugins.get( 'ImageStyleEditing' );\n\n\t\tconst definedStyles = translateStyles(\n\t\t\timageStyleEditing.normalizedStyles!,\n\t\t\tthis.localizedDefaultStylesTitles\n\t\t);\n\n\t\tfor ( const styleConfig of definedStyles ) {\n\t\t\tthis._createButton( styleConfig );\n\t\t}\n\n\t\tconst definedDropdowns = translateStyles(\n\t\t\t[\n\t\t\t\t...toolbarConfig.filter( isObject ) as Array<ImageStyleDropdownDefinition>,\n\t\t\t\t...utils.getDefaultDropdownDefinitions( plugins )\n\t\t\t],\n\t\t\tthis.localizedDefaultStylesTitles\n\t\t);\n\n\t\tfor ( const dropdownConfig of definedDropdowns ) {\n\t\t\tthis._createDropdown( dropdownConfig, definedStyles );\n\t\t}\n\t}\n\n\t/**\n\t * Creates a dropdown and stores it in the editor {@link module:ui/componentfactory~ComponentFactory}.\n\t */\n\tprivate _createDropdown( dropdownConfig: ImageStyleDropdownDefinition, definedStyles: Array<ImageStyleOptionDefinition> ): void {\n\t\tconst factory = this.editor.ui.componentFactory;\n\n\t\tfactory.add( dropdownConfig.name, locale => {\n\t\t\tlet defaultButton: ButtonView | undefined;\n\n\t\t\tconst { defaultItem, items, title } = dropdownConfig;\n\t\t\tconst buttonViews = items\n\t\t\t\t.filter( itemName => definedStyles.find( ( { name } ) => getUIComponentName( name ) === itemName ) )\n\t\t\t\t.map( buttonName => {\n\t\t\t\t\tconst button = factory.create( buttonName ) as ButtonView;\n\n\t\t\t\t\tif ( buttonName === defaultItem ) {\n\t\t\t\t\t\tdefaultButton = button;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn button;\n\t\t\t\t} );\n\n\t\t\tif ( items.length !== buttonViews.length ) {\n\t\t\t\tutils.warnInvalidStyle( { dropdown: dropdownConfig } );\n\t\t\t}\n\n\t\t\tconst dropdownView = createDropdown( locale, SplitButtonView );\n\t\t\tconst splitButtonView = dropdownView.buttonView as SplitButtonView;\n\t\t\tconst splitButtonViewArrow = splitButtonView.arrowView;\n\n\t\t\taddToolbarToDropdown( dropdownView, buttonViews, { enableActiveItemFocusOnDropdownOpen: true } );\n\n\t\t\tsplitButtonView.set( {\n\t\t\t\tlabel: getDropdownButtonTitle( title, defaultButton!.label! ),\n\t\t\t\tclass: null,\n\t\t\t\ttooltip: true\n\t\t\t} );\n\n\t\t\tsplitButtonViewArrow.unbind( 'label' );\n\t\t\tsplitButtonViewArrow.set( {\n\t\t\t\tlabel: title\n\t\t\t} );\n\n\t\t\tsplitButtonView.bind( 'icon' ).toMany( buttonViews, 'isOn', ( ...areOn ) => {\n\t\t\t\tconst index = areOn.findIndex( identity );\n\n\t\t\t\treturn ( index < 0 ) ? defaultButton!.icon : buttonViews[ index ].icon;\n\t\t\t} );\n\n\t\t\tsplitButtonView.bind( 'label' ).toMany( buttonViews, 'isOn', ( ...areOn ) => {\n\t\t\t\tconst index = areOn.findIndex( identity );\n\n\t\t\t\treturn getDropdownButtonTitle( title, ( index < 0 ) ? defaultButton!.label! : buttonViews[ index ].label! );\n\t\t\t} );\n\n\t\t\tsplitButtonView.bind( 'isOn' ).toMany( buttonViews, 'isOn', ( ...areOn ) => areOn.some( identity ) );\n\n\t\t\tsplitButtonView.bind( 'class' )\n\t\t\t\t.toMany( buttonViews, 'isOn', ( ...areOn ) => areOn.some( identity ) ? 'ck-splitbutton_flatten' : undefined );\n\n\t\t\tsplitButtonView.on( 'execute', () => {\n\t\t\t\tif ( !buttonViews.some( ( { isOn } ) => isOn ) ) {\n\t\t\t\t\tdefaultButton!.fire( 'execute' );\n\t\t\t\t} else {\n\t\t\t\t\tdropdownView.isOpen = !dropdownView.isOpen;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tdropdownView.bind( 'isEnabled' )\n\t\t\t\t.toMany( buttonViews, 'isEnabled', ( ...areEnabled ) => areEnabled.some( identity ) );\n\n\t\t\t// Focus the editable after executing the command.\n\t\t\t// Overrides a default behaviour where the focus is moved to the dropdown button (#12125).\n\t\t\tthis.listenTo( dropdownView, 'execute', () => {\n\t\t\t\tthis.editor.editing.view.focus();\n\t\t\t} );\n\n\t\t\treturn dropdownView;\n\t\t} );\n\t}\n\n\t/**\n\t * Creates a button and stores it in the editor {@link module:ui/componentfactory~ComponentFactory}.\n\t */\n\tprivate _createButton( buttonConfig: ImageStyleOptionDefinition ): void {\n\t\tconst buttonName = buttonConfig.name;\n\n\t\tthis.editor.ui.componentFactory.add( getUIComponentName( buttonName ), locale => {\n\t\t\tconst command: ImageStyleCommand = this.editor.commands.get( 'imageStyle' )!;\n\t\t\tconst view = new ButtonView( locale );\n\n\t\t\tview.set( {\n\t\t\t\tlabel: buttonConfig.title,\n\t\t\t\ticon: buttonConfig.icon,\n\t\t\t\ttooltip: true,\n\t\t\t\tisToggleable: true\n\t\t\t} );\n\n\t\t\tview.bind( 'isEnabled' ).to( command, 'isEnabled' );\n\t\t\tview.bind( 'isOn' ).to( command, 'value', value => value === buttonName );\n\t\t\tview.on( 'execute', this._executeCommand.bind( this, buttonName ) );\n\n\t\t\treturn view;\n\t\t} );\n\t}\n\n\tprivate _executeCommand( name: string ): void {\n\t\tthis.editor.execute( 'imageStyle', { value: name } );\n\t\tthis.editor.editing.view.focus();\n\t}\n}\n\n/**\n * Returns the translated `title` from the passed styles array.\n */\nfunction translateStyles<T extends ImageStyleOptionDefinition | ImageStyleDropdownDefinition>(\n\tstyles: Array<T>,\n\ttitles: Record<string, string>\n): Array<T> {\n\tfor ( const style of styles ) {\n\t\t// Localize the titles of the styles, if a title corresponds with\n\t\t// a localized default provided by the plugin.\n\t\tif ( titles[ style.title! ] ) {\n\t\t\tstyle.title = titles[ style.title! ];\n\t\t}\n\t}\n\n\treturn styles;\n}\n\n/**\n * Returns the image style component name with the \"imageStyle:\" prefix.\n */\nfunction getUIComponentName( name: string ): string {\n\treturn `imageStyle:${ name }`;\n}\n\n/**\n * Returns title for the splitbutton containing the dropdown title and default action item title.\n */\nfunction getDropdownButtonTitle( dropdownTitle: string | undefined, buttonTitle: string ): string {\n\treturn ( dropdownTitle ? dropdownTitle + ': ' : '' ) + buttonTitle;\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagestyle\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { ImageStyleEditing } from './imagestyle/imagestyleediting.js';\nimport { ImageStyleUI } from './imagestyle/imagestyleui.js';\n\n/**\n * The image style plugin.\n *\n * For a detailed overview of the image styles feature, check the {@glink features/images/images-styles documentation}.\n *\n * This is a \"glue\" plugin which loads the following plugins:\n * * {@link module:image/imagestyle/imagestyleediting~ImageStyleEditing},\n * * {@link module:image/imagestyle/imagestyleui~ImageStyleUI}\n *\n * It provides a default configuration, which can be extended or overwritten.\n * Read more about the {@link module:image/imageconfig~ImageConfig#styles image styles configuration}.\n */\nexport class ImageStyle extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageStyleEditing, ImageStyleUI ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageStyle' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/imagetoolbar\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\nimport { WidgetToolbarRepository } from 'ckeditor5/src/widget.js';\n\nimport { ImageUtils } from './imageutils.js';\nimport type { ImageStyleDropdownDefinition } from './imageconfig.js';\n\nimport { isObject } from 'es-toolkit/compat';\n\n/**\n * The image toolbar plugin. It creates and manages the image toolbar (the toolbar displayed when an image is selected).\n *\n * For an overview, check the {@glink features/images/images-overview#image-contextual-toolbar image contextual toolbar} documentation.\n *\n * Instances of toolbar components (e.g. buttons) are created using the editor's\n * {@link module:ui/componentfactory~ComponentFactory component factory}\n * based on the {@link module:image/imageconfig~ImageConfig#toolbar `image.toolbar` configuration option}.\n *\n * The toolbar uses the {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon}.\n */\nexport class ImageToolbar extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ WidgetToolbarRepository, ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'ImageToolbar' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tconst editor = this.editor;\n\t\tconst t = editor.t;\n\t\tconst widgetToolbarRepository = editor.plugins.get( WidgetToolbarRepository );\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\twidgetToolbarRepository.register( 'image', {\n\t\t\tariaLabel: t( 'Image toolbar' ),\n\t\t\titems: normalizeDeclarativeConfig( editor.config.get( 'image.toolbar' ) || [] ),\n\t\t\tgetRelatedElement: selection => imageUtils.getClosestSelectedImageWidget( selection )!\n\t\t} );\n\t}\n}\n\n/**\n * Convert the dropdown definitions to their keys registered in the ComponentFactory.\n * The registration precess should be handled by the plugin which handles the UI of a particular feature.\n */\nfunction normalizeDeclarativeConfig( config: Array<string | ImageStyleDropdownDefinition> ): Array<string> {\n\treturn config.map( item => isObject( item ) ? item.name : item );\n}\n","/**\n * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options\n */\n\n/**\n * @module image/pictureediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core.js';\n\nimport { ImageEditing } from './image/imageediting.js';\nimport { ImageUtils } from './imageutils.js';\nimport { downcastSourcesAttribute, upcastPicture } from './image/converters.js';\nimport type { ImageUploadEditing, ImageUploadCompleteEvent } from './imageupload/imageuploadediting.js';\n\n/**\n * This plugin enables the [`<picture>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture) element support in the editor.\n *\n * * It enables the `sources` model attribute on `imageBlock` and `imageInline` model elements\n * (brought by {@link module:image/imageblock~ImageBlock} and {@link module:image/imageinline~ImageInline}, respectively).\n * * It translates the `sources` model element to the view (also: data) structure that may look as follows:\n *\n * ```html\n * <p>Inline image using picture:\n * \t<picture>\n * \t\t<source media=\"(min-width: 800px)\" srcset=\"image-large.webp\" type=\"image/webp\">\n * \t\t<source media=\"(max-width: 800px)\" srcset=\"image-small.webp\" type=\"image/webp\">\n * \t\t<!-- Other sources as specified in the \"sources\" model attribute... -->\n * \t\t<img src=\"image.png\" alt=\"An image using picture\" />\n * \t</picture>\n * </p>\n *\n * <p>Block image using picture:</p>\n * <figure class=\"image\">\n * \t<picture>\n * \t\t<source media=\"(min-width: 800px)\" srcset=\"image-large.webp\" type=\"image/webp\">\n * \t\t<source media=\"(max-width: 800px)\" srcset=\"image-small.webp\" type=\"image/webp\">\n * \t\t<!-- Other sources as specified in the \"sources\" model attribute... -->\n * \t\t<img src=\"image.png\" alt=\"An image using picture\" />\n * \t</picture>\n * \t<figcaption>Caption of the image</figcaption>\n * </figure>\n * ```\n *\n * **Note:** The value of the `sources` {@glink framework/architecture/editing-engine#changing-the-model model attribute}\n * in both examples equals:\n *\n * ```css\n * [\n * \t{\n * \t\tmedia: '(min-width: 800px)',\n * \t\tsrcset: 'image-large.webp',\n * \t\ttype: 'image/webp'\n * \t},\n * \t{\n * \t\tmedia: '(max-width: 800px)',\n * \t\tsrcset: 'image-small.webp',\n * \t\ttype: 'image/webp'\n * \t}\n * ]\n * ```\n *\n * * It integrates with the {@link module:image/imageupload~ImageUpload} plugin so images uploaded in the editor\n * automatically render using `<picture>` if the {@glink features/images/image-upload/image-upload upload adapter}\n * supports image sources and provides neccessary data.\n *\n * @private\n */\nexport class PictureEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get requires() {\n\t\treturn [ ImageEditing, ImageUtils ] as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static get pluginName() {\n\t\treturn 'PictureEditing' as const;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static override get isOfficialPlugin(): true {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic afterInit(): void {\n\t\tconst editor = this.editor;\n\n\t\tif ( editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\teditor.model.schema.extend( 'imageBlock', {\n\t\t\t\tallowAttributes: [ 'sources' ]\n\t\t\t} );\n\t\t}\n\n\t\tif ( editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\teditor.model.schema.extend( 'imageInline', {\n\t\t\t\tallowAttributes: [ 'sources' ]\n\t\t\t} );\n\t\t}\n\n\t\tthis._setupConversion();\n\t\tthis._setupImageUploadEditingIntegration();\n\t}\n\n\t/**\n\t * Configures conversion pipelines to support upcasting and downcasting images using the `<picture>` view element\n\t * and the model `sources` attribute.\n\t */\n\tprivate _setupConversion(): void {\n\t\tconst editor = this.editor;\n\t\tconst conversion = editor.conversion;\n\t\tconst imageUtils: ImageUtils = editor.plugins.get( 'ImageUtils' );\n\n\t\tconversion.for( 'upcast' ).add( upcastPicture( imageUtils ) );\n\t\tconversion.for( 'downcast' ).add( downcastSourcesAttribute( imageUtils ) );\n\t}\n\n\t/**\n\t * Makes it possible for uploaded images to get the `sources` model attribute and the `<picture>...</picture>`\n\t * view structure out-of-the-box if relevant data is provided along the\n\t * {@link module:image/imageupload/imageuploadediting~ImageUploadEditing#event:uploadComplete} event.\n\t */\n\tprivate _setupImageUploadEditingIntegration(): void {\n\t\tconst editor = this.editor;\n\n\t\tif ( !editor.plugins.has( 'ImageUploadEditing' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst imageUploadEditing: ImageUploadEditing = editor.plugins.get( 'ImageUploadEditing' );\n\n\t\tthis.listenTo<ImageUploadCompleteEvent>(\n\t\t\timageUploadEditing,\n\t\t\t'uploadComplete',\n\t\t\t( evt, { imageElement, data } ) => {\n\t\t\t\tconst sources = data.sources;\n\n\t\t\t\tif ( !sources ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\teditor.model.change( writer => {\n\t\t\t\t\twriter.setAttributes( {\n\t\t\t\t\t\tsources\n\t\t\t\t\t}, imageElement );\n\t\t\t\t} );\n\t\t\t} );\n\t}\n}\n"],"names":["createInlineImageViewElement","writer","createContainerElement","class","createEmptyElement","createBlockImageViewElement","createSlot","getImgViewElementMatcher","editor","matchImageType","imageUtils","plugins","get","areBothImagePluginsLoaded","has","element","isInlineImageView","getPositiveMatchPattern","imageType","getStyle","findAncestor","isBlockImageView","pattern","name","hasAttribute","attributes","determineImageTypeForInsertionAtSelection","schema","selection","firstBlock","first","getSelectedBlocks","isObject","isEmpty","getSizeValueIfInPx","size","endsWith","parseInt","widthAndHeightStylesAreBothSet","viewElement","widthStyle","heightStyle","IMAGE_WIDGETS_CLASSES_MATCH_REGEXP","ImageUtils","Plugin","_domEmitter","DomEmitterMixin","pluginName","isOfficialPlugin","isImage","modelElement","isInlineImage","isBlockImage","is","hasClass","insertImage","selectable","options","model","document","determinedImageType","determineImageTypeForInsertion","Object","fromEntries","getAttributes","attributeName","checkAttribute","change","setImageSizes","imageElement","createElement","insertObject","setSelection","findOptimalPosition","undefined","parent","setImageNaturalSizeAttributes","src","getAttribute","img","global","window","Image","listenTo","enqueueChange","batch","setAttribute","naturalWidth","naturalHeight","stopListening","getClosestSelectedImageWidget","selectionPosition","getFirstPosition","getSelectedElement","isImageWidget","getClosestSelectedImageElement","selectedElement","getImageWidgetFromImageView","imageView","classes","isImageAllowed","isImageAllowedInParent","isNotInsideImage","toImageWidget","label","setCustomProperty","labelCreator","imgElement","findViewImgElement","altText","toWidget","getCustomProperty","isWidget","figureView","editingView","editing","view","item","createRangeIn","destroy","getInsertImageParent","checkChild","focus","getAncestors","every","ancestor","insertionRange","findOptimalInsertionRange","start","configImageInsertType","config","IMAGE_URL_REGEXP","RegExp","String","source","AutoImage","requires","Clipboard","Undo","Delete","_timeoutId","_positionToInsert","init","modelDocument","clipboardPipeline","firstRange","getFirstRange","leftLivePosition","ModelLivePosition","fromPosition","stickiness","rightLivePosition","end","once","_embedImageBetweenPositions","detach","priority","commands","on","clearTimeout","leftPosition","rightPosition","urlRange","ModelLiveRange","walker","getWalker","ignoreElementEnd","selectionAttributes","node","data","trim","match","setTimeout","imageCommand","isEnabled","remove","insertionPosition","root","rootName","toPosition","deletePlugin","requestUndoOnBackspace","ImageTextAlternativeCommand","Command","refresh","value","execute","newValue","ImageTextAlternativeEditing","add","TextAlternativeFormView","View","focusTracker","keystrokes","labeledInput","backButtonView","saveButtonView","children","_focusables","_focusCycler","locale","FocusTracker","KeystrokeHandler","_createBackButton","_createSaveButton","_createLabeledInputView","createCollection","_createHeaderView","FormRowView","ViewCollection","set","cancel","fire","FocusCycler","focusables","keystrokeHandler","actions","focusPrevious","focusNext","setTemplate","tag","tabindex","render","submitHandler","childViews","forEach","v","t","backButton","ButtonView","icon","IconPreviousArrow","tooltip","delegate","to","saveButton","withText","type","header","FormHeaderView","LabeledFieldView","createLabeledInputText","repositionContextualBalloon","balloon","position","getBalloonPositionData","updatePosition","defaultPositions","BalloonPanelView","target","domConverter","mapViewToDom","positions","northArrowSouth","northArrowSouthWest","northArrowSouthEast","southArrowNorth","southArrowNorthWest","southArrowNorthEast","viewportStickyNorth","ImageTextAlternativeUI","_balloon","_form","ContextualBalloon","_createButton","ui","componentFactory","command","IconTextAlternative","bind","_showForm","_createForm","viewDocument","CssTransitionDisablerMixin","fieldView","_hideForm","_isVisible","clickOutsideHandler","emitter","activator","contextElements","callback","disableCssTransitions","_isInBalloon","select","enableCssTransitions","focusEditable","isFocused","visibleView","hasView","ImageTextAlternative","upcastImageFigure","converter","evt","conversionApi","consumable","test","viewItem","viewImage","consume","conversionResult","convertItem","modelCursor","modelImage","modelRange","getItems","revert","convertChildren","updateConversionResult","dispatcher","upcastPicture","sourceAttributeNames","pictureViewElement","sources","Map","childSourceElement","getChildren","keys","length","imgViewElement","sourceElement","Array","from","values","downcastSrcsetAttribute","mapper","toViewElement","attributeNewValue","removeAttribute","downcastSourcesAttribute","viewWriter","attributeElements","parentElement","unwrap","createRangeOn","unshift","hasPictureElement","pictureElement","insert","createPositionBefore","createPositionAt","map","sourceAttributes","move","attributeElement","wrap","downcastImageAttribute","attributeKey","ImageLoadObserver","Observer","observe","domRoot","event","domEvent","domElement","checkShouldIgnoreEventFromTarget","tagName","_fireEvents","useCapture","stopObserving","InsertImageCommand","logWarning","sourceDefinitions","toArray","sourceDefinition","index","createPositionAfter","breakBlock","ReplaceImageSourceCommand","decorate","image","cleanupImage","ImageEditing","conversion","addObserver","for","attributeToAttribute","key","insertImageCommand","replaceImageSourceCommand","ImageSizeAttributes","afterInit","_registerSchema","_registerConverters","extend","allowAttributes","viewElementName","styles","width","height","attachDowncastConverter","modelAttributeName","viewAttributeName","setRatioForInlineImage","isEditingDowncast","hasSizes","isResized","setStyle","ImageTypeCommand","_modelElementName","modelElementName","oldElement","uploadId","markers","filter","marker","getRange","containsItem","newElement","createSelection","newElementRange","markerRange","range","getJoined","updateMarker","ImagePlaceholder","_setupSchema","_setupConversion","_setupLoadListener","isRegistered","addClass","removeClass","removeStyle","mapDomToView","toModelElement","isUndoable","ImageBlockEditing","ClipboardPipeline","register","inheritAllFrom","_setupClipboardIntegration","elementToStructure","elementToElement","docFragmentChildren","content","targetRanges","toModelRange","ViewUpcastWriter","blockViewImages","inlineViewImage","createDocumentFragment","method","ImageInsertFormView","integrations","CollapsibleView","addMany","stopPropagation","focusFirst","ImageInsertUI","dropdownView","_integrations","define","isImageSelected","componentCreator","_createToolbarComponent","menuBarComponentCreator","_createMenuBarComponent","registerIntegration","observable","buttonViewCreator","formViewCreator","menuBarButtonViewCreator","requiresForm","override","_prepareIntegrations","dropdownButton","firstIntegration","actionButton","SplitButtonView","createDropdown","observables","toMany","some","integrationViews","flatMap","imageInsertFormView","panelView","resultView","MenuBarMenuView","listView","MenuBarMenuListView","buttonView","IconImage","integrationView","listItemView","MenuBarMenuListItemView","items","result","includes","push","ImageBlock","Widget","ImageInlineEditing","disallowIn","inlineViewImages","blockViewImage","childCount","attribute","getChild","ImageInline","ImageCaptionUtils","getCaptionFromImageModelElement","imageModelElement","getCaptionFromModelSelection","captionElement","matchImageCaptionViewElement","ToggleImageCaptionCommand","imageCaptionUtils","ancestorCaptionElement","focusCaptionOnShow","_hideImageCaption","_showImageCaption","imageCaptionEditing","selectedImage","savedCaption","_getSavedCaption","newCaptionElement","append","_saveCaption","ImageCaptionEditing","_savedCaptionsMap","WeakMap","allowIn","allowContentOf","isLimit","_setupImageTypeCommandsIntegration","_registerCaptionReconversion","figcaptionElement","createEditableElement","placeholder","enableViewPlaceholder","keepOnFocus","imageAlt","toWidgetEditable","imageTypeInlineCommand","imageTypeBlockCommand","handleImageTypeChange","return","oldCaptionElement","savedOldElementCaption","jsonObject","ModelElement","fromJSON","caption","toJSON","changes","differ","getChanges","nodeAfter","reconvertItem","ImageCaptionUI","IconCaption","isToggleable","modelCaptionElement","scrollToTheSelection","ImageCaption","createImageTypeRegExp","types","regExpSafeNames","replace","join","fetchLocalImage","Promise","resolve","reject","imageSrc","fetch","then","resource","blob","mimeType","getImageMimeType","ext","filename","file","File","catch","err","convertLocalImageOnCanvas","isLocalImage","toLowerCase","getBlobFromCanvas","addEventListener","canvas","ctx","getContext","drawImage","toBlob","ImageUploadUI","_createToolbarButton","_createMenuBarButton","_createDropdownButton","isOnly","ButtonClass","imageTypes","imageTypesRegExp","acceptedType","allowMultipleFiles","IconImageUpload","files","imagesToUpload","imageInsertUI","uploadImageCommand","button","FileDialogButtonView","isAccessAllowed","isOpen","MenuBarMenuListItemFileDialogButtonView","ImageUploadProgress","downcastDispatcher","uploadStatusChange","fileRepository","FileRepository","status","viewFigure","_startAppearEffect","_showPlaceholder","loader","loaders","_hidePlaceholder","_showProgressBar","_displayLocalImage","_showCompleteIcon","_hideProgressBar","_stopAppearEffect","viewImg","_getUIElement","_createPlaceholder","_removeUIElement","progressBar","_createProgressBar","completeIcon","createUIElement","imageFigure","uniqueProperty","child","UploadImageCommand","_uploadImage","createLoader","id","ImageUploadEditing","Notification","_uploadImageElements","_uploadedImages","upload","doc","shallow","isHtmlInDataTransfer","dataTransfer","images","stop","viewRange","notification","showWarning","namespace","fetchableImages","promise","fetchableImage","preventDefault","includeChangesInGraveyard","reverse","insertedImagesIds","Set","entry","isInsertedInGraveyard","getImagesFromChangeItem","allImagesThatShareUploaderInGraveyard","abort","_readAndUpload","urls","default","_parseAndSetSrcsetAttributeOnImage","imageUploadElements","elements","read","ariaLiveAnnouncer","announce","env","isSafari","domFigure","originalDisplay","style","display","_ckHack","offsetHeight","clean","error","title","delete","destroyLoader","maxWidth","srcsetAttribute","isNaN","Math","max","srcset","setAttributes","getData","ImageUpload","ImageInsertUrlView","urlInputView","_createUrlInputView","inputMode","imageURLInputValue","ImageInsertViaUrlUI","_imageInsertUI","_formView","Dialog","_createInsertUrlButton","IconImageUrl","_showModal","MenuBarMenuListItemButtonView","_createInsertUrlView","imageInsertUrlView","isCommandEnabled","dialog","_handleSave","show","isModal","actionButtons","onExecute","hide","ImageInsertViaUrl","ImageInsert","ResizeImageCommand","ImageResizeEditing","resizeUnit","resizeOptions","resizeImageCommand","setAttributeProperties","isFormatting","modelAttributeValue","RESIZE_ICONS","small","IconObjectSizeSmall","medium","IconObjectSizeMedium","large","IconObjectSizeLarge","custom","IconObjectSizeCustom","original","IconObjectSizeFull","ImageResizeButtons","_resizeUnit","option","_registerImageResizeButton","_registerImageResizeDropdown","labelText","_getOptionLabelValue","CKEditorError","isCustomImageResizeOption","customResizeUI","optionValueWithUnit","getIsOnButtonCallback","originalSizeOption","find","DropdownButtonView","accessibleLabel","commandValue","ariaLabel","ariaLabelledBy","addListToDropdown","_getResizeDropdownListItemDefinitions","role","onClick","commandName","forTooltip","itemDefinitions","Collection","optionsWithSerializedValues","valueWithUnits","definition","UIModel","allDropdownValues","getIsOnCustomButtonCallback","objectCommandValue","dropdownValue","RESIZABLE_IMAGES_CSS_SELECTOR","RESIZED_IMAGE_CLASS","ImageResizeHandles","WidgetResize","_setupResizerCreator","matches","domToView","widgetView","resizer","getResizerByViewElement","redraw","imageModel","attachTo","unit","getHandleHost","domWidgetElement","querySelector","getResizeHost","isCentered","imageStyle","onCommit","tryParseDimensionWithUnit","dimension","rawValue","parsedValue","Number","parseFloat","tryCastDimensionsToUnit","parentDimensionPx","targetUnit","getSelectedImageEditorNodes","imageViewElement","imageDOMElement","dom","getSelectedImageWidthInUnits","imageNodes","parsedResizedWidth","imageParentWidthPx","calculateResizeHostAncestorWidth","imageHolderDimension","Rect","ImageCustomResizeFormView","_validators","validators","createLabeledInputNumber","step","isValid","resetFormStatus","validator","errorText","rawSize","parsedSize","parsed","sizeWithUnits","getSelectedImagePossibleResizeRange","minimumImageWidth","getComputedStyle","minWidth","lower","upper","ImageCustomResizeUI","getFormValidators","update","currentParsedWidth","initialInputValue","toFixed","possibleRange","assign","min","ceil","form","ImageResize","ImageStyleCommand","_defaultStyles","_styles","imageBlock","imageInline","isDefault","modelElements","requestedStyle","shouldConvertImageType","supportedTypes","DEFAULT_OPTIONS","inline","IconObjectInline","alignLeft","IconObjectInlineLeft","className","alignBlockLeft","IconObjectLeft","alignCenter","IconObjectCenter","alignRight","IconObjectInlineRight","alignBlockRight","IconObjectRight","block","side","DEFAULT_ICONS","full","IconObjectFullWidth","left","right","center","inlineLeft","inlineRight","DEFAULT_DROPDOWN_DEFINITIONS","defaultItem","normalizeStyles","configuredStyles","arrangement","normalizeDefinition","isValidOption","getDefaultStylesConfiguration","isBlockPluginLoaded","isInlinePluginLoaded","getDefaultDropdownDefinitions","pluginCollection","extendStyle","warnInvalidStyle","supportedElements","elementName","missingPlugins","extendedStyle","prop","prototype","hasOwnProperty","call","info","utils","modelToViewStyleAttribute","newStyle","getStyleDefinitionByName","oldStyle","attributeOldValue","viewToModelStyleAttribute","nonDefaultStyles","modelImageElement","ImageStyleEditing","normalizedStyles","_setupPostFixer","modelToViewConverter","viewToModelConverter","upcastDispatcher","stylesMap","registerPostFixer","changed","imageStyleDefinition","ImageStyleUI","localizedDefaultStylesTitles","toolbarConfig","imageStyleEditing","definedStyles","translateStyles","styleConfig","definedDropdowns","dropdownConfig","_createDropdown","factory","defaultButton","buttonViews","itemName","getUIComponentName","buttonName","create","dropdown","splitButtonView","splitButtonViewArrow","arrowView","addToolbarToDropdown","enableActiveItemFocusOnDropdownOpen","getDropdownButtonTitle","unbind","areOn","findIndex","identity","isOn","areEnabled","buttonConfig","_executeCommand","titles","dropdownTitle","buttonTitle","ImageStyle","ImageToolbar","WidgetToolbarRepository","widgetToolbarRepository","normalizeDeclarativeConfig","getRelatedElement","PictureEditing","_setupImageUploadEditingIntegration","imageUploadEditing"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58],"debugId":null}}]
}