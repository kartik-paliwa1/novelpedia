{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/matei/NovelPedia/App/src/app/reset-password/page.tsx"],"sourcesContent":["'use client';\n\nimport '../../lib/amplifyClient';\nimport React, { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { LuMail, LuLock, LuEye, LuEyeOff } from 'react-icons/lu';\nimport { resetPassword, confirmResetPassword } from 'aws-amplify/auth';\n\nexport default function ResetPasswordPage() {\n  const router = useRouter();\n\n  const [step, setStep] = useState<'request' | 'confirm'>('request');\n  const [identifier, setIdentifier] = useState('');\n  const [code, setCode] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [msg, setMsg] = useState<string | null>(null);\n  const [err, setErr] = useState<string | null>(null);\n\n  const pwTooShort = newPassword.length > 0 && newPassword.length < 8; // match your Cognito policy if different\n\n  const sendCode = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErr(null);\n    setMsg(null);\n    if (!identifier.trim()) return setErr('Please enter your email or username.');\n\n    setLoading(true);\n    try {\n      await resetPassword({ username: identifier.trim() });\n      // For security, don’t confirm account existence. Just move to next step.\n      setStep('confirm');\n      setMsg('If an account exists for that identifier, a verification code has been sent.');\n    } catch (e: any) {\n      setErr(e?.message ?? 'Failed to start password reset.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const confirm = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErr(null);\n    setMsg(null);\n\n    if (!code.trim()) return setErr('Please enter the verification code.');\n    if (!newPassword) return setErr('Please enter a new password.');\n    if (pwTooShort) return setErr('Password must be at least 8 characters.');\n\n    setLoading(true);\n    try {\n      await confirmResetPassword({\n        username: identifier.trim(),\n        confirmationCode: code.trim(),\n        newPassword,\n      });\n      setMsg('Password updated. Redirecting to login…');\n      setTimeout(() => router.push('/login'), 900);\n    } catch (e: any) {\n      setErr(e?.message ?? 'Failed to reset password.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col py-10 items-center justify-center bg-gradient-to-br from-[#2d004d] via-[#4b166c] to-[#6d28d9]\">\n      {/* Header / Brand */}\n      <div className=\"flex flex-col items-center mb-8\">\n        <div className=\"bg-[#a259ec] p-3 rounded-full mb-2\">\n          <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"4\" fill=\"#fff\" />\n            <path d=\"M8 8h8v2H8V8zm0 4h8v2H8v-2zm0 4h5v2H8v-2z\" fill=\"#a259ec\" />\n          </svg>\n        </div>\n        <h1 className=\"text-2xl font-bold text-white\">Reset your password</h1>\n        <p className=\"text-sm text-violet-200 mt-1\">We’ll send a verification code to continue.</p>\n      </div>\n\n      <div className=\"w-[90vw] max-w-md bg-[#231942]/80 rounded-2xl shadow-xl px-8 py-10\">\n        {step === 'request' && (\n          <form className=\"space-y-5\" onSubmit={sendCode}>\n            <div>\n              <label className=\"block text-violet-200 text-xs md:text-sm mb-1\">\n                Email or Username\n              </label>\n              <div className=\"relative\">\n                <LuMail className=\"absolute left-3 top-1/2 -translate-y-1/2 text-violet-400\" />\n                <input\n                  type=\"text\"\n                  value={identifier}\n                  onChange={(e) => setIdentifier(e.target.value)}\n                  placeholder=\"Enter your email or username\"\n                  className=\"w-full pl-10 pr-3 py-2 bg-[#313052] text-white rounded-lg border border-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-400\"\n                  required\n                />\n              </div>\n            </div>\n\n            {err && <p className=\"text-sm text-red-400\">{err}</p>}\n            {msg && <p className=\"text-sm text-emerald-300\">{msg}</p>}\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full py-2 rounded-lg bg-gradient-to-r from-fuchsia-700 to-pink-500 text-white font-semibold flex items-center justify-center gap-2 hover:from-fuchsia-700 hover:to-pink-600 transition\"\n            >\n              {loading ? 'Sending…' : 'Send verification code'}\n            </button>\n\n            <div className=\"mt-6 text-violet-300 text-sm text-center\">\n              Remembered it?{' '}\n              <a href=\"/login\" className=\"text-white underline hover:text-violet-200\">\n                Back to login\n              </a>\n            </div>\n          </form>\n        )}\n\n        {step === 'confirm' && (\n          <form className=\"space-y-5\" onSubmit={confirm}>\n            <div>\n              <label className=\"block text-violet-200 text-xs md:text-sm mb-1\">\n                Verification Code\n              </label>\n              <input\n                type=\"text\"\n                value={code}\n                onChange={(e) => setCode(e.target.value)}\n                placeholder=\"Enter the 6-digit code\"\n                className=\"w-full px-3 py-2 bg-[#313052] text-white rounded-lg border border-violet-700 focus:outline-none focus:ring-2 focus:ring-violet-400\"\n                required\n              />\n              <p className=\"mt-1 text-xs text-gray-400\">\n                We sent a code to your email/phone if an account exists for that identifier.\n              </p>\n            </div>\n\n            <div>\n              <label className=\"block text-violet-200 text-xs md:text-sm mb-1\">\n                New Password\n              </label>\n              <div className=\"relative\">\n                <LuLock className=\"absolute left-3 top-1/2 -translate-y-1/2 text-violet-400\" />\n                <input\n                  type={showPassword ? 'text' : 'password'}\n                  value={newPassword}\n                  onChange={(e) => setNewPassword(e.target.value)}\n                  placeholder=\"Create a new password\"\n                  className={`w-full pl-10 pr-10 py-2 bg-[#313052] text-white rounded-lg border focus:outline-none focus:ring-2 ${\n                    pwTooShort\n                      ? 'border-red-500 focus:ring-red-500'\n                      : 'border-violet-700 focus:ring-violet-400'\n                  }`}\n                  minLength={8} // keep in sync with your Cognito policy\n                  required\n                />\n                <button\n                  type=\"button\"\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-violet-400\"\n                  tabIndex={-1}\n                  onClick={() => setShowPassword((s) => !s)}\n                >\n                  {showPassword ? <LuEyeOff /> : <LuEye />}\n                </button>\n              </div>\n              <p className={`mt-1 text-xs ${pwTooShort ? 'text-red-400' : 'text-gray-400'}`}>\n                Passwords must be at least 8 characters.\n              </p>\n            </div>\n\n            {err && <p className=\"text-sm text-red-400\">{err}</p>}\n            {msg && <p className=\"text-sm text-emerald-300\">{msg}</p>}\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full py-2 rounded-lg bg-gradient-to-r from-fuchsia-700 to-pink-500 text-white font-semibold flex items-center justify-center gap-2 hover:from-fuchsia-700 hover:to-pink-600 transition\"\n            >\n              {loading ? 'Updating…' : 'Set new password'}\n            </button>\n\n            <div className=\"mt-6 text-violet-300 text-sm text-center\">\n              Wrong email/username?{' '}\n              <button\n                type=\"button\"\n                className=\"text-white underline hover:text-violet-200\"\n                onClick={() => {\n                  setStep('request');\n                  setCode('');\n                  setNewPassword('');\n                  setMsg(null);\n                  setErr(null);\n                }}\n              >\n                Start over\n              </button>\n            </div>\n          </form>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}